[
  {
    "discussion_id": "2206945990",
    "pr_number": 23750,
    "pr_file": "ui/src/app/applications/components/application-create-panel/application-create-panel.tsx",
    "created_at": "2025-07-15T09:16:35+00:00",
    "commented_code": "title: type.toUpperCase(),\n                                                                     action: () => {\n                                                                         if (repoType !== type) {\n+                                                                            currentRepoType.current = type;\n                                                                             const updatedApp = api.getFormState().values as models.Application;\n-                                                                            if (normalizeAppSource(updatedApp, type)) {\n-                                                                                api.setAllValues(updatedApp);\n+                                                                            const source = getAppDefaultSource(updatedApp);\n+                                                                            if (type === 'git' || type === 'oci') {\n+                                                                                if (source.hasOwnProperty('chart')) {\n+                                                                                    source.path = source.chart;\n+                                                                                    delete source.chart;\n+                                                                                    source.targetRevision = 'HEAD';\n+                                                                                }\n+                                                                            } else if (type === 'helm') {\n+                                                                                if (source.hasOwnProperty('path')) {\n+                                                                                    source.chart = source.path;\n+                                                                                    delete source.path;\n+                                                                                    source.targetRevision = '';\n+                                                                                }\n                                                                             }\n+                                                                            if (!repoInfo) {\n+                                                                                if (type === 'oci') {\n+                                                                                    updatedApp.spec.source.repoURL = 'oci://';\n+                                                                                } else {\n+                                                                                    updatedApp.spec.source.repoURL = '';\n+                                                                                }\n+                                                                            }\n+                                                                            api.setAllValues(updatedApp);",
    "repo_full_name": "argoproj/argo-cd",
    "discussion_comments": [
      {
        "comment_id": "2206945990",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23750,
        "pr_file": "ui/src/app/applications/components/application-create-panel/application-create-panel.tsx",
        "discussion_id": "2206945990",
        "commented_code": "@@ -333,10 +334,30 @@ export const ApplicationCreatePanel = (props: {\n                                                                     title: type.toUpperCase(),\n                                                                     action: () => {\n                                                                         if (repoType !== type) {\n+                                                                            currentRepoType.current = type;\n                                                                             const updatedApp = api.getFormState().values as models.Application;\n-                                                                            if (normalizeAppSource(updatedApp, type)) {\n-                                                                                api.setAllValues(updatedApp);\n+                                                                            const source = getAppDefaultSource(updatedApp);\n+                                                                            if (type === 'git' || type === 'oci') {\n+                                                                                if (source.hasOwnProperty('chart')) {\n+                                                                                    source.path = source.chart;\n+                                                                                    delete source.chart;\n+                                                                                    source.targetRevision = 'HEAD';\n+                                                                                }\n+                                                                            } else if (type === 'helm') {\n+                                                                                if (source.hasOwnProperty('path')) {\n+                                                                                    source.chart = source.path;\n+                                                                                    delete source.path;\n+                                                                                    source.targetRevision = '';\n+                                                                                }\n                                                                             }\n+                                                                            if (!repoInfo) {\n+                                                                                if (type === 'oci') {\n+                                                                                    updatedApp.spec.source.repoURL = 'oci://';\n+                                                                                } else {\n+                                                                                    updatedApp.spec.source.repoURL = '';\n+                                                                                }\n+                                                                            }\n+                                                                            api.setAllValues(updatedApp);",
        "comment_created_at": "2025-07-15T09:16:35+00:00",
        "comment_author": "nitishfy",
        "comment_body": "```suggestion\r\n                                                                          \r\nconst source = getAppDefaultSource(updatedApp);\r\n\r\nswitch (type) {\r\n  case 'git':\r\n  case 'oci':\r\n    if ('chart' in source) {\r\n      source.path = source.chart;\r\n      delete source.chart;\r\n      source.targetRevision = 'HEAD';\r\n    }\r\n    break;\r\n\r\n  case 'helm':\r\n    if ('path' in source) {\r\n      source.chart = source.path;\r\n      delete source.path;\r\n      source.targetRevision = '';\r\n    }\r\n    break;\r\n}\r\n\r\nif (!repoInfo) {\r\n  updatedApp.spec.source.repoURL = type === 'oci' ? 'oci://' : '';\r\n}\r\n\r\napi.setAllValues(updatedApp);\r\n```\r\n\r\nA general suggestion of using switch instead of having multiple if-else :)",
        "pr_file_module": null
      },
      {
        "comment_id": "2216481849",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23750,
        "pr_file": "ui/src/app/applications/components/application-create-panel/application-create-panel.tsx",
        "discussion_id": "2206945990",
        "commented_code": "@@ -333,10 +334,30 @@ export const ApplicationCreatePanel = (props: {\n                                                                     title: type.toUpperCase(),\n                                                                     action: () => {\n                                                                         if (repoType !== type) {\n+                                                                            currentRepoType.current = type;\n                                                                             const updatedApp = api.getFormState().values as models.Application;\n-                                                                            if (normalizeAppSource(updatedApp, type)) {\n-                                                                                api.setAllValues(updatedApp);\n+                                                                            const source = getAppDefaultSource(updatedApp);\n+                                                                            if (type === 'git' || type === 'oci') {\n+                                                                                if (source.hasOwnProperty('chart')) {\n+                                                                                    source.path = source.chart;\n+                                                                                    delete source.chart;\n+                                                                                    source.targetRevision = 'HEAD';\n+                                                                                }\n+                                                                            } else if (type === 'helm') {\n+                                                                                if (source.hasOwnProperty('path')) {\n+                                                                                    source.chart = source.path;\n+                                                                                    delete source.path;\n+                                                                                    source.targetRevision = '';\n+                                                                                }\n                                                                             }\n+                                                                            if (!repoInfo) {\n+                                                                                if (type === 'oci') {\n+                                                                                    updatedApp.spec.source.repoURL = 'oci://';\n+                                                                                } else {\n+                                                                                    updatedApp.spec.source.repoURL = '';\n+                                                                                }\n+                                                                            }\n+                                                                            api.setAllValues(updatedApp);",
        "comment_created_at": "2025-07-18T16:49:38+00:00",
        "comment_author": "keithchong",
        "comment_body": "Hi @nitishfy , I cleaned it up a bit, and needed to make some modifications to save the URL value.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2177761953",
    "pr_number": 23606,
    "pr_file": "ui/src/app/shared/components/version-info/version-info-panel.tsx",
    "created_at": "2025-07-01T14:29:43+00:00",
    "commented_code": "};\n \n         return (\n-            <React.Fragment>\n-                {Object.entries(formattedVersion).map(([key, value]) => {\n-                    return (\n-                        <div className='argo-table-list__row' key={key}>\n-                            <div className='row'>\n-                                <div className='columns small-4' title={key}>\n-                                    <strong>{key}</strong>\n-                                </div>\n-                                <div className='columns'>\n-                                    {value && (\n-                                        <Tooltip content={value}>\n-                                            <span>{value}</span>\n-                                        </Tooltip>\n-                                    )}\n-                                </div>\n+            <Fragment>",
    "repo_full_name": "argoproj/argo-cd",
    "discussion_comments": [
      {
        "comment_id": "2177761953",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23606,
        "pr_file": "ui/src/app/shared/components/version-info/version-info-panel.tsx",
        "discussion_id": "2177761953",
        "commented_code": "@@ -60,36 +30,34 @@ export class VersionPanel extends React.Component<VersionPanelProps, {copyState:\n         };\n \n         return (\n-            <React.Fragment>\n-                {Object.entries(formattedVersion).map(([key, value]) => {\n-                    return (\n-                        <div className='argo-table-list__row' key={key}>\n-                            <div className='row'>\n-                                <div className='columns small-4' title={key}>\n-                                    <strong>{key}</strong>\n-                                </div>\n-                                <div className='columns'>\n-                                    {value && (\n-                                        <Tooltip content={value}>\n-                                            <span>{value}</span>\n-                                        </Tooltip>\n-                                    )}\n-                                </div>\n+            <Fragment>",
        "comment_created_at": "2025-07-01T14:29:43+00:00",
        "comment_author": "linghaoSu",
        "comment_body": "If we don't need the key attribute here, maybe we could simplify it by using a fragment shorthand: `<></>` instead of `<React.Fragment>`.",
        "pr_file_module": null
      },
      {
        "comment_id": "2182921200",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23606,
        "pr_file": "ui/src/app/shared/components/version-info/version-info-panel.tsx",
        "discussion_id": "2177761953",
        "commented_code": "@@ -60,36 +30,34 @@ export class VersionPanel extends React.Component<VersionPanelProps, {copyState:\n         };\n \n         return (\n-            <React.Fragment>\n-                {Object.entries(formattedVersion).map(([key, value]) => {\n-                    return (\n-                        <div className='argo-table-list__row' key={key}>\n-                            <div className='row'>\n-                                <div className='columns small-4' title={key}>\n-                                    <strong>{key}</strong>\n-                                </div>\n-                                <div className='columns'>\n-                                    {value && (\n-                                        <Tooltip content={value}>\n-                                            <span>{value}</span>\n-                                        </Tooltip>\n-                                    )}\n-                                </div>\n+            <Fragment>",
        "comment_created_at": "2025-07-03T14:20:03+00:00",
        "comment_author": "crenshaw-dev",
        "comment_body": "And one more... might be worth a lint rule? :-) ",
        "pr_file_module": null
      },
      {
        "comment_id": "2188308250",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23606,
        "pr_file": "ui/src/app/shared/components/version-info/version-info-panel.tsx",
        "discussion_id": "2177761953",
        "commented_code": "@@ -60,36 +30,34 @@ export class VersionPanel extends React.Component<VersionPanelProps, {copyState:\n         };\n \n         return (\n-            <React.Fragment>\n-                {Object.entries(formattedVersion).map(([key, value]) => {\n-                    return (\n-                        <div className='argo-table-list__row' key={key}>\n-                            <div className='row'>\n-                                <div className='columns small-4' title={key}>\n-                                    <strong>{key}</strong>\n-                                </div>\n-                                <div className='columns'>\n-                                    {value && (\n-                                        <Tooltip content={value}>\n-                                            <span>{value}</span>\n-                                        </Tooltip>\n-                                    )}\n-                                </div>\n+            <Fragment>",
        "comment_created_at": "2025-07-06T13:52:12+00:00",
        "comment_author": "linghaoSu",
        "comment_body": "I've drafted a PR to add this lint rule: https://github.com/argoproj/argo-cd/pull/23666",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2135178974",
    "pr_number": 23285,
    "pr_file": "ui/src/app/applications/components/applications-list/applications-list.tsx",
    "created_at": "2025-06-09T07:15:25+00:00",
    "commented_code": "</React.Fragment>\n             )}\n             onSelect={val => {\n-                ctx.navigation.goto(`./${val}`);\n+                const selectedApp = apps.find(app => AppUtils.appQualifiedName(app, useAuthSettingsCtx?.appsInAnyNamespaceEnabled) === val);",
    "repo_full_name": "argoproj/argo-cd",
    "discussion_comments": [
      {
        "comment_id": "2135178974",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 23285,
        "pr_file": "ui/src/app/applications/components/applications-list/applications-list.tsx",
        "discussion_id": "2135178974",
        "commented_code": "@@ -263,7 +263,10 @@ const SearchBar = (props: {content: string; ctx: ContextApis; apps: models.Appli\n                 </React.Fragment>\n             )}\n             onSelect={val => {\n-                ctx.navigation.goto(`./${val}`);\n+                const selectedApp = apps.find(app => AppUtils.appQualifiedName(app, useAuthSettingsCtx?.appsInAnyNamespaceEnabled) === val);",
        "comment_created_at": "2025-06-09T07:15:25+00:00",
        "comment_author": "nitishfy",
        "comment_body": "```suggestion\r\n                const qualifiedName = AppUtils.appQualifiedName(app, useAuthSettingsCtx?.appsInAnyNamespaceEnabled);\r\n                const selectedApp = apps?.find(app => qualifiedName === val);\r\n```\r\n\r\nI'd suggest assigning it to a temporary variable to clarify what you're matching against.\r\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2152246958",
    "pr_number": 22410,
    "pr_file": "ui/src/app/applications/components/utils.tsx",
    "created_at": "2025-06-17T13:14:30+00:00",
    "commented_code": "} else if (revision.length >= 7 && !revision.startsWith(source.targetRevision)) {\n             if (source.repoURL.startsWith('oci://')) {\n                 // Show \"sha256: \" plus the first 7 actual characters of the digest.\n-                message += ' (' + revision.substring(0, 14) + ')';\n+                if (revision.startsWith('sha256:')) {\n+                    message += ' (' + revision.substring(0, 14) + ')';\n+                } else {\n+                    message += ' (' + revision.substring(0, 7) + ')';\n+                }",
    "repo_full_name": "argoproj/argo-cd",
    "discussion_comments": [
      {
        "comment_id": "2152246958",
        "repo_full_name": "argoproj/argo-cd",
        "pr_number": 22410,
        "pr_file": "ui/src/app/applications/components/utils.tsx",
        "discussion_id": "2152246958",
        "commented_code": "@@ -843,7 +843,11 @@ export function syncStatusMessage(app: appModels.Application) {\n         } else if (revision.length >= 7 && !revision.startsWith(source.targetRevision)) {\n             if (source.repoURL.startsWith('oci://')) {\n                 // Show \"sha256: \" plus the first 7 actual characters of the digest.\n-                message += ' (' + revision.substring(0, 14) + ')';\n+                if (revision.startsWith('sha256:')) {\n+                    message += ' (' + revision.substring(0, 14) + ')';\n+                } else {\n+                    message += ' (' + revision.substring(0, 7) + ')';\n+                }",
        "comment_created_at": "2025-06-17T13:14:30+00:00",
        "comment_author": "olivergondza",
        "comment_body": "The whole block can be simplified as (untested pseudo-code):\r\n\r\n```javascript\r\nlet revAbbrvLen = 7;\r\n// Show \"sha256: \" plus the first 7 actual characters of the digest.\r\nif (source.repoURL.startsWith('oci://') && revision.startsWith('sha256:')) {\r\n    revAbbrvLen = 14;\r\n}\r\nmessage += ' (' + revision.substring(0, 7) + ')';\r\n```",
        "pr_file_module": null
      }
    ]
  }
]