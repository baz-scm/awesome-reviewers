[
  {
    "discussion_id": "1871656535",
    "pr_number": 18876,
    "pr_file": ".github/workflows/tests.yml",
    "created_at": "2024-12-05T16:05:37+00:00",
    "commented_code": "HOMEBREW_BUILDPULSE_ACCOUNT_ID: 1503512\n           HOMEBREW_BUILDPULSE_REPOSITORY_ID: 53238813\n \n+      - id: junit_xml\n+        run: |\n+          cd \"${{ steps.set-up-homebrew.outputs.repository-path }}\"",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "1871656535",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 18876,
        "pr_file": ".github/workflows/tests.yml",
        "discussion_id": "1871656535",
        "commented_code": "@@ -356,6 +356,19 @@ jobs:\n           HOMEBREW_BUILDPULSE_ACCOUNT_ID: 1503512\n           HOMEBREW_BUILDPULSE_REPOSITORY_ID: 53238813\n \n+      - id: junit_xml\n+        run: |\n+          cd \"${{ steps.set-up-homebrew.outputs.repository-path }}\"",
        "comment_created_at": "2024-12-05T16:05:37+00:00",
        "comment_author": "Bo98",
        "comment_body": "```suggestion\r\n        working-directory: ${{ steps.set-up-homebrew.outputs.repository-path }}\r\n        run: |\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1871662520",
    "pr_number": 18876,
    "pr_file": ".github/workflows/tests.yml",
    "created_at": "2024-12-05T16:09:08+00:00",
    "commented_code": "HOMEBREW_BUILDPULSE_ACCOUNT_ID: 1503512\n           HOMEBREW_BUILDPULSE_REPOSITORY_ID: 53238813\n \n+      - id: junit_xml\n+        run: |\n+          cd \"${{ steps.set-up-homebrew.outputs.repository-path }}\"\n+          filenames=$(find test/junit -name 'rspec*.xml' -print | tr '\n' ',')\n+          echo \"filenames=${filenames%,}\" >> \"$GITHUB_OUTPUT\"\n+\n+      - uses: codecov/test-results-action@v1",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "1871662520",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 18876,
        "pr_file": ".github/workflows/tests.yml",
        "discussion_id": "1871662520",
        "commented_code": "@@ -356,6 +356,19 @@ jobs:\n           HOMEBREW_BUILDPULSE_ACCOUNT_ID: 1503512\n           HOMEBREW_BUILDPULSE_REPOSITORY_ID: 53238813\n \n+      - id: junit_xml\n+        run: |\n+          cd \"${{ steps.set-up-homebrew.outputs.repository-path }}\"\n+          filenames=$(find test/junit -name 'rspec*.xml' -print | tr '\\n' ',')\n+          echo \"filenames=${filenames%,}\" >> \"$GITHUB_OUTPUT\"\n+\n+      - uses: codecov/test-results-action@v1",
        "comment_created_at": "2024-12-05T16:09:08+00:00",
        "comment_author": "Bo98",
        "comment_body": "We pin the other `codecov/codecov-action` so do we want to pin this one too?\r\n\r\n```suggestion\r\n      - uses: codecov/test-results-action@9739113ad922ea0a9abb4b2c0f8bf6a4aa8ef820 # v1.0.1\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2145470376",
    "pr_number": 20107,
    "pr_file": ".github/workflows/sbom.yml",
    "created_at": "2025-06-13T16:22:41+00:00",
    "commented_code": "env:\n           GITHUB_TOKEN: ${{ secrets.HOMEBREW_GITHUB_PUBLIC_REPO_TOKEN }}\n         working-directory: ${{ steps.set-up-homebrew.outputs.repository-path }}\n+\n+  issue:\n+    needs: sbom\n+    if: always() && github.event_name == 'schedule'\n+    runs-on: ubuntu-latest\n+    env:\n+      RUN_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n+    permissions:\n+      # To create or update issues\n+      issues: write\n+    steps:\n+      - name: Open, update, or close schema issue\n+        uses: Homebrew/actions/create-or-update-issue@main\n+        with:\n+          title: Failed to update SBOM schema\n+          body: >\n+            The SBOM schema workflow [failed](${{ env.RUN_URL }}). No SBOM schema was updated.\n+          labels: bug\n+          update-existing: ${{ contains(needs.*.result, 'failure') }}",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2145470376",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 20107,
        "pr_file": ".github/workflows/sbom.yml",
        "discussion_id": "2145470376",
        "commented_code": "@@ -94,3 +94,26 @@ jobs:\n         env:\n           GITHUB_TOKEN: ${{ secrets.HOMEBREW_GITHUB_PUBLIC_REPO_TOKEN }}\n         working-directory: ${{ steps.set-up-homebrew.outputs.repository-path }}\n+\n+  issue:\n+    needs: sbom\n+    if: always() && github.event_name == 'schedule'\n+    runs-on: ubuntu-latest\n+    env:\n+      RUN_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n+    permissions:\n+      # To create or update issues\n+      issues: write\n+    steps:\n+      - name: Open, update, or close schema issue\n+        uses: Homebrew/actions/create-or-update-issue@main\n+        with:\n+          title: Failed to update SBOM schema\n+          body: >\n+            The SBOM schema workflow [failed](${{ env.RUN_URL }}). No SBOM schema was updated.\n+          labels: bug\n+          update-existing: ${{ contains(needs.*.result, 'failure') }}",
        "comment_created_at": "2025-06-13T16:22:41+00:00",
        "comment_author": "Rylan12",
        "comment_body": "```suggestion\r\n          update-existing: ${{ contains(needs.*.result, 'failure') || contains(needs.*.result, 'cancelled') || contains(needs.*.result, 'skipped') }}\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2145474799",
    "pr_number": 20107,
    "pr_file": ".github/workflows/spdx.yml",
    "created_at": "2025-06-13T16:25:17+00:00",
    "commented_code": "env:\n           GITHUB_TOKEN: ${{ secrets.HOMEBREW_GITHUB_PUBLIC_REPO_TOKEN }}\n         working-directory: ${{ steps.set-up-homebrew.outputs.repository-path }}\n+\n+  issue:\n+    needs: spdx\n+    if: always() && github.event_name == 'schedule'\n+    runs-on: ubuntu-latest\n+    env:\n+      RUN_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n+    permissions:\n+      # To create or update issues\n+      issues: write\n+    steps:\n+      - name: Open, update, or close SPDX issue\n+        uses: Homebrew/actions/create-or-update-issue@main\n+        with:\n+          title: Failed to update SPDX license data\n+          body: >\n+            The SPDX license data workflow [failed](${{ env.RUN_URL }}). No SPDX license data was updated.\n+          labels: bug\n+          update-existing: ${{ contains(needs.*.result, 'failure') }}",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2145474799",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 20107,
        "pr_file": ".github/workflows/spdx.yml",
        "discussion_id": "2145474799",
        "commented_code": "@@ -88,3 +88,26 @@ jobs:\n         env:\n           GITHUB_TOKEN: ${{ secrets.HOMEBREW_GITHUB_PUBLIC_REPO_TOKEN }}\n         working-directory: ${{ steps.set-up-homebrew.outputs.repository-path }}\n+\n+  issue:\n+    needs: spdx\n+    if: always() && github.event_name == 'schedule'\n+    runs-on: ubuntu-latest\n+    env:\n+      RUN_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}\n+    permissions:\n+      # To create or update issues\n+      issues: write\n+    steps:\n+      - name: Open, update, or close SPDX issue\n+        uses: Homebrew/actions/create-or-update-issue@main\n+        with:\n+          title: Failed to update SPDX license data\n+          body: >\n+            The SPDX license data workflow [failed](${{ env.RUN_URL }}). No SPDX license data was updated.\n+          labels: bug\n+          update-existing: ${{ contains(needs.*.result, 'failure') }}",
        "comment_created_at": "2025-06-13T16:25:17+00:00",
        "comment_author": "Rylan12",
        "comment_body": "```suggestion\r\n          update-existing: ${{ contains(needs.*.result, 'failure') || contains(needs.*.result, 'cancelled') || contains(needs.*.result, 'skipped') }}\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1797727265",
    "pr_number": 18555,
    "pr_file": ".github/workflows/pkg-installer.yml",
    "created_at": "2024-10-12T16:22:29+00:00",
    "commented_code": "release:\n     types:\n       - published\n+permissions:\n+  contents: read # for code access\n+  attestations: write # for actions/attest-build-provenance\n+  id-token: write # for actions/attest-build-provenance",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "1797727265",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 18555,
        "pr_file": ".github/workflows/pkg-installer.yml",
        "discussion_id": "1797727265",
        "commented_code": "@@ -11,6 +11,10 @@ on:\n   release:\n     types:\n       - published\n+permissions:\n+  contents: read # for code access\n+  attestations: write # for actions/attest-build-provenance\n+  id-token: write # for actions/attest-build-provenance",
        "comment_created_at": "2024-10-12T16:22:29+00:00",
        "comment_author": "carlocab",
        "comment_body": "```suggestion\r\npermissions: {}\r\n```\r\nCan we scope these permissions to the `build` job instead of the top level?",
        "pr_file_module": null
      }
    ]
  }
]