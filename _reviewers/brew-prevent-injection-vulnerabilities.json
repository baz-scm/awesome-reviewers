[
  {
    "discussion_id": "2015554906",
    "pr_number": 19621,
    "pr_file": "Library/Homebrew/formula_creator.rb",
    "created_at": "2025-03-27T03:46:41+00:00",
    "commented_code": "r = Resource.new\n           r.url(@url)\n           r.owner = self\n-          @sha256 = r.fetch.sha256 if r.download_strategy == CurlDownloadStrategy\n+          filepath = r.fetch\n+          if IO.read(filepath, 100).strip.start_with?(\"<!DOCTYPE html>\")",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2015600007",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19621,
        "pr_file": "Library/Homebrew/formula_creator.rb",
        "discussion_id": "2015554906",
        "commented_code": "@@ -82,7 +82,11 @@\n           r = Resource.new\n           r.url(@url)\n           r.owner = self\n-          @sha256 = r.fetch.sha256 if r.download_strategy == CurlDownloadStrategy\n+          filepath = r.fetch\n+          if IO.read(filepath, 100).strip.start_with?(\"<!DOCTYPE html>\")",
        "comment_created_at": "2025-03-27T04:11:05+00:00",
        "comment_author": "abitrolly",
        "comment_body": "https://codeql.github.com/codeql-query-help/ruby/rb-non-constant-kernel-open/\r\n\r\n> If Kernel.open is given a file name that starts with a | character, it will execute the remaining string as a shell command.\r\n\r\nI thought `Kernel` should be more low level interface.",
        "pr_file_module": null
      },
      {
        "comment_id": "2015618708",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19621,
        "pr_file": "Library/Homebrew/formula_creator.rb",
        "discussion_id": "2015554906",
        "commented_code": "@@ -82,7 +82,11 @@\n           r = Resource.new\n           r.url(@url)\n           r.owner = self\n-          @sha256 = r.fetch.sha256 if r.download_strategy == CurlDownloadStrategy\n+          filepath = r.fetch\n+          if IO.read(filepath, 100).strip.start_with?(\"<!DOCTYPE html>\")",
        "comment_created_at": "2025-03-27T04:31:29+00:00",
        "comment_author": "abitrolly",
        "comment_body": "Fixed.",
        "pr_file_module": null
      }
    ]
  }
]