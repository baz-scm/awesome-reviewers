[
  {
    "discussion_id": "2098266266",
    "pr_number": 19977,
    "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
    "created_at": "2025-05-20T15:24:22+00:00",
    "commented_code": "def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = %r{[^\\p{ASCII}]+}",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2098266266",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19977,
        "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
        "discussion_id": "2098266266",
        "commented_code": "@@ -35,6 +35,12 @@ def audit_urls(urls, regex)\n       def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = %r{[^\\p{ASCII}]+} ",
        "comment_created_at": "2025-05-20T15:24:22+00:00",
        "comment_author": "colindean",
        "comment_body": "**chore:** \r\n```suggestion\r\n        ascii_pattern = /[^\\p{ASCII}]+/\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2098433923",
    "pr_number": 19977,
    "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
    "created_at": "2025-05-20T16:41:39+00:00",
    "commented_code": "def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = /[^\\p{ASCII}]+/",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2098433923",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19977,
        "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
        "discussion_id": "2098433923",
        "commented_code": "@@ -35,6 +35,12 @@ def audit_urls(urls, regex)\n       def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = /[^\\p{ASCII}]+/",
        "comment_created_at": "2025-05-20T16:41:39+00:00",
        "comment_author": "colindean",
        "comment_body": "**issue:** Potentially, non-ASCII may be acceptable in path or query components of the URL. This would fail those.",
        "pr_file_module": null
      },
      {
        "comment_id": "2099279815",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19977,
        "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
        "discussion_id": "2098433923",
        "commented_code": "@@ -35,6 +35,12 @@ def audit_urls(urls, regex)\n       def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = /[^\\p{ASCII}]+/",
        "comment_created_at": "2025-05-21T04:29:49+00:00",
        "comment_author": "stefanb",
        "comment_body": "We may want also those (path & query) written in plain ASCII.\r\nEg [`https://github.com/ÖooÖle`](https://github.com/ÖooÖle) with [armenian \"Ö\"](https://www.compart.com/en/unicode/U+0581) should be written with URL-encoded path as [`https://github.com/%D6%81oo%D6%81le`](https://github.com/%D6%81oo%D6%81le) to be visually different from legit [`https://github.com/google`](https://github.com/google).\r\n\r\nGithub perhaps allows only ASCII in organisation and user names, but the point still stands: Paths are NOT immune to unicode confusion and punnycode is not the solution for paths, but plain old URL encoding is.\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "2099594570",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19977,
        "pr_file": "Library/Homebrew/rubocops/shared/url_helper.rb",
        "discussion_id": "2098433923",
        "commented_code": "@@ -35,6 +35,12 @@ def audit_urls(urls, regex)\n       def audit_url(type, urls, mirrors, livecheck_url: false)\n         @type = type\n \n+        # URLs must be ASCII; IDNs must be punycode\n+        ascii_pattern = /[^\\p{ASCII}]+/",
        "comment_created_at": "2025-05-21T07:42:42+00:00",
        "comment_author": "MikeMcQuaid",
        "comment_body": "I'd rather we be excessively strict for now, provided homebrew/core and homebrew/cask pass, and loosen it later.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2099349547",
    "pr_number": 19977,
    "pr_file": "Library/Homebrew/test/rubocops/urls_spec.rb",
    "created_at": "2025-05-21T05:06:01+00:00",
    "commented_code": "\"url\" => \"svn+http://brew.sh/foo/bar\",\n       \"msg\" => \"Use of the svn+http:// scheme is deprecated, pass `:using => :svn` instead\",\n       \"col\" => 2,\n+    }, {\n+      \"url\" => \"https://ðŸ« .sh/foo/bar\",\n+      \"msg\" => \"Please use the punycode version of https://ðŸ« .sh/foo/bar.\",\n+      \"col\" => 2,\n+    }, {\n+      \"url\" => \"https://ÃŸreï½—.sh/foo/bar\",\n+      \"msg\" => \"Please use the punycode version of https://ÃŸreï½—.sh/foo/bar.\",",
    "repo_full_name": "Homebrew/brew",
    "discussion_comments": [
      {
        "comment_id": "2099349547",
        "repo_full_name": "Homebrew/brew",
        "pr_number": 19977,
        "pr_file": "Library/Homebrew/test/rubocops/urls_spec.rb",
        "discussion_id": "2099349547",
        "commented_code": "@@ -177,6 +177,14 @@\n       \"url\" => \"svn+http://brew.sh/foo/bar\",\n       \"msg\" => \"Use of the svn+http:// scheme is deprecated, pass `:using => :svn` instead\",\n       \"col\" => 2,\n+    }, {\n+      \"url\" => \"https://ðŸ« .sh/foo/bar\",\n+      \"msg\" => \"Please use the punycode version of https://ðŸ« .sh/foo/bar.\",\n+      \"col\" => 2,\n+    }, {\n+      \"url\" => \"https://ÃŸreï½—.sh/foo/bar\",\n+      \"msg\" => \"Please use the punycode version of https://ÃŸreï½—.sh/foo/bar.\",",
        "comment_created_at": "2025-05-21T05:06:01+00:00",
        "comment_author": "colindean",
        "comment_body": "**chore:** \r\n```suggestion\r\n      \"msg\" => \"Please use the ASCII (Punycode, URL encoded) version of https://ðŸ« .sh/foo/bar.\",\r\n      \"col\" => 2,\r\n    }, {\r\n      \"url\" => \"https://ÃŸreï½—.sh/foo/bar\",\r\n      \"msg\" => \"Please use the ASCII (Punycode, URL encoded) version of https://ÃŸreï½—.sh/foo/bar.\",\r\n```",
        "pr_file_module": null
      }
    ]
  }
]