[
  {
    "discussion_id": "2193590979",
    "pr_number": 20874,
    "pr_file": "cmake/targets/BuildBun.cmake",
    "created_at": "2025-07-08T23:12:30+00:00",
    "commented_code": "if(APPLE)\n   target_link_options(${bun} PUBLIC\n-    -dead_strip\n-    -dead_strip_dylibs\n     -Wl,-ld_new\n     -Wl,-no_compact_unwind\n     -Wl,-stack_size,0x1200000\n     -fno-keep-static-consts\n     -Wl,-map,${bun}.linker-map\n+    # -Wl,-non_global_symbols_no_strip_list,${CMAKE_SOURCE_DIR}/src/symbols-non-global.txt\n+    -Wl,-non_global_symbols_no_strip_list,/Users/zackradisic/Code/bun2/src/symbols-non-global.txt",
    "repo_full_name": "oven-sh/bun",
    "discussion_comments": [
      {
        "comment_id": "2193590979",
        "repo_full_name": "oven-sh/bun",
        "pr_number": 20874,
        "pr_file": "cmake/targets/BuildBun.cmake",
        "discussion_id": "2193590979",
        "commented_code": "@@ -951,14 +951,24 @@ endif()\n \n if(APPLE)\n   target_link_options(${bun} PUBLIC\n-    -dead_strip\n-    -dead_strip_dylibs\n     -Wl,-ld_new\n     -Wl,-no_compact_unwind\n     -Wl,-stack_size,0x1200000\n     -fno-keep-static-consts\n     -Wl,-map,${bun}.linker-map\n+    # -Wl,-non_global_symbols_no_strip_list,${CMAKE_SOURCE_DIR}/src/symbols-non-global.txt\n+    -Wl,-non_global_symbols_no_strip_list,/Users/zackradisic/Code/bun2/src/symbols-non-global.txt",
        "comment_created_at": "2025-07-08T23:12:30+00:00",
        "comment_author": "graphite-app[bot]",
        "comment_body": "The hardcoded absolute path `/Users/zackradisic/Code/bun2/src/symbols-non-global.txt` should be replaced with the CMake variable path that's already commented out above: `${CMAKE_SOURCE_DIR}/src/symbols-non-global.txt`. Using the absolute path will prevent the build from working on other developers' machines.\n```suggestion\n    -Wl,-non_global_symbols_no_strip_list,${CMAKE_SOURCE_DIR}/src/symbols-non-global.txt\n```\n  \n\n*Spotted by [Diamond](https://app.graphite.dev/diamond/?org=oven-sh&ref=ai-review-comment)*<i class='graphite__hidden'><br /><br />Is this helpful? React \ud83d\udc4d or \ud83d\udc4e to let us know.</i>",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2118941792",
    "pr_number": 19911,
    "pr_file": "src/cli/install.ps1",
    "created_at": "2025-06-01T09:35:38+00:00",
    "commented_code": "[Switch]$DownloadWithoutCurl = $false\n );\n \n-# filter out 32 bit + ARM\n-if (-not ((Get-CimInstance Win32_ComputerSystem)).SystemType -match \"x64-based\") {\n+$allowedSystemTypes = @(\"x64-based\", \"ARM64-based\")\n+$currentSystemType = (Get-CimInstance Win32_ComputerSystem).SystemType\n+\n+# filter out 32 bit\n+if (-not ($allowedSystemTypes | Where-Object { $currentSystemType -match $_ })) {\n   Write-Output \"Install Failed:\"\n   Write-Output \"Bun for Windows is currently only available for x86 64-bit Windows.`n\"",
    "repo_full_name": "oven-sh/bun",
    "discussion_comments": [
      {
        "comment_id": "2118941792",
        "repo_full_name": "oven-sh/bun",
        "pr_number": 19911,
        "pr_file": "src/cli/install.ps1",
        "discussion_id": "2118941792",
        "commented_code": "@@ -14,21 +14,28 @@ param(\n   [Switch]$DownloadWithoutCurl = $false\n );\n \n-# filter out 32 bit + ARM\n-if (-not ((Get-CimInstance Win32_ComputerSystem)).SystemType -match \"x64-based\") {\n+$allowedSystemTypes = @(\"x64-based\", \"ARM64-based\")\n+$currentSystemType = (Get-CimInstance Win32_ComputerSystem).SystemType\n+\n+# filter out 32 bit\n+if (-not ($allowedSystemTypes | Where-Object { $currentSystemType -match $_ })) {\n   Write-Output \"Install Failed:\"\n   Write-Output \"Bun for Windows is currently only available for x86 64-bit Windows.`n\"",
        "comment_created_at": "2025-06-01T09:35:38+00:00",
        "comment_author": "graphite-app[bot]",
        "comment_body": "The error message is inconsistent with the updated code logic. Since the script now allows both x64 and ARM64 systems (while showing a warning for ARM64), the error message should be updated to accurately reflect that only 32-bit systems are unsupported. Consider changing it to: `\"Bun for Windows is currently only available for 64-bit Windows (x64 or ARM64).\"`\n```suggestion\n  Write-Output \"Install Failed:\"\n  Write-Output \"Bun for Windows is currently only available for 64-bit Windows (x64 or ARM64).`n\"\n```\n  \n\n*Spotted by [Diamond](https://app.graphite.dev/diamond/?org=oven-sh&ref=ai-review-comment)*<i class='graphite__hidden'><br /><br />Is this helpful? React \ud83d\udc4d or \ud83d\udc4e to let us know.</i>",
        "pr_file_module": null
      },
      {
        "comment_id": "2121748743",
        "repo_full_name": "oven-sh/bun",
        "pr_number": 19911,
        "pr_file": "src/cli/install.ps1",
        "discussion_id": "2118941792",
        "commented_code": "@@ -14,21 +14,28 @@ param(\n   [Switch]$DownloadWithoutCurl = $false\n );\n \n-# filter out 32 bit + ARM\n-if (-not ((Get-CimInstance Win32_ComputerSystem)).SystemType -match \"x64-based\") {\n+$allowedSystemTypes = @(\"x64-based\", \"ARM64-based\")\n+$currentSystemType = (Get-CimInstance Win32_ComputerSystem).SystemType\n+\n+# filter out 32 bit\n+if (-not ($allowedSystemTypes | Where-Object { $currentSystemType -match $_ })) {\n   Write-Output \"Install Failed:\"\n   Write-Output \"Bun for Windows is currently only available for x86 64-bit Windows.`n\"",
        "comment_created_at": "2025-06-02T17:20:40+00:00",
        "comment_author": "190n",
        "comment_body": "The old message is better. Bun is _not_ available for ARM64 Windows, it's just that emulating the x64 version happens to work.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2140995994",
    "pr_number": 20322,
    "pr_file": "src/install/migration.zig",
    "created_at": "2025-06-11T20:25:12+00:00",
    "commented_code": "};\n }\n \n+pub fn migratePnpmLockfile(\n+    this: *Lockfile,\n+    manager: *Install.PackageManager,\n+    allocator: Allocator,\n+    log: *logger.Log,\n+    data: string,\n+    abs_path: string,\n+) !LoadResult {\n+    debug(\"begin pnpm lockfile migration\", .{});\n+\n+    this.initEmpty(allocator);\n+    Install.initializeStore();\n+\n+    // Basic validation - check if it looks like a pnpm lockfile\n+    if (!strings.contains(data, \"lockfileVersion:\")) {\n+        return error.InvalidPnpmLockfile;\n+    }\n+\n+    // Mark analytics that we attempted pnpm migration\n+    bun.Analytics.Features.lockfile_migration_from_package_lock += 1;",
    "repo_full_name": "oven-sh/bun",
    "discussion_comments": [
      {
        "comment_id": "2140995994",
        "repo_full_name": "oven-sh/bun",
        "pr_number": 20322,
        "pr_file": "src/install/migration.zig",
        "discussion_id": "2140995994",
        "commented_code": "@@ -1037,6 +1071,86 @@ pub fn migrateNPMLockfile(\n     };\n }\n \n+pub fn migratePnpmLockfile(\n+    this: *Lockfile,\n+    manager: *Install.PackageManager,\n+    allocator: Allocator,\n+    log: *logger.Log,\n+    data: string,\n+    abs_path: string,\n+) !LoadResult {\n+    debug(\"begin pnpm lockfile migration\", .{});\n+\n+    this.initEmpty(allocator);\n+    Install.initializeStore();\n+\n+    // Basic validation - check if it looks like a pnpm lockfile\n+    if (!strings.contains(data, \"lockfileVersion:\")) {\n+        return error.InvalidPnpmLockfile;\n+    }\n+\n+    // Mark analytics that we attempted pnpm migration\n+    bun.Analytics.Features.lockfile_migration_from_package_lock += 1;",
        "comment_created_at": "2025-06-11T20:25:12+00:00",
        "comment_author": "graphite-app[bot]",
        "comment_body": "The analytics tracking is using an incorrect feature flag. The code is incrementing `lockfile_migration_from_package_lock` when migrating from a pnpm lockfile. This should either:\n\n1. Use a new, specific analytics flag like `lockfile_migration_from_pnpm_lock`, or\n2. Rename the existing flag to something more generic that covers all lockfile migrations\n\nThis will ensure accurate tracking of which lockfile formats are being migrated.\n```suggestion\n    bun.Analytics.Features.lockfile_migration_from_pnpm_lock += 1;\n```\n  \n\n*Spotted by [Diamond](https://app.graphite.dev/diamond/?org=oven-sh&ref=ai-review-comment)*<i class='graphite__hidden'><br /><br />Is this helpful? React \ud83d\udc4d or \ud83d\udc4e to let us know.</i>",
        "pr_file_module": null
      }
    ]
  }
]