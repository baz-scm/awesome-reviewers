[
  {
    "discussion_id": "1398401923",
    "pr_number": 5762,
    "pr_file": "tests/terraform/checks/resource/azure/example_AzureContainerInstanceEnvVarSecureValueType/main.tf",
    "created_at": "2023-11-19T13:34:02+00:00",
    "commented_code": "+# Variables declaration:\n+\n+variable \"pud_default_var\" {\n+  default = \"pud_default_value\"\n+}\n+\n+# Case 1: Pass: 'secure_environment_variables' exists in 'container' block\n+\n+resource \"azurerm_container_group\" \"pass_1\" {\n+  name                = \"pud_pass_1_container\"\n+  location            = var.pud_default_var\n+  resource_group_name = var.pud_default_var\n+  ip_address_type     = \"Public\"\n+  dns_name_label      = \"aci-label\"\n+  os_type             = \"Linux\"\n+\n+  container {\n+    name   = \"hello-world\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-helloworld:latest\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    ports {\n+      port     = 443\n+      protocol = \"TCP\"\n+    }\n+  }\n+\n+  container {\n+    name   = \"sidecar\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-tutorial-sidecar\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    secure_environment_variables = {\n+      INIT_SECRET_VAR               = \"secret_value\"",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1398401923",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5762,
        "pr_file": "tests/terraform/checks/resource/azure/example_AzureContainerInstanceEnvVarSecureValueType/main.tf",
        "discussion_id": "1398401923",
        "commented_code": "@@ -0,0 +1,151 @@\n+# Variables declaration:\n+\n+variable \"pud_default_var\" {\n+  default = \"pud_default_value\"\n+}\n+\n+# Case 1: Pass: 'secure_environment_variables' exists in 'container' block\n+\n+resource \"azurerm_container_group\" \"pass_1\" {\n+  name                = \"pud_pass_1_container\"\n+  location            = var.pud_default_var\n+  resource_group_name = var.pud_default_var\n+  ip_address_type     = \"Public\"\n+  dns_name_label      = \"aci-label\"\n+  os_type             = \"Linux\"\n+\n+  container {\n+    name   = \"hello-world\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-helloworld:latest\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    ports {\n+      port     = 443\n+      protocol = \"TCP\"\n+    }\n+  }\n+\n+  container {\n+    name   = \"sidecar\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-tutorial-sidecar\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    secure_environment_variables = {\n+      INIT_SECRET_VAR               = \"secret_value\"",
        "comment_created_at": "2023-11-19T13:34:02+00:00",
        "comment_author": "Saarett",
        "comment_body": "@praveen-panw Please add a skip comment because it won't pass tests",
        "pr_file_module": null
      },
      {
        "comment_id": "1398886143",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5762,
        "pr_file": "tests/terraform/checks/resource/azure/example_AzureContainerInstanceEnvVarSecureValueType/main.tf",
        "discussion_id": "1398401923",
        "commented_code": "@@ -0,0 +1,151 @@\n+# Variables declaration:\n+\n+variable \"pud_default_var\" {\n+  default = \"pud_default_value\"\n+}\n+\n+# Case 1: Pass: 'secure_environment_variables' exists in 'container' block\n+\n+resource \"azurerm_container_group\" \"pass_1\" {\n+  name                = \"pud_pass_1_container\"\n+  location            = var.pud_default_var\n+  resource_group_name = var.pud_default_var\n+  ip_address_type     = \"Public\"\n+  dns_name_label      = \"aci-label\"\n+  os_type             = \"Linux\"\n+\n+  container {\n+    name   = \"hello-world\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-helloworld:latest\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    ports {\n+      port     = 443\n+      protocol = \"TCP\"\n+    }\n+  }\n+\n+  container {\n+    name   = \"sidecar\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-tutorial-sidecar\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    secure_environment_variables = {\n+      INIT_SECRET_VAR               = \"secret_value\"",
        "comment_created_at": "2023-11-20T09:35:50+00:00",
        "comment_author": "praveen-panw",
        "comment_body": "Like this?:\r\n\r\n    secure_environment_variables = {\r\n      INIT_SECRET_VAR               = \"secret_value\"  # checkov:skip=CKV_SECRET_80 test secret\r\n    }\r\n\r\nOnly for `secure_environment_variables` right?",
        "pr_file_module": null
      },
      {
        "comment_id": "1400343936",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5762,
        "pr_file": "tests/terraform/checks/resource/azure/example_AzureContainerInstanceEnvVarSecureValueType/main.tf",
        "discussion_id": "1398401923",
        "commented_code": "@@ -0,0 +1,151 @@\n+# Variables declaration:\n+\n+variable \"pud_default_var\" {\n+  default = \"pud_default_value\"\n+}\n+\n+# Case 1: Pass: 'secure_environment_variables' exists in 'container' block\n+\n+resource \"azurerm_container_group\" \"pass_1\" {\n+  name                = \"pud_pass_1_container\"\n+  location            = var.pud_default_var\n+  resource_group_name = var.pud_default_var\n+  ip_address_type     = \"Public\"\n+  dns_name_label      = \"aci-label\"\n+  os_type             = \"Linux\"\n+\n+  container {\n+    name   = \"hello-world\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-helloworld:latest\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    ports {\n+      port     = 443\n+      protocol = \"TCP\"\n+    }\n+  }\n+\n+  container {\n+    name   = \"sidecar\"\n+    image  = \"mcr.microsoft.com/azuredocs/aci-tutorial-sidecar\"\n+    cpu    = \"0.5\"\n+    memory = \"1.5\"\n+\n+    secure_environment_variables = {\n+      INIT_SECRET_VAR               = \"secret_value\"",
        "comment_created_at": "2023-11-21T10:17:51+00:00",
        "comment_author": "Saarett",
        "comment_body": "@praveen-panw Specifically CKV_SECRET_6, please take a look at the failing secrets tests:\r\nhttps://github.com/bridgecrewio/checkov/actions/runs/6928014519/job/18865812804?pr=5762",
        "pr_file_module": null
      }
    ]
  }
]