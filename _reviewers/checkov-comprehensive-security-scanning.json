[
  {
    "discussion_id": "1303959445",
    "pr_number": 5458,
    "pr_file": ".pre-commit-hooks.yaml",
    "created_at": "2023-08-24T08:04:41+00:00",
    "commented_code": "exclude: \\.+.terraform\\/.*$\n     require_serial: true\n \n+-   id: checkov_container\n+    name: Checkov\n+    description: This hook runs checkov.\n+    entry: bridgecrew/checkov:latest -d .",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1303959445",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5458,
        "pr_file": ".pre-commit-hooks.yaml",
        "discussion_id": "1303959445",
        "commented_code": "@@ -14,17 +14,48 @@\n     exclude: \\.+.terraform\\/.*$\n     require_serial: true\n \n+-   id: checkov_container\n+    name: Checkov\n+    description: This hook runs checkov.\n+    entry: bridgecrew/checkov:latest -d .",
        "comment_created_at": "2023-08-24T08:04:41+00:00",
        "comment_author": "gruebel",
        "comment_body": "we usually recommend to run docker with `--tty` for better output handle.",
        "pr_file_module": null
      },
      {
        "comment_id": "1304659090",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5458,
        "pr_file": ".pre-commit-hooks.yaml",
        "discussion_id": "1303959445",
        "commented_code": "@@ -14,17 +14,48 @@\n     exclude: \\.+.terraform\\/.*$\n     require_serial: true\n \n+-   id: checkov_container\n+    name: Checkov\n+    description: This hook runs checkov.\n+    entry: bridgecrew/checkov:latest -d .",
        "comment_created_at": "2023-08-24T17:32:27+00:00",
        "comment_author": "lhriley",
        "comment_body": "For reference, this is how `pre-commit` runs [docker_image](https://pre-commit.com/#docker_image) hooks:\r\n\r\nhttps://github.com/pre-commit/pre-commit/blob/bde292b51078357384602ebe6b9b27b1906987e5/pre_commit/languages/docker.py#L111-L146\r\n\r\nI pushed up a commit to add `--tty` and the output looks like this now:\r\n\r\n```shell\r\n\u276f pre-commit run -av checkov_secrets_container\r\nCheckov Secrets..........................................................Passed\r\n- hook id: checkov_secrets_container\r\n- duration: 17.04s\r\n\r\nsecrets scan results:\r\n\r\nPassed checks: 0, Failed checks: 0, Skipped checks: 49\r\n\r\n\r\n\r\n\r\n\u276f pre-commit run -av checkov_secrets_container\r\nCheckov Secrets..........................................................Failed\r\n- hook id: checkov_secrets_container\r\n- duration: 17.16s\r\n- exit code: 1\r\n\r\nsecrets scan results:\r\n\r\nPassed checks: 0, Failed checks: 1, Skipped checks: 49\r\n\r\nCheck: CKV_SECRET_6: \"Base64 High Entropy String\"\r\n\tFAILED for resource: a2478cff5623ee9e46dfe2ab06e96bfe5168f732\r\n\tFile: /foo/bar-values.yaml:7-8\r\n\tGuide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html\r\n\r\n\t\t7 | superSecret: c2Vjcm******************************************************************************************************************************************************************************\r\n\r\n\r\n\r\n\r\n\u276f pre-commit run -a checkov_secrets_container\r\nCheckov Secrets..........................................................Failed\r\n- hook id: checkov_secrets_container\r\n- exit code: 1\r\n\r\nsecrets scan results:\r\n\r\nPassed checks: 0, Failed checks: 1, Skipped checks: 49\r\n\r\nCheck: CKV_SECRET_6: \"Base64 High Entropy String\"\r\n\tFAILED for resource: a2478cff5623ee9e46dfe2ab06e96bfe5168f732\r\n\tFile: /foo/bar-values.yaml:7-8\r\n\tGuide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html\r\n\r\n\t\t7 | superSecret: c2Vjcm******************************************************************************************************************************************************************************\r\n\r\n\r\n\r\n\r\n\u276f pre-commit run -a checkov_secrets_container\r\nCheckov Secrets..........................................................Passed\r\n\r\n\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1380114199",
    "pr_number": 5706,
    "pr_file": "checkov/cdk/checks/python/WAFEnabled.yaml",
    "created_at": "2023-11-02T13:30:14+00:00",
    "commented_code": "+metadata:\n+  version: 0.2\n+  approach: define failing\n+  id: CKV_AWS_68\n+  name: CloudFront Distribution should have WAF enabled\n+  category: ENCRYPTION\n+scope:\n+  languages:\n+    - python\n+definition:\n+  pattern: aws_cdk.aws_cloudfront.CfnDistribution(<ANY>)\n+  conditions:\n+    - not_pattern: 'aws_cdk.aws_cloudfront.CfnDistribution(<ANY>, distribution_config={<ANY>, \"webAclId\": <ANY> , <ANY>} , <ANY>)'",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1380114199",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5706,
        "pr_file": "checkov/cdk/checks/python/WAFEnabled.yaml",
        "discussion_id": "1380114199",
        "commented_code": "@@ -0,0 +1,13 @@\n+metadata:\n+  version: 0.2\n+  approach: define failing\n+  id: CKV_AWS_68\n+  name: CloudFront Distribution should have WAF enabled\n+  category: ENCRYPTION\n+scope:\n+  languages:\n+    - python\n+definition:\n+  pattern: aws_cdk.aws_cloudfront.CfnDistribution(<ANY>)\n+  conditions:\n+    - not_pattern: 'aws_cdk.aws_cloudfront.CfnDistribution(<ANY>, distribution_config={<ANY>, \"webAclId\": <ANY> , <ANY>} , <ANY>)'",
        "comment_created_at": "2023-11-02T13:30:14+00:00",
        "comment_author": "pazbechor",
        "comment_body": "```suggestion\r\n    - not_pattern: 'aws_cdk.aws_cloudfront.CfnDistribution(<ANY>, distribution_config={<ANY>, \"webAclId\": $ARG , <ANY>} , <ANY>)'\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "1380275724",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5706,
        "pr_file": "checkov/cdk/checks/python/WAFEnabled.yaml",
        "discussion_id": "1380114199",
        "commented_code": "@@ -0,0 +1,13 @@\n+metadata:\n+  version: 0.2\n+  approach: define failing\n+  id: CKV_AWS_68\n+  name: CloudFront Distribution should have WAF enabled\n+  category: ENCRYPTION\n+scope:\n+  languages:\n+    - python\n+definition:\n+  pattern: aws_cdk.aws_cloudfront.CfnDistribution(<ANY>)\n+  conditions:\n+    - not_pattern: 'aws_cdk.aws_cloudfront.CfnDistribution(<ANY>, distribution_config={<ANY>, \"webAclId\": <ANY> , <ANY>} , <ANY>)'",
        "comment_created_at": "2023-11-02T14:53:32+00:00",
        "comment_author": "pazbechor",
        "comment_body": "Also, Pls try it like this:\r\n```suggestion\r\n    - not_pattern: 'aws_cdk.aws_cloudfront.CfnDistribution(<ANY>, distribution_config={\"webAclId\": $ARG} , <ANY>)'\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1199069255",
    "pr_number": 5103,
    "pr_file": ".pre-commit-hooks.yaml",
    "created_at": "2023-05-19T15:02:48+00:00",
    "commented_code": "files: \\.tf$\n     exclude: \\.+.terraform\\/.*$\n     require_serial: true\n+-   id: checkov_secrets\n+    name: Checkov Secrets\n+    description: This hook looks for secrets with checkov.\n+    entry: checkov -d . --framework secrets",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1199069255",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5103,
        "pr_file": ".pre-commit-hooks.yaml",
        "discussion_id": "1199069255",
        "commented_code": "@@ -13,3 +13,11 @@\n     files: \\.tf$\n     exclude: \\.+.terraform\\/.*$\n     require_serial: true\n+-   id: checkov_secrets\n+    name: Checkov Secrets\n+    description: This hook looks for secrets with checkov.\n+    entry: checkov -d . --framework secrets",
        "comment_created_at": "2023-05-19T15:02:48+00:00",
        "comment_author": "gruebel",
        "comment_body": "```suggestion\r\n    entry: checkov -d . --framework secrets --enable-secret-scan-all-files\r\n```\r\ncould you also add the flag `--enable-secret-scan-all-files` so all the files are scanned.",
        "pr_file_module": null
      }
    ]
  }
]