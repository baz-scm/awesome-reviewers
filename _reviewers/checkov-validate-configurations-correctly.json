[
  {
    "discussion_id": "1360641003",
    "pr_number": 5637,
    "pr_file": "checkov/terraform/checks/graph_checks/azure/AzureVMconfigPublicIP_SerialConsoleAccess.yaml",
    "created_at": "2023-10-16T13:07:28+00:00",
    "commented_code": "+metadata:\n+  id: \"CKV_AZURE_228\"\n+  name: \"Ensure Azure VM is not configured with public IP and serial console access\"\n+  category: \"GENERAL_SECURITY\"\n+\n+definition:\n+  and:\n+    - cond_type: filter\n+      attribute: resource_type\n+      value:\n+        - azurerm_network_interface\n+      operator: within\n+\n+    - resource_types:\n+        - azurerm_network_interface\n+      connected_resource_types:\n+        - azurerm_linux_virtual_machine\n+        - azurerm_windows_virtual_machine\n+        - azurerm_virtual_machine\n+      operator: exists\n+      cond_type: connection\n+\n+    - cond_type: attribute\n+      resource_types:\n+         - azurerm_network_interface\n+      attribute: ip_configuration.public_ip_address_id\n+      operator: length_greater_than\n+      value: 0",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1360641003",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 5637,
        "pr_file": "checkov/terraform/checks/graph_checks/azure/AzureVMconfigPublicIP_SerialConsoleAccess.yaml",
        "discussion_id": "1360641003",
        "commented_code": "@@ -0,0 +1,28 @@\n+metadata:\n+  id: \"CKV_AZURE_228\"\n+  name: \"Ensure Azure VM is not configured with public IP and serial console access\"\n+  category: \"GENERAL_SECURITY\"\n+\n+definition:\n+  and:\n+    - cond_type: filter\n+      attribute: resource_type\n+      value:\n+        - azurerm_network_interface\n+      operator: within\n+\n+    - resource_types:\n+        - azurerm_network_interface\n+      connected_resource_types:\n+        - azurerm_linux_virtual_machine\n+        - azurerm_windows_virtual_machine\n+        - azurerm_virtual_machine\n+      operator: exists\n+      cond_type: connection\n+\n+    - cond_type: attribute\n+      resource_types:\n+         - azurerm_network_interface\n+      attribute: ip_configuration.public_ip_address_id\n+      operator: length_greater_than\n+      value: 0",
        "comment_created_at": "2023-10-16T13:07:28+00:00",
        "comment_author": "gruebel",
        "comment_body": "```suggestion\r\n      operator: not_exists\r\n```\r\nshouldn't it be not set, because we don't want a public IP?",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1117024067",
    "pr_number": 4529,
    "pr_file": "checkov/terraform/checks/graph_checks/gcp/GCPdisableAlphaClusterFeatureInKubernetesEngineClusters.yaml",
    "created_at": "2023-02-24T13:44:43+00:00",
    "commented_code": "+metadata:\n+  id: \"CKV2_GCP_19\"\n+  name: \"Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled\"\n+  category: \"KUBERNETES\"\n+\n+definition:\n+  cond_type: attribute\n+  resource_types: \"google_container_cluster\"\n+  attribute: \"enable_kubernetes_alpha\"\n+  operator: \"equals_ignore_case\"",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1117024067",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 4529,
        "pr_file": "checkov/terraform/checks/graph_checks/gcp/GCPdisableAlphaClusterFeatureInKubernetesEngineClusters.yaml",
        "discussion_id": "1117024067",
        "commented_code": "@@ -0,0 +1,11 @@\n+metadata:\n+  id: \"CKV2_GCP_19\"\n+  name: \"Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled\"\n+  category: \"KUBERNETES\"\n+\n+definition:\n+  cond_type: attribute\n+  resource_types: \"google_container_cluster\"\n+  attribute: \"enable_kubernetes_alpha\"\n+  operator: \"equals_ignore_case\"",
        "comment_created_at": "2023-02-24T13:44:43+00:00",
        "comment_author": "gruebel",
        "comment_body": "```suggestion\r\n  operator: \"not_equals_ignore_case\"\r\n```\r\nit should not `true` right?",
        "pr_file_module": null
      },
      {
        "comment_id": "1117059502",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 4529,
        "pr_file": "checkov/terraform/checks/graph_checks/gcp/GCPdisableAlphaClusterFeatureInKubernetesEngineClusters.yaml",
        "discussion_id": "1117024067",
        "commented_code": "@@ -0,0 +1,11 @@\n+metadata:\n+  id: \"CKV2_GCP_19\"\n+  name: \"Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled\"\n+  category: \"KUBERNETES\"\n+\n+definition:\n+  cond_type: attribute\n+  resource_types: \"google_container_cluster\"\n+  attribute: \"enable_kubernetes_alpha\"\n+  operator: \"equals_ignore_case\"",
        "comment_created_at": "2023-02-24T14:11:26+00:00",
        "comment_author": "praveen-panw",
        "comment_body": "Oops, that's right. Making the changes now.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1067193948",
    "pr_number": 4228,
    "pr_file": "checkov/terraform/checks/graph_checks/aws/CloudFrontS3OriginConfigWithOAI.yaml",
    "created_at": "2023-01-11T16:19:23+00:00",
    "commented_code": "- cond_type: attribute\n       resource_types:\n         - aws_cloudfront_distribution\n-      attribute: \"origin.*.s3_origin_config\"\n+      attribute: \"origin.*.s3_origin_config.origin_access_identity\"\n       operator: \"exists\"",
    "repo_full_name": "bridgecrewio/checkov",
    "discussion_comments": [
      {
        "comment_id": "1067193948",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 4228,
        "pr_file": "checkov/terraform/checks/graph_checks/aws/CloudFrontS3OriginConfigWithOAI.yaml",
        "discussion_id": "1067193948",
        "commented_code": "@@ -19,12 +19,11 @@ definition:\n     - cond_type: attribute\n       resource_types:\n         - aws_cloudfront_distribution\n-      attribute: \"origin.*.s3_origin_config\"\n+      attribute: \"origin.*.s3_origin_config.origin_access_identity\"\n       operator: \"exists\"",
        "comment_created_at": "2023-01-11T16:19:23+00:00",
        "comment_author": "ankon",
        "comment_body": "The more I think about it: this probably should check \"not empty\", not just \"exists\". \n\nSame below. \n\nWDYT?",
        "pr_file_module": null
      },
      {
        "comment_id": "1072000628",
        "repo_full_name": "bridgecrewio/checkov",
        "pr_number": 4228,
        "pr_file": "checkov/terraform/checks/graph_checks/aws/CloudFrontS3OriginConfigWithOAI.yaml",
        "discussion_id": "1067193948",
        "commented_code": "@@ -19,12 +19,11 @@ definition:\n     - cond_type: attribute\n       resource_types:\n         - aws_cloudfront_distribution\n-      attribute: \"origin.*.s3_origin_config\"\n+      attribute: \"origin.*.s3_origin_config.origin_access_identity\"\n       operator: \"exists\"",
        "comment_created_at": "2023-01-17T09:58:39+00:00",
        "comment_author": "gruebel",
        "comment_body": "you can change it to a 'not empty', but a not empty `origin_access_identity` is a broken configuration, but correct me, if I'm wrong.",
        "pr_file_module": null
      }
    ]
  }
]