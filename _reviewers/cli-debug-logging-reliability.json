[
  {
    "discussion_id": "1294344070",
    "pr_number": 4788,
    "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
    "created_at": "2023-08-15T08:51:08+00:00",
    "commented_code": "'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
    "repo_full_name": "snyk/cli",
    "discussion_comments": [
      {
        "comment_id": "1294344070",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-15T08:51:08+00:00",
        "comment_author": "nick-watson",
        "comment_body": "Q: does this test pass without the debug option being set?",
        "pr_file_module": null
      },
      {
        "comment_id": "1294435638",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-15T10:35:22+00:00",
        "comment_author": "metju90",
        "comment_body": "@nick-watson nope, that wasn't working without the debug option. I fixed it.",
        "pr_file_module": null
      },
      {
        "comment_id": "1294440386",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-15T10:42:24+00:00",
        "comment_author": "nick-watson",
        "comment_body": "@metju90 \ud83d\udc4d do we also need a test cases for when it's not passed as well as if an error is thrown?",
        "pr_file_module": null
      },
      {
        "comment_id": "1294441684",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-15T10:44:28+00:00",
        "comment_author": "metju90",
        "comment_body": "I think it's a bit of an overkill to test every aspect of a logging feature?",
        "pr_file_module": null
      },
      {
        "comment_id": "1294568988",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-15T13:01:32+00:00",
        "comment_author": "nick-watson",
        "comment_body": "I think we should at least have a test checking/documenting that any errors thrown don't cause the analysis to fail early ",
        "pr_file_module": null
      },
      {
        "comment_id": "1295464142",
        "repo_full_name": "snyk/cli",
        "pr_number": 4788,
        "pr_file": "test/jest/unit/snyk-code/snyk-code-test.spec.ts",
        "discussion_id": "1294344070",
        "commented_code": "@@ -929,6 +934,33 @@ describe('Test snyk code', () => {\n       'Missing configuration for Snyk Code Local Engine. Refer to our docs on https://docs.snyk.io/products/snyk-code/deployment-options/snyk-code-local-engine/cli-and-ide to learn more',\n     );\n   });\n+\n+  it('Local code engine - makes GET /status to get SCLE version', async () => {\n+    const sastSettings = {\n+      sastEnabled: true,\n+      localCodeEngine: {\n+        url: 'http://foo.bar',\n+        allowCloudUpload: true,\n+        enabled: true,\n+      },\n+    };\n+    await getCodeTestResults(\n+      '.',\n+      {\n+        path: '',\n+        code: true,\n+      },",
        "comment_created_at": "2023-08-16T07:04:18+00:00",
        "comment_author": "metju90",
        "comment_body": "Done",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "797608302",
    "pr_number": 2692,
    "pr_file": "src/lib/plugins/sast/index.ts",
    "created_at": "2022-02-02T13:30:58+00:00",
    "commented_code": "import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-const debug = debugLib('snyk-code-test');\n+debugLib.enable('snyk-code');\n+const debug = debugLib('snyk-code');",
    "repo_full_name": "snyk/cli",
    "discussion_comments": [
      {
        "comment_id": "797608302",
        "repo_full_name": "snyk/cli",
        "pr_number": 2692,
        "pr_file": "src/lib/plugins/sast/index.ts",
        "discussion_id": "797608302",
        "commented_code": "@@ -12,7 +12,8 @@ import { FailedToRunTestError, NoSupportedSastFiles } from '../../errors';\n import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-const debug = debugLib('snyk-code-test');\n+debugLib.enable('snyk-code');\n+const debug = debugLib('snyk-code');",
        "comment_created_at": "2022-02-02T13:30:58+00:00",
        "comment_author": "metju90",
        "comment_body": "@pkey  so apparently we were always attempting to log more meaningful stuff, but the `debug()` function used further down in the file wasn't enabled.\r\n\r\nNow, with -d, it look like this:\r\n\r\n![image](https://user-images.githubusercontent.com/10331835/152163233-5817842e-b040-4fba-8615-d1d4d7b3c9f4.png)\r\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1846926266",
    "pr_number": 5585,
    "pr_file": "src/cli/commands/test/iac/local-execution/file-parser.ts",
    "created_at": "2024-11-18T16:44:36+00:00",
    "commented_code": "engineType: EngineType.Terraform,\n       });\n     } else if (failedFiles[fileData.filePath]) {\n-      if (debugLogs[fileData.filePath]) {\n-        debug(\n-          'File %s failed to parse with: %s',\n-          fileData.filePath,\n-          debugLogs[fileData.filePath],\n-        );\n-      }\n       parsingResults.failedFiles.push(\n         generateFailedParsedFile(\n           fileData,\n           new FailedToParseTerraformFileError(fileData.filePath),\n         ),\n       );\n     }\n+\n+    if (debugLogs[fileData.filePath]) {\n+      debug(\n+        'File %s failed to parse with: %s',\n+        fileData.filePath,\n+        debugLogs[fileData.filePath],\n+      );\n+    }",
    "repo_full_name": "snyk/cli",
    "discussion_comments": [
      {
        "comment_id": "1846926266",
        "repo_full_name": "snyk/cli",
        "pr_number": 5585,
        "pr_file": "src/cli/commands/test/iac/local-execution/file-parser.ts",
        "discussion_id": "1846926266",
        "commented_code": "@@ -99,20 +99,21 @@ export function parseTerraformFiles(filesData: IacFileData[]): ParsingResults {\n         engineType: EngineType.Terraform,\n       });\n     } else if (failedFiles[fileData.filePath]) {\n-      if (debugLogs[fileData.filePath]) {\n-        debug(\n-          'File %s failed to parse with: %s',\n-          fileData.filePath,\n-          debugLogs[fileData.filePath],\n-        );\n-      }\n       parsingResults.failedFiles.push(\n         generateFailedParsedFile(\n           fileData,\n           new FailedToParseTerraformFileError(fileData.filePath),\n         ),\n       );\n     }\n+\n+    if (debugLogs[fileData.filePath]) {\n+      debug(\n+        'File %s failed to parse with: %s',\n+        fileData.filePath,\n+        debugLogs[fileData.filePath],\n+      );\n+    }",
        "comment_created_at": "2024-11-18T16:44:36+00:00",
        "comment_author": "sergiu-snyk",
        "comment_body": "Debug logs should be printed if we have them, even if the file is not reported in `failedFiles`. By design of `snyk-iac-parsers` only user configuration errors are reported in failed files, but we want debug information for any kind of error.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "804818077",
    "pr_number": 2748,
    "pr_file": "src/lib/plugins/sast/index.ts",
    "created_at": "2022-02-11T16:35:26+00:00",
    "commented_code": "import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-debugLib.enable('snyk-code');\n-const debug = debugLib('snyk-code');",
    "repo_full_name": "snyk/cli",
    "discussion_comments": [
      {
        "comment_id": "804818077",
        "repo_full_name": "snyk/cli",
        "pr_number": 2748,
        "pr_file": "src/lib/plugins/sast/index.ts",
        "discussion_id": "804818077",
        "commented_code": "@@ -12,8 +13,7 @@ import { FailedToRunTestError, NoSupportedSastFiles } from '../../errors';\n import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-debugLib.enable('snyk-code');\n-const debug = debugLib('snyk-code');",
        "comment_created_at": "2022-02-11T16:35:26+00:00",
        "comment_author": "pkey",
        "comment_body": "question: why change this? not sure what it does though.",
        "pr_file_module": null
      },
      {
        "comment_id": "804822802",
        "repo_full_name": "snyk/cli",
        "pr_number": 2748,
        "pr_file": "src/lib/plugins/sast/index.ts",
        "discussion_id": "804818077",
        "commented_code": "@@ -12,8 +13,7 @@ import { FailedToRunTestError, NoSupportedSastFiles } from '../../errors';\n import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-debugLib.enable('snyk-code');\n-const debug = debugLib('snyk-code');",
        "comment_created_at": "2022-02-11T16:39:56+00:00",
        "comment_author": "metju90",
        "comment_body": "The removed code fixed an issue with not printing debugging code from [here](https://github.com/snyk/snyk/pull/2748/files#diff-2284575013fd6588d30774b796013333e67e588d92cf0b4fee2508d926419614L84). but it fixed it too good, so good that it was printing debug info even without the `-d` flag.\r\n\r\nNow it's working as intended, debug info only when `-d` is passed.",
        "pr_file_module": null
      },
      {
        "comment_id": "804826913",
        "repo_full_name": "snyk/cli",
        "pr_number": 2748,
        "pr_file": "src/lib/plugins/sast/index.ts",
        "discussion_id": "804818077",
        "commented_code": "@@ -12,8 +13,7 @@ import { FailedToRunTestError, NoSupportedSastFiles } from '../../errors';\n import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-debugLib.enable('snyk-code');\n-const debug = debugLib('snyk-code');",
        "comment_created_at": "2022-02-11T16:43:59+00:00",
        "comment_author": "pkey",
        "comment_body": "gotcha",
        "pr_file_module": null
      },
      {
        "comment_id": "804833023",
        "repo_full_name": "snyk/cli",
        "pr_number": 2748,
        "pr_file": "src/lib/plugins/sast/index.ts",
        "discussion_id": "804818077",
        "commented_code": "@@ -12,8 +13,7 @@ import { FailedToRunTestError, NoSupportedSastFiles } from '../../errors';\n import { jsonStringifyLargeObject } from '../../json';\n import * as analytics from '../../analytics';\n \n-debugLib.enable('snyk-code');\n-const debug = debugLib('snyk-code');",
        "comment_created_at": "2022-02-11T16:51:13+00:00",
        "comment_author": "metju90",
        "comment_body": "TBH I didn't fully understand how our debug library works, but now we have the desired behaviour \u270c\ufe0f ",
        "pr_file_module": null
      }
    ]
  }
]