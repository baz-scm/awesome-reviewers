[
  {
    "discussion_id": "2230036285",
    "pr_number": 8890,
    "pr_file": "server.py",
    "created_at": "2025-07-25T03:02:45+00:00",
    "commented_code": "prompt_id = request.match_info.get(\"prompt_id\", None)\n             return web.json_response(self.prompt_queue.get_history(prompt_id=prompt_id))\n \n+        @routes.get(\"/history_v2\")\n+        async def get_ordered_history(request):\n+            max_items = request.rel_url.query.get(\"max_items\", None)\n+            if max_items is not None:\n+                max_items = int(max_items)\n+\n+            offset = request.rel_url.query.get(\"offset\", 0)\n+            offset = int(offset)\n+\n+            return web.json_response(self.prompt_queue.get_ordered_history(max_items=max_items, offset=offset))\n+\n+        @routes.get(\"/history_v2/{prompt_id}\")",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "2230036285",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8890,
        "pr_file": "server.py",
        "discussion_id": "2230036285",
        "commented_code": "@@ -652,6 +652,22 @@ async def get_history_prompt_id(request):\n             prompt_id = request.match_info.get(\"prompt_id\", None)\n             return web.json_response(self.prompt_queue.get_history(prompt_id=prompt_id))\n \n+        @routes.get(\"/history_v2\")\n+        async def get_ordered_history(request):\n+            max_items = request.rel_url.query.get(\"max_items\", None)\n+            if max_items is not None:\n+                max_items = int(max_items)\n+\n+            offset = request.rel_url.query.get(\"offset\", 0)\n+            offset = int(offset)\n+\n+            return web.json_response(self.prompt_queue.get_ordered_history(max_items=max_items, offset=offset))\n+\n+        @routes.get(\"/history_v2/{prompt_id}\")",
        "comment_created_at": "2025-07-25T03:02:45+00:00",
        "comment_author": "comfyanonymous",
        "comment_body": "this is not necessary.",
        "pr_file_module": null
      },
      {
        "comment_id": "2230046645",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8890,
        "pr_file": "server.py",
        "discussion_id": "2230036285",
        "commented_code": "@@ -652,6 +652,22 @@ async def get_history_prompt_id(request):\n             prompt_id = request.match_info.get(\"prompt_id\", None)\n             return web.json_response(self.prompt_queue.get_history(prompt_id=prompt_id))\n \n+        @routes.get(\"/history_v2\")\n+        async def get_ordered_history(request):\n+            max_items = request.rel_url.query.get(\"max_items\", None)\n+            if max_items is not None:\n+                max_items = int(max_items)\n+\n+            offset = request.rel_url.query.get(\"offset\", 0)\n+            offset = int(offset)\n+\n+            return web.json_response(self.prompt_queue.get_ordered_history(max_items=max_items, offset=offset))\n+\n+        @routes.get(\"/history_v2/{prompt_id}\")",
        "comment_created_at": "2025-07-25T03:12:31+00:00",
        "comment_author": "ric-yu",
        "comment_body": "I believe we agreed we'd update this endpoint as well cc: @guill @webfiltered ",
        "pr_file_module": null
      },
      {
        "comment_id": "2231796834",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8890,
        "pr_file": "server.py",
        "discussion_id": "2230036285",
        "commented_code": "@@ -652,6 +652,22 @@ async def get_history_prompt_id(request):\n             prompt_id = request.match_info.get(\"prompt_id\", None)\n             return web.json_response(self.prompt_queue.get_history(prompt_id=prompt_id))\n \n+        @routes.get(\"/history_v2\")\n+        async def get_ordered_history(request):\n+            max_items = request.rel_url.query.get(\"max_items\", None)\n+            if max_items is not None:\n+                max_items = int(max_items)\n+\n+            offset = request.rel_url.query.get(\"offset\", 0)\n+            offset = int(offset)\n+\n+            return web.json_response(self.prompt_queue.get_ordered_history(max_items=max_items, offset=offset))\n+\n+        @routes.get(\"/history_v2/{prompt_id}\")",
        "comment_created_at": "2025-07-25T18:46:12+00:00",
        "comment_author": "guill",
        "comment_body": "Yeah, this was specifically my recommendation to avoid a case where people need to remember to use one endpoint for the list and one for individual items (which goes against normal REST principles). It's much easier if we're just able to say \"move to this new endpoint as we'll be deprecating `/history` eventually\".\r\n\r\nI don't have a strong opinion on the specific name we use, but *do* strongly feel we should keep this route to preserve consistency.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2061875045",
    "pr_number": 7817,
    "pr_file": "app/user_manager.py",
    "created_at": "2025-04-27T00:32:04+00:00",
    "commented_code": "return web.json_response(results)\n \n+        @routes.get(\"/userdata-v2\")",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "2061875045",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 7817,
        "pr_file": "app/user_manager.py",
        "discussion_id": "2061875045",
        "commented_code": "@@ -197,6 +197,134 @@ def process_full_path(full_path: str) -> FileInfo | str | list[str]:\n \n             return web.json_response(results)\n \n+        @routes.get(\"/userdata-v2\")",
        "comment_created_at": "2025-04-27T00:32:04+00:00",
        "comment_author": "huchenlei",
        "comment_body": "\"api/userdata-v2\" or \"api/v2/userdata\"?\r\n\r\nThe more common convention is \"api/v2/userdata\". This follows the typical REST API versioning pattern where the version number comes immediately after \"api\" in the path. The structure would be:\r\n\r\n/api/v1/userdata\r\n/api/v2/userdata\r\n/api/v3/userdata\r\nThis pattern makes it easier to organize and route different API versions while keeping the resource endpoint name consistent.",
        "pr_file_module": null
      },
      {
        "comment_id": "2061913821",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 7817,
        "pr_file": "app/user_manager.py",
        "discussion_id": "2061875045",
        "commented_code": "@@ -197,6 +197,134 @@ def process_full_path(full_path: str) -> FileInfo | str | list[str]:\n \n             return web.json_response(results)\n \n+        @routes.get(\"/userdata-v2\")",
        "comment_created_at": "2025-04-27T01:28:04+00:00",
        "comment_author": "benceruleanlu",
        "comment_body": "got it \u2014 thanks for the info!",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1863883919",
    "pr_number": 5841,
    "pr_file": "server.py",
    "created_at": "2024-11-29T19:30:08+00:00",
    "commented_code": "def get_embeddings(self):\n             embeddings = folder_paths.get_filename_list(\"embeddings\")\n             return web.json_response(list(map(lambda a: os.path.splitext(a)[0], embeddings)))\n-        \n-        @routes.get(\"/models\")",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "1863883919",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 5841,
        "pr_file": "server.py",
        "discussion_id": "1863883919",
        "commented_code": "@@ -221,20 +222,6 @@ async def get_root(request):\n         def get_embeddings(self):\n             embeddings = folder_paths.get_filename_list(\"embeddings\")\n             return web.json_response(list(map(lambda a: os.path.splitext(a)[0], embeddings)))\n-        \n-        @routes.get(\"/models\")",
        "comment_created_at": "2024-11-29T19:30:08+00:00",
        "comment_author": "huchenlei",
        "comment_body": "We need to keep these routes for now if we want to merge this PR first. If we decide to land this PR after frontend changes has landed, the frontend side needs to be able to handle both APIs.",
        "pr_file_module": null
      },
      {
        "comment_id": "1864104890",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 5841,
        "pr_file": "server.py",
        "discussion_id": "1863883919",
        "commented_code": "@@ -221,20 +222,6 @@ async def get_root(request):\n         def get_embeddings(self):\n             embeddings = folder_paths.get_filename_list(\"embeddings\")\n             return web.json_response(list(map(lambda a: os.path.splitext(a)[0], embeddings)))\n-        \n-        @routes.get(\"/models\")",
        "comment_created_at": "2024-11-30T06:19:09+00:00",
        "comment_author": "hayden-fr",
        "comment_body": "These two APIs have not been removed, just moved to `model_filemanager/model_filemanager.py`. I can restore it if needed.",
        "pr_file_module": null
      },
      {
        "comment_id": "1864107073",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 5841,
        "pr_file": "server.py",
        "discussion_id": "1863883919",
        "commented_code": "@@ -221,20 +222,6 @@ async def get_root(request):\n         def get_embeddings(self):\n             embeddings = folder_paths.get_filename_list(\"embeddings\")\n             return web.json_response(list(map(lambda a: os.path.splitext(a)[0], embeddings)))\n-        \n-        @routes.get(\"/models\")",
        "comment_created_at": "2024-11-30T06:29:20+00:00",
        "comment_author": "hayden-fr",
        "comment_body": "The new API adds the prefix of `/experiment`. My plan is to retain the original API and then migrate it to the original API after the new function is stable.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1772900713",
    "pr_number": 2129,
    "pr_file": "nodes.py",
    "created_at": "2024-09-24T08:30:29+00:00",
    "commented_code": "\"negative\": (\"CONDITIONING\", ),\n                     \"latent_image\": (\"LATENT\", ),\n                     \"denoise\": (\"FLOAT\", {\"default\": 1.0, \"min\": 0.0, \"max\": 1.0, \"step\": 0.01}),\n+                    \"batch_behavior\": ([\"randomize\", \"fixed\", \"increment\", \"decrement\"],),",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "1772900713",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 2129,
        "pr_file": "nodes.py",
        "discussion_id": "1772900713",
        "commented_code": "@@ -1343,6 +1342,7 @@ def INPUT_TYPES(s):\n                     \"negative\": (\"CONDITIONING\", ),\n                     \"latent_image\": (\"LATENT\", ),\n                     \"denoise\": (\"FLOAT\", {\"default\": 1.0, \"min\": 0.0, \"max\": 1.0, \"step\": 0.01}),\n+                    \"batch_behavior\": ([\"randomize\", \"fixed\", \"increment\", \"decrement\"],),",
        "comment_created_at": "2024-09-24T08:30:29+00:00",
        "comment_author": "mcmonkey4eva",
        "comment_body": "this would need to be under `optional` to avoid breaking presaved api workflows (and use `=\"some_default\"` on the func params)",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1772884597",
    "pr_number": 2782,
    "pr_file": "nodes.py",
    "created_at": "2024-09-24T08:19:55+00:00",
    "commented_code": "def INPUT_TYPES(s):\n         return {\"required\": \n                     {\"images\": (\"IMAGE\", ),\n-                     \"filename_prefix\": (\"STRING\", {\"default\": \"ComfyUI\"})},\n+                     \"filename_prefix\": (\"STRING\", {\"default\": \"ComfyUI\"}),\n+                     \"disable_metadata\": (\"BOOLEAN\", {\"default\": False})},",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "1772884597",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 2782,
        "pr_file": "nodes.py",
        "discussion_id": "1772884597",
        "commented_code": "@@ -1419,7 +1419,8 @@ def __init__(self):\n     def INPUT_TYPES(s):\n         return {\"required\": \n                     {\"images\": (\"IMAGE\", ),\n-                     \"filename_prefix\": (\"STRING\", {\"default\": \"ComfyUI\"})},\n+                     \"filename_prefix\": (\"STRING\", {\"default\": \"ComfyUI\"}),\n+                     \"disable_metadata\": (\"BOOLEAN\", {\"default\": False})},",
        "comment_created_at": "2024-09-24T08:19:55+00:00",
        "comment_author": "mcmonkey4eva",
        "comment_body": "You would want to add this under `optional` to avoid breaking presaved API workflows",
        "pr_file_module": null
      }
    ]
  }
]