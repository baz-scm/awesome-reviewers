[
  {
    "discussion_id": "2147370135",
    "pr_number": 8351,
    "pr_file": "sandbox/windows_sandbox.py",
    "created_at": "2025-06-14T22:53:41+00:00",
    "commented_code": "+import logging\n+import win32con\n+import win32process\n+import win32security\n+import subprocess\n+import os\n+from win32com.shell import shellcon, shell\n+import win32api\n+import win32event\n+import folder_paths\n+\n+\n+LOW_INTEGRITY_SID_STRING = \"S-1-16-4096\"",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "2147370135",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8351,
        "pr_file": "sandbox/windows_sandbox.py",
        "discussion_id": "2147370135",
        "commented_code": "@@ -0,0 +1,172 @@\n+import logging\n+import win32con\n+import win32process\n+import win32security\n+import subprocess\n+import os\n+from win32com.shell import shellcon, shell\n+import win32api\n+import win32event\n+import folder_paths\n+\n+\n+LOW_INTEGRITY_SID_STRING = \"S-1-16-4096\"",
        "comment_created_at": "2025-06-14T22:53:41+00:00",
        "comment_author": "maludwig",
        "comment_body": "Consider adding a comment here explaining what \"S-1-16-4096\" means.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2147371234",
    "pr_number": 8351,
    "pr_file": "sandbox/windows_sandbox.py",
    "created_at": "2025-06-14T23:00:26+00:00",
    "commented_code": "+import logging",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "2147371234",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8351,
        "pr_file": "sandbox/windows_sandbox.py",
        "discussion_id": "2147371234",
        "commented_code": "@@ -0,0 +1,172 @@\n+import logging",
        "comment_created_at": "2025-06-14T23:00:26+00:00",
        "comment_author": "maludwig",
        "comment_body": "Consider adding a docstring to the top of the file to explain the file, since it's pretty far off in the weeds of win32. Perhaps something like:\r\n\r\n```python\r\n\"\"\"\r\nSandboxing Utilities for Low-Integrity Process Execution on Windows\r\n===================================================================\r\n\r\nThis module enables a sandboxed execution environment by lowering the\r\nintegrity level of the current process to \"Low\", which restricts file system\r\nand registry access for enhanced security. It ensures that specific\r\ndirectories are writable even under this constrained execution mode.\r\n\"\"\"\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2147371450",
    "pr_number": 8351,
    "pr_file": "sandbox/windows_sandbox.py",
    "created_at": "2025-06-14T23:01:31+00:00",
    "commented_code": "+import logging\n+import win32con\n+import win32process\n+import win32security\n+import subprocess\n+import os\n+from win32com.shell import shellcon, shell\n+import win32api\n+import win32event\n+import folder_paths\n+\n+\n+LOW_INTEGRITY_SID_STRING = \"S-1-16-4096\"\n+\n+# Use absolute path to prevent command injection\n+ICACLS_PATH = r\"C:\\Windows\\System32\\icacls.exe\"\n+\n+\n+def set_process_integrity_level_to_low():",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "2147371450",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 8351,
        "pr_file": "sandbox/windows_sandbox.py",
        "discussion_id": "2147371450",
        "commented_code": "@@ -0,0 +1,172 @@\n+import logging\n+import win32con\n+import win32process\n+import win32security\n+import subprocess\n+import os\n+from win32com.shell import shellcon, shell\n+import win32api\n+import win32event\n+import folder_paths\n+\n+\n+LOW_INTEGRITY_SID_STRING = \"S-1-16-4096\"\n+\n+# Use absolute path to prevent command injection\n+ICACLS_PATH = r\"C:\\Windows\\System32\\icacls.exe\"\n+\n+\n+def set_process_integrity_level_to_low():",
        "comment_created_at": "2025-06-14T23:01:31+00:00",
        "comment_author": "maludwig",
        "comment_body": "Consider docstrings for each of these, since they're modestly advances win32, like:\r\n\r\n```python\r\n\r\n    \"\"\"\r\n    Set the current process to run at a low integrity level.\r\n\r\n    This restricts the process's permissions, creating a sandboxed environment\r\n    to limit potential damage if compromised.\r\n    \"\"\"\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1788290183",
    "pr_number": 5152,
    "pr_file": "app/frontend_management.py",
    "created_at": "2024-10-04T20:44:20+00:00",
    "commented_code": "Path(cls.CUSTOM_FRONTENDS_ROOT) / provider.folder_name / semantic_version\n         )\n         if not os.path.exists(web_root):\n+            tmp_path = web_root + \".tmp\"",
    "repo_full_name": "comfyanonymous/ComfyUI",
    "discussion_comments": [
      {
        "comment_id": "1788290183",
        "repo_full_name": "comfyanonymous/ComfyUI",
        "pr_number": 5152,
        "pr_file": "app/frontend_management.py",
        "discussion_id": "1788290183",
        "commented_code": "@@ -159,16 +168,19 @@ def init_frontend_unsafe(cls, version_string: str, provider: Optional[FrontEndPr\n             Path(cls.CUSTOM_FRONTENDS_ROOT) / provider.folder_name / semantic_version\n         )\n         if not os.path.exists(web_root):\n+            tmp_path = web_root + \".tmp\"",
        "comment_created_at": "2024-10-04T20:44:20+00:00",
        "comment_author": "huchenlei",
        "comment_body": "Please clearly document that why the \".tmp\" move is necessary. i.e. put a comment here describing the considerations stated in \r\n\r\n> Also moves the download to a folder with a .tmp suffix until everything's extracted as otherwise you can CTRL+C the comfy window while it's downloading and get stuck in a state where comfyui thinks its has the frontend downloaded but it doesn't actually.\r\n",
        "pr_file_module": null
      }
    ]
  }
]