[
  {
    "discussion_id": "349628013",
    "pr_number": 7009,
    "pr_file": "script/run/run.sh",
    "created_at": "2019-11-22T14:41:04+00:00",
    "commented_code": "# Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
    "repo_full_name": "docker/compose",
    "discussion_comments": [
      {
        "comment_id": "349628013",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T14:41:04+00:00",
        "comment_author": "ulyssessouza",
        "comment_body": "The absence of `[ ]` breaks the formatting compatibility with the others",
        "pr_file_module": null
      },
      {
        "comment_id": "349636847",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T14:57:52+00:00",
        "comment_author": "glance-",
        "comment_body": "Sorry, but I don't understand your statement here.",
        "pr_file_module": null
      },
      {
        "comment_id": "349637946",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T14:59:56+00:00",
        "comment_author": "glance-",
        "comment_body": "[ is not syntax, nor formating, its a semarate tool, also known as test.\r\n\r\nif looks at the exit code from [ in the previous code, and in the change I've written it looks at the exit code from grep instead.",
        "pr_file_module": null
      },
      {
        "comment_id": "349638858",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T15:01:42+00:00",
        "comment_author": "glance-",
        "comment_body": "More about this can be read at https://github.com/koalaman/shellcheck/wiki/SC2143",
        "pr_file_module": null
      },
      {
        "comment_id": "349639466",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T15:02:54+00:00",
        "comment_author": "glance-",
        "comment_body": "https://github.com/koalaman/shellcheck/wiki/SC2236 is also related to previous code.",
        "pr_file_module": null
      },
      {
        "comment_id": "349645636",
        "repo_full_name": "docker/compose",
        "pr_number": 7009,
        "pr_file": "script/run/run.sh",
        "discussion_id": "349628013",
        "commented_code": "@@ -56,8 +56,9 @@ DOCKER_RUN_OPTIONS=\"$DOCKER_RUN_OPTIONS -i\"\n \n \n # Handle userns security\n-if [ ! -z \"$(docker info 2>/dev/null | grep userns)\" ]; then\n+if docker info 2>/dev/null | grep -q userns; then",
        "comment_created_at": "2019-11-22T15:14:29+00:00",
        "comment_author": "thaJeztah",
        "comment_body": "A minor optimisation could be to use `--format` (so that only the Security options are output), and/or to match `name=userns` instead of just `userns` (as that's what the daemon will return; https://github.com/moby/moby/blob/b6684a403c99aaf6be5b8ce0bef3c6650fcdcd12/daemon/info.go#L180-L182\r\n\r\n```suggestion\r\nif docker info --format '{{json .SecurityOptions}}' 2>/dev/null | grep -q 'name=userns'; then\r\n```",
        "pr_file_module": null
      }
    ]
  }
]