[
  {
    "discussion_id": "578326621",
    "pr_number": 2273,
    "pr_file": "src/Ignitor/SignalsListener/index.ts",
    "created_at": "2021-02-18T11:05:37+00:00",
    "commented_code": "*/\n   public listen(callback: () => Promise<void>) {\n     this.onCloseCallback = callback\n-    if (process.env.pm_id) {\n-      process.once('SIGINT', this.kill)\n-    }\n-\n-    process.once('SIGTERM', this.kill)\n+    process.on('SIGINT', this.kill)\n+    process.on('SIGTERM', this.kill)\n \n     /**\n      * Cleanup on uncaught exceptions.\n      */\n-    process.once('uncaughtException', (error) => {\n+    process.on('uncaughtException', (error) => {",
    "repo_full_name": "adonisjs/core",
    "discussion_comments": [
      {
        "comment_id": "578326621",
        "repo_full_name": "adonisjs/core",
        "pr_number": 2273,
        "pr_file": "src/Ignitor/SignalsListener/index.ts",
        "discussion_id": "578326621",
        "commented_code": "@@ -36,16 +50,13 @@ export class SignalsListener {\n    */\n   public listen(callback: () => Promise<void>) {\n     this.onCloseCallback = callback\n-    if (process.env.pm_id) {\n-      process.once('SIGINT', this.kill)\n-    }\n-\n-    process.once('SIGTERM', this.kill)\n+    process.on('SIGINT', this.kill)\n+    process.on('SIGTERM', this.kill)\n \n     /**\n      * Cleanup on uncaught exceptions.\n      */\n-    process.once('uncaughtException', (error) => {\n+    process.on('uncaughtException', (error) => {",
        "comment_created_at": "2021-02-18T11:05:37+00:00",
        "comment_author": "targos",
        "comment_body": "that's not directly related to this PR, so I can do it in a separate one if you prefer. I changed to `process.on` so that in the REPL, all uncaught exceptions are handled (not only the first one)",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "862494964",
    "pr_number": 3703,
    "pr_file": "commands/ListRoutes/index.ts",
    "created_at": "2022-05-01T16:21:05+00:00",
    "commented_code": "} else {\n       new RoutesPrettyRenderer(this).render()\n     }\n+    \n+    await this.application.shutdown()",
    "repo_full_name": "adonisjs/core",
    "discussion_comments": [
      {
        "comment_id": "862494964",
        "repo_full_name": "adonisjs/core",
        "pr_number": 3703,
        "pr_file": "commands/ListRoutes/index.ts",
        "discussion_id": "862494964",
        "commented_code": "@@ -175,5 +176,7 @@ export default class ListRoutes extends BaseCommand {\n     } else {\n       new RoutesPrettyRenderer(this).render()\n     }\n+    \n+    await this.application.shutdown()",
        "comment_created_at": "2022-05-01T16:21:05+00:00",
        "comment_author": "Julien-R44",
        "comment_body": "Shouldn't we use `await this.exit()` ? I'm not sure about the difference, I'll have to dig into the code",
        "pr_file_module": null
      },
      {
        "comment_id": "862575497",
        "repo_full_name": "adonisjs/core",
        "pr_number": 3703,
        "pr_file": "commands/ListRoutes/index.ts",
        "discussion_id": "862494964",
        "commented_code": "@@ -175,5 +176,7 @@ export default class ListRoutes extends BaseCommand {\n     } else {\n       new RoutesPrettyRenderer(this).render()\n     }\n+    \n+    await this.application.shutdown()",
        "comment_created_at": "2022-05-02T03:47:18+00:00",
        "comment_author": "thetutlage",
        "comment_body": "The `await this.exit()` will exit the process forcefully. Whereas, the `this.application.shutdown()` notifies all the providers to start graceful shutdown.\r\n\r\nIf the issue is that `process.exit` in Node.js interrupts the `stdout`, then we cannot use `await this.exit()`. ",
        "pr_file_module": null
      },
      {
        "comment_id": "862615137",
        "repo_full_name": "adonisjs/core",
        "pr_number": 3703,
        "pr_file": "commands/ListRoutes/index.ts",
        "discussion_id": "862494964",
        "commented_code": "@@ -175,5 +176,7 @@ export default class ListRoutes extends BaseCommand {\n     } else {\n       new RoutesPrettyRenderer(this).render()\n     }\n+    \n+    await this.application.shutdown()",
        "comment_created_at": "2022-05-02T06:30:42+00:00",
        "comment_author": "Julien-R44",
        "comment_body": "Ok thanks that totally makes sense !\r\nIndeed, by replacing with `this.exit`, the same problem happens ",
        "pr_file_module": null
      }
    ]
  }
]