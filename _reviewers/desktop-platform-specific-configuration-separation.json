[
  {
    "discussion_id": "1853107009",
    "pr_number": 3135,
    "pr_file": "configs/macos/mozconfig",
    "created_at": "2024-11-22T00:10:44+00:00",
    "commented_code": "-\n-# SURFER_COMPAT has a different meaning here, in macOS it means that the build is for\n-# x86_64, not ARM64. \n unset MOZ_STDCXX_COMPAT\n \n ac_add_options --disable-dmd\n \n export MOZ_MACBUNDLE_ID=${appId}\n export MOZ_MACBUNDLE_NAME=\"Zen Browser.app\"\n \n-if test \"$SURFER_COMPAT\" = \"true\"; then\n+if test \"$SURFER_COMPAT\" = \"x86_64\"; then\n     export MOZ_PGO=1\n     ac_add_options MOZ_PGO=1\n     ac_add_options --target=x86_64-apple-darwin\n+    ac_add_options --enable-eme=widevine",
    "repo_full_name": "zen-browser/desktop",
    "discussion_comments": [
      {
        "comment_id": "1853107009",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/macos/mozconfig",
        "discussion_id": "1853107009",
        "commented_code": "@@ -1,17 +1,15 @@\n-\n-# SURFER_COMPAT has a different meaning here, in macOS it means that the build is for\n-# x86_64, not ARM64. \n unset MOZ_STDCXX_COMPAT\n \n ac_add_options --disable-dmd\n \n export MOZ_MACBUNDLE_ID=${appId}\n export MOZ_MACBUNDLE_NAME=\"Zen Browser.app\"\n \n-if test \"$SURFER_COMPAT\" = \"true\"; then\n+if test \"$SURFER_COMPAT\" = \"x86_64\"; then\n     export MOZ_PGO=1\n     ac_add_options MOZ_PGO=1\n     ac_add_options --target=x86_64-apple-darwin\n+    ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T00:10:44+00:00",
        "comment_author": "mr-cheffy",
        "comment_body": "Please remove this",
        "pr_file_module": null
      },
      {
        "comment_id": "1853157119",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/macos/mozconfig",
        "discussion_id": "1853107009",
        "commented_code": "@@ -1,17 +1,15 @@\n-\n-# SURFER_COMPAT has a different meaning here, in macOS it means that the build is for\n-# x86_64, not ARM64. \n unset MOZ_STDCXX_COMPAT\n \n ac_add_options --disable-dmd\n \n export MOZ_MACBUNDLE_ID=${appId}\n export MOZ_MACBUNDLE_NAME=\"Zen Browser.app\"\n \n-if test \"$SURFER_COMPAT\" = \"true\"; then\n+if test \"$SURFER_COMPAT\" = \"x86_64\"; then\n     export MOZ_PGO=1\n     ac_add_options MOZ_PGO=1\n     ac_add_options --target=x86_64-apple-darwin\n+    ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T01:23:12+00:00",
        "comment_author": "omove",
        "comment_body": "Is Widevine not supported on macOS? It was in the common file so it should work, it doesn't say enable-eme is an invalid option like aarch64 Linux does.\r\nEdit: Yeah, it should definitely be there, OSX has widevine support listed under it.\r\nhttps://searchfox.org/mozilla-central/source/toolkit/moz.configure#914",
        "pr_file_module": null
      },
      {
        "comment_id": "1853382018",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/macos/mozconfig",
        "discussion_id": "1853107009",
        "commented_code": "@@ -1,17 +1,15 @@\n-\n-# SURFER_COMPAT has a different meaning here, in macOS it means that the build is for\n-# x86_64, not ARM64. \n unset MOZ_STDCXX_COMPAT\n \n ac_add_options --disable-dmd\n \n export MOZ_MACBUNDLE_ID=${appId}\n export MOZ_MACBUNDLE_NAME=\"Zen Browser.app\"\n \n-if test \"$SURFER_COMPAT\" = \"true\"; then\n+if test \"$SURFER_COMPAT\" = \"x86_64\"; then\n     export MOZ_PGO=1\n     ac_add_options MOZ_PGO=1\n     ac_add_options --target=x86_64-apple-darwin\n+    ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T07:09:36+00:00",
        "comment_author": "mr-cheffy",
        "comment_body": "Remove all of them and add it how it was on the common mozconfig",
        "pr_file_module": null
      },
      {
        "comment_id": "1853397466",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/macos/mozconfig",
        "discussion_id": "1853107009",
        "commented_code": "@@ -1,17 +1,15 @@\n-\n-# SURFER_COMPAT has a different meaning here, in macOS it means that the build is for\n-# x86_64, not ARM64. \n unset MOZ_STDCXX_COMPAT\n \n ac_add_options --disable-dmd\n \n export MOZ_MACBUNDLE_ID=${appId}\n export MOZ_MACBUNDLE_NAME=\"Zen Browser.app\"\n \n-if test \"$SURFER_COMPAT\" = \"true\"; then\n+if test \"$SURFER_COMPAT\" = \"x86_64\"; then\n     export MOZ_PGO=1\n     ac_add_options MOZ_PGO=1\n     ac_add_options --target=x86_64-apple-darwin\n+    ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T07:25:16+00:00",
        "comment_author": "omove",
        "comment_body": "Okay, I moved it outside the platform block, I assume that's what you meant.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1853107404",
    "pr_number": 3135,
    "pr_file": "configs/common/mozconfig",
    "created_at": "2024-11-22T00:11:23+00:00",
    "commented_code": "ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
    "repo_full_name": "zen-browser/desktop",
    "discussion_comments": [
      {
        "comment_id": "1853107404",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/common/mozconfig",
        "discussion_id": "1853107404",
        "commented_code": "@@ -89,7 +89,6 @@ ac_add_options --enable-raw\n ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T00:11:23+00:00",
        "comment_author": "mr-cheffy",
        "comment_body": "Why is this being removed?",
        "pr_file_module": null
      },
      {
        "comment_id": "1853113372",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/common/mozconfig",
        "discussion_id": "1853107404",
        "commented_code": "@@ -89,7 +89,6 @@ ac_add_options --enable-raw\n ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T00:21:55+00:00",
        "comment_author": "omove",
        "comment_body": "DRM support varies by architecture and OS. Linux aarch64 doesn't support widevine so it can't be enabled in the common mozconfig.",
        "pr_file_module": null
      },
      {
        "comment_id": "1853114475",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/common/mozconfig",
        "discussion_id": "1853107404",
        "commented_code": "@@ -89,7 +89,6 @@ ac_add_options --enable-raw\n ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T00:23:54+00:00",
        "comment_author": "mr-cheffy",
        "comment_body": "Linux does support it, that's why it's in the common.. If not, people wont be able to play netflix on linux",
        "pr_file_module": null
      },
      {
        "comment_id": "1853117137",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/common/mozconfig",
        "discussion_id": "1853107404",
        "commented_code": "@@ -89,7 +89,6 @@ ac_add_options --enable-raw\n ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T00:28:26+00:00",
        "comment_author": "omove",
        "comment_body": "No, you can't compile with it enabled on Linux aarch64, it was moved to the individual os/arch mozconfigs because it had to be.",
        "pr_file_module": null
      },
      {
        "comment_id": "1853150975",
        "repo_full_name": "zen-browser/desktop",
        "pr_number": 3135,
        "pr_file": "configs/common/mozconfig",
        "discussion_id": "1853107404",
        "commented_code": "@@ -89,7 +89,6 @@ ac_add_options --enable-raw\n ac_add_options --enable-webrtc\n ac_add_options --enable-jxl\n ac_add_options --enable-av1\n-ac_add_options --enable-eme=widevine",
        "comment_created_at": "2024-11-22T01:13:01+00:00",
        "comment_author": "omove",
        "comment_body": "Specifically, the Linux aarch64 build will fail with \r\n``mozbuild.configure.options.InvalidOptionError: --enable-eme is not available in this configuration``\r\n\r\nTor browser also had to change theirs because of this\r\nhttps://gitlab.torproject.org/tpo/applications/tor-browser/-/issues/42501",
        "pr_file_module": null
      }
    ]
  }
]