[
  {
    "discussion_id": "2188882436",
    "pr_number": 19601,
    "pr_file": "django/contrib/admin/static/admin/js/inlines.js",
    "created_at": "2025-07-07T03:14:58+00:00",
    "commented_code": "break;\n             }\n         });\n+\n+        // Close collapsible inlines that don't have the \"open\" class\n+        // This is done after autocomplete initialization to prevent width calculation issues\n+        $('.js-inline-admin-formset fieldset.module.collapse:not(.open) details[open]').each(function() {\n+            this.removeAttribute('open');\n+        });",
    "repo_full_name": "django/django",
    "discussion_comments": [
      {
        "comment_id": "2188882436",
        "repo_full_name": "django/django",
        "pr_number": 19601,
        "pr_file": "django/contrib/admin/static/admin/js/inlines.js",
        "discussion_id": "2188882436",
        "commented_code": "@@ -355,5 +355,11 @@\n                 break;\n             }\n         });\n+\n+        // Close collapsible inlines that don't have the \"open\" class\n+        // This is done after autocomplete initialization to prevent width calculation issues\n+        $('.js-inline-admin-formset fieldset.module.collapse:not(.open) details[open]').each(function() {\n+            this.removeAttribute('open');\n+        });",
        "comment_created_at": "2025-07-07T03:14:58+00:00",
        "comment_author": "michalpokusa",
        "comment_body": "```suggestion\r\n        // Close collapsibles that don't have the \"open\" class\r\n        // This is done after autocomplete initialization to prevent width calculation issues (#36336)\r\n        document.querySelectorAll('fieldset.module.collapse:not(.open) details[open]').forEach(details => {\r\n            details.removeAttribute('open');\r\n        });\r\n```\r\n\r\nBecause the same applies to collapsible fieldsets, this should not be in `inlines.js`.\r\nThe `collapse.js` removed in #17910, would be a good place for it, but I am not sure how maintainers would feel about re-adding it.\r\n\r\nThe other option is to add it to the `change_form.js`, which I would go with.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2189689084",
    "pr_number": 19601,
    "pr_file": "django/contrib/admin/static/admin/js/change_form.js",
    "created_at": "2025-07-07T10:48:55+00:00",
    "commented_code": "}\n         }\n     }\n+    \n+    // Close collapsibles that don't have the \"open\" class\n+    // This is done after autocomplete initialization to prevent width calculation issues (#36336)\n+    document.addEventListener('DOMContentLoaded', function() {",
    "repo_full_name": "django/django",
    "discussion_comments": [
      {
        "comment_id": "2189689084",
        "repo_full_name": "django/django",
        "pr_number": 19601,
        "pr_file": "django/contrib/admin/static/admin/js/change_form.js",
        "discussion_id": "2189689084",
        "commented_code": "@@ -13,4 +13,12 @@\n             }\n         }\n     }\n+    \n+    // Close collapsibles that don't have the \"open\" class\n+    // This is done after autocomplete initialization to prevent width calculation issues (#36336)\n+    document.addEventListener('DOMContentLoaded', function() {",
        "comment_created_at": "2025-07-07T10:48:55+00:00",
        "comment_author": "michalpokusa",
        "comment_body": "Unnecessary spaces on line 16.\r\n\r\nNo need for listening for \"DOMContentLoaded\", this script is loaded in `admin_change_form_document_ready` block after the main content of the page. Similarly the existing code in `change_form.js` does not use event listening. Also, this will not work there as the script is import with `async` so the event most of the time will trigger before the script executes.\r\n\r\nhttps://github.com/django/django/blob/main/django/contrib/admin/templates/admin/change_form.html#L67-L75",
        "pr_file_module": null
      }
    ]
  }
]