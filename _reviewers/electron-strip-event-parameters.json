[
  {
    "discussion_id": "1306774525",
    "pr_number": 39613,
    "pr_file": "docs/fiddles/windows/manage-windows/window-events/preload.js",
    "created_at": "2023-08-28T00:48:09+00:00",
    "commented_code": "+const { contextBridge, ipcRenderer } = require('electron')\n+\n+contextBridge.exposeInMainWorld('electronAPI', {\n+  showDemoWindow: () => ipcRenderer.send('show-demo-window'),\n+  focusDemoWindow: () => ipcRenderer.send('focus-demo-window'),\n+  onWindowFocus: (callback) => ipcRenderer.on('window-focus', callback),\n+  onWindowBlur: (callback) => ipcRenderer.on('window-blur', callback),\n+  onWindowClose: (callback) => ipcRenderer.on('window-close', callback)",
    "repo_full_name": "electron/electron",
    "discussion_comments": [
      {
        "comment_id": "1306774525",
        "repo_full_name": "electron/electron",
        "pr_number": 39613,
        "pr_file": "docs/fiddles/windows/manage-windows/window-events/preload.js",
        "discussion_id": "1306774525",
        "commented_code": "@@ -0,0 +1,9 @@\n+const { contextBridge, ipcRenderer } = require('electron')\n+\n+contextBridge.exposeInMainWorld('electronAPI', {\n+  showDemoWindow: () => ipcRenderer.send('show-demo-window'),\n+  focusDemoWindow: () => ipcRenderer.send('focus-demo-window'),\n+  onWindowFocus: (callback) => ipcRenderer.on('window-focus', callback),\n+  onWindowBlur: (callback) => ipcRenderer.on('window-blur', callback),\n+  onWindowClose: (callback) => ipcRenderer.on('window-close', callback)",
        "comment_created_at": "2023-08-28T00:48:09+00:00",
        "comment_author": "dsanders11",
        "comment_body": "Best security practice here is to strip the event parameter before calling the callback, e.g.\r\n\r\n```js\r\nonWindowFocus: (callback) => ipcRenderer.on('window-focus', () => callback()),\r\n```\r\n\r\nOtherwise we leak `event.sender` to the renderer and it can send arbitrary IPC.",
        "pr_file_module": null
      },
      {
        "comment_id": "1307158368",
        "repo_full_name": "electron/electron",
        "pr_number": 39613,
        "pr_file": "docs/fiddles/windows/manage-windows/window-events/preload.js",
        "discussion_id": "1306774525",
        "commented_code": "@@ -0,0 +1,9 @@\n+const { contextBridge, ipcRenderer } = require('electron')\n+\n+contextBridge.exposeInMainWorld('electronAPI', {\n+  showDemoWindow: () => ipcRenderer.send('show-demo-window'),\n+  focusDemoWindow: () => ipcRenderer.send('focus-demo-window'),\n+  onWindowFocus: (callback) => ipcRenderer.on('window-focus', callback),\n+  onWindowBlur: (callback) => ipcRenderer.on('window-blur', callback),\n+  onWindowClose: (callback) => ipcRenderer.on('window-close', callback)",
        "comment_created_at": "2023-08-28T09:06:29+00:00",
        "comment_author": "miniak",
        "comment_body": "btw we had this in the existing code https://github.com/electron/electron/blob/d42a94dddeb86d349c050c2ee59b135bd6c8245c/docs/fiddles/ipc/pattern-3/preload.js#L1-L5\r\nI am fixing all the occurences",
        "pr_file_module": null
      }
    ]
  }
]