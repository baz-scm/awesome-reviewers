[
  {
    "discussion_id": "56101253",
    "pr_number": 2936,
    "pr_file": "lib/response.js",
    "created_at": "2016-03-15T00:55:03+00:00",
    "commented_code": "done = options;\n     opts = {};\n   }\n+  \n+  if (app.settings.etag == false) {\n+        opts.etag = app.settings.etag;",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "56101253",
        "repo_full_name": "expressjs/express",
        "pr_number": 2936,
        "pr_file": "lib/response.js",
        "discussion_id": "56101253",
        "commented_code": "@@ -368,6 +371,10 @@ res.sendFile = function sendFile(path, options, callback) {\n     done = options;\n     opts = {};\n   }\n+  \n+  if (app.settings.etag == false) {\n+        opts.etag = app.settings.etag;",
        "comment_created_at": "2016-03-15T00:55:03+00:00",
        "comment_author": "dougwilson",
        "comment_body": "I would expect that if the user explicitly set the `etag` option to `res.sendFile`, it would not be overwritten by the setting.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "56101270",
    "pr_number": 2936,
    "pr_file": "lib/response.js",
    "created_at": "2016-03-15T00:55:27+00:00",
    "commented_code": "done = options;\n     opts = {};\n   }\n+  \n+  if (app.settings.etag == false) {",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "56101270",
        "repo_full_name": "expressjs/express",
        "pr_number": 2936,
        "pr_file": "lib/response.js",
        "discussion_id": "56101270",
        "commented_code": "@@ -368,6 +371,10 @@ res.sendFile = function sendFile(path, options, callback) {\n     done = options;\n     opts = {};\n   }\n+  \n+  if (app.settings.etag == false) {",
        "comment_created_at": "2016-03-15T00:55:27+00:00",
        "comment_author": "dougwilson",
        "comment_body": "You should use the setting functions to access settings, not direct access to the object. Direct object access was deprecated in 3.0.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "422205",
    "pr_number": 996,
    "pr_file": "lib/response.js",
    "created_at": "2012-02-07T06:53:40+00:00",
    "commented_code": "obj = arguments[1];\n   }\n \n-  var body = JSON.stringify(obj)\n+  var space = 2 * process.env.NODE_ENV == 'development'",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "422205",
        "repo_full_name": "expressjs/express",
        "pr_number": 996,
        "pr_file": "lib/response.js",
        "discussion_id": "422205",
        "commented_code": "@@ -156,7 +155,8 @@ res.json = function(obj){\n     obj = arguments[1];\n   }\n \n-  var body = JSON.stringify(obj)\n+  var space = 2 * process.env.NODE_ENV == 'development'",
        "comment_created_at": "2012-02-07T06:53:40+00:00",
        "comment_author": "tj",
        "comment_body": "AFAIK node uses a getter and will getenv() each time (go magical getters go..) so we're probably better off getting a tiny bit extra milage using the obscure `this.app.settings.env` since it's already set but other than that I like it! much nicer to read\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2188028",
    "pr_number": 1421,
    "pr_file": "lib/response.js",
    "created_at": "2012-11-20T22:43:10+00:00",
    "commented_code": "// ETag support\n   // TODO: W/ support\n-  if (len > 1024) {\n-    if (!this.get('ETag')) {\n-      this.set('ETag', etag(body));\n+  if (app.settings['etag']) {\n+    if (len > 1024) {",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "2188028",
        "repo_full_name": "expressjs/express",
        "pr_number": 1421,
        "pr_file": "lib/response.js",
        "discussion_id": "2188028",
        "commented_code": "@@ -128,9 +131,11 @@ res.send = function(body){\n \n   // ETag support\n   // TODO: W/ support\n-  if (len > 1024) {\n-    if (!this.get('ETag')) {\n-      this.set('ETag', etag(body));\n+  if (app.settings['etag']) {\n+    if (len > 1024) {",
        "comment_created_at": "2012-11-20T22:43:10+00:00",
        "comment_author": "tj",
        "comment_body": "might as well do `if (app.settings.etag && len > ..)` \n",
        "pr_file_module": null
      }
    ]
  }
]