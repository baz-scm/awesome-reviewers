[
  {
    "discussion_id": "102400517",
    "pr_number": 3213,
    "pr_file": "lib/express.js",
    "created_at": "2017-02-22T07:48:16+00:00",
    "commented_code": "* @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "102400517",
        "repo_full_name": "expressjs/express",
        "pr_number": 3213,
        "pr_file": "lib/express.js",
        "discussion_id": "102400517",
        "commented_code": "@@ -32,16 +57,22 @@ exports = module.exports = createApplication;\n  * @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}",
        "comment_created_at": "2017-02-22T07:48:16+00:00",
        "comment_author": "dougwilson",
        "comment_body": "Probably don't want to reassign values linked to arguments, since it silently alters `arguments[0]`. Usually I would just name the argument `options` and this line as `var opts = options || {}`\r\n```\r\n$ node -pe '(function(foo){foo=foo||{};return arguments[0] === null}(null))'\r\nfalse\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "102957211",
        "repo_full_name": "expressjs/express",
        "pr_number": 3213,
        "pr_file": "lib/express.js",
        "discussion_id": "102400517",
        "commented_code": "@@ -32,16 +57,22 @@ exports = module.exports = createApplication;\n  * @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}",
        "comment_created_at": "2017-02-24T14:59:56+00:00",
        "comment_author": "wesleytodd",
        "comment_body": "Good call, fixed.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "102400674",
    "pr_number": 3213,
    "pr_file": "lib/express.js",
    "created_at": "2017-02-22T07:49:51+00:00",
    "commented_code": "* @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}\n+  opts.reqProto = opts.reqProto || http.IncomingMessage.prototype\n+  opts.resProto = opts.resProto || http.ServerResponse.prototype\n+  opts.createServer = opts.createServer || http.createServer",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "102400674",
        "repo_full_name": "expressjs/express",
        "pr_number": 3213,
        "pr_file": "lib/express.js",
        "discussion_id": "102400674",
        "commented_code": "@@ -32,16 +57,22 @@ exports = module.exports = createApplication;\n  * @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}\n+  opts.reqProto = opts.reqProto || http.IncomingMessage.prototype\n+  opts.resProto = opts.resProto || http.ServerResponse.prototype\n+  opts.createServer = opts.createServer || http.createServer",
        "comment_created_at": "2017-02-22T07:49:51+00:00",
        "comment_author": "dougwilson",
        "comment_body": "Usually not best practice to alter the object someone is passing in; the object could potentially be frozen, even, causing an exception here. `var createServer = opts.createServer || http.createServer` is probably fine (and then changing the vars below).",
        "pr_file_module": null
      },
      {
        "comment_id": "102957244",
        "repo_full_name": "expressjs/express",
        "pr_number": 3213,
        "pr_file": "lib/express.js",
        "discussion_id": "102400674",
        "commented_code": "@@ -32,16 +57,22 @@ exports = module.exports = createApplication;\n  * @api public\n  */\n \n-function createApplication() {\n+function createApplication(opts) {\n+  opts = opts || {}\n+  opts.reqProto = opts.reqProto || http.IncomingMessage.prototype\n+  opts.resProto = opts.resProto || http.ServerResponse.prototype\n+  opts.createServer = opts.createServer || http.createServer",
        "comment_created_at": "2017-02-24T15:00:05+00:00",
        "comment_author": "wesleytodd",
        "comment_body": "Fixed.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "56753494",
    "pr_number": 2936,
    "pr_file": "lib/response.js",
    "created_at": "2016-03-19T19:04:12+00:00",
    "commented_code": "done = options;\n     opts = {};\n   }\n+  \n+  if(! ('etag' in opts) ) {",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "56753494",
        "repo_full_name": "expressjs/express",
        "pr_number": 2936,
        "pr_file": "lib/response.js",
        "discussion_id": "56753494",
        "commented_code": "@@ -368,6 +369,10 @@ res.sendFile = function sendFile(path, options, callback) {\n     done = options;\n     opts = {};\n   }\n+  \n+  if(! ('etag' in opts) ) {",
        "comment_created_at": "2016-03-19T19:04:12+00:00",
        "comment_author": "dougwilson",
        "comment_body": "Pleas do not use in for option detection. This makes the interface really confusing because you have to ensure that whatever you are passing in does not have that key anywhere in the prototype chain.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "56755171",
    "pr_number": 2936,
    "pr_file": "lib/response.js",
    "created_at": "2016-03-19T21:10:15+00:00",
    "commented_code": "done = options;\n     opts = {};\n   }\n+  \n+  if(typeof opts.etag == 'undefined') {\n+      opts.etag = app.set('etag');",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "56755171",
        "repo_full_name": "expressjs/express",
        "pr_number": 2936,
        "pr_file": "lib/response.js",
        "discussion_id": "56755171",
        "commented_code": "@@ -368,6 +369,10 @@ res.sendFile = function sendFile(path, options, callback) {\n     done = options;\n     opts = {};\n   }\n+  \n+  if(typeof opts.etag == 'undefined') {\n+      opts.etag = app.set('etag');",
        "comment_created_at": "2016-03-19T21:10:15+00:00",
        "comment_author": "dougwilson",
        "comment_body": "Do not pass in non-booleans to the sub module, because that is just asking for undefined behavior later. The etag option only accepts true or false.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "3812562",
    "pr_number": 1579,
    "pr_file": "lib/request.js",
    "created_at": "2013-04-16T14:19:31+00:00",
    "commented_code": "req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "3812562",
        "repo_full_name": "expressjs/express",
        "pr_number": 1579,
        "pr_file": "lib/request.js",
        "discussion_id": "3812562",
        "commented_code": "@@ -472,7 +473,10 @@ req.__defineGetter__('path', function(){\n req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
        "comment_created_at": "2013-04-16T14:19:31+00:00",
        "comment_author": "tj",
        "comment_body": "this one wont need the typeof just `if (!host)` since it will never be \"0\" etc\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "3813684",
    "pr_number": 1579,
    "pr_file": "lib/request.js",
    "created_at": "2013-04-16T15:10:38+00:00",
    "commented_code": "req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "3813684",
        "repo_full_name": "expressjs/express",
        "pr_number": 1579,
        "pr_file": "lib/request.js",
        "discussion_id": "3813684",
        "commented_code": "@@ -472,7 +473,10 @@ req.__defineGetter__('path', function(){\n req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
        "comment_created_at": "2013-04-16T15:10:38+00:00",
        "comment_author": "tj",
        "comment_body": "not true, typeof isn't necessary unless something may not be declared, which is very rare. `host == null` covers both null and undefined\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "3813739",
    "pr_number": 1579,
    "pr_file": "lib/request.js",
    "created_at": "2013-04-16T15:13:30+00:00",
    "commented_code": "req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "3813739",
        "repo_full_name": "expressjs/express",
        "pr_number": 1579,
        "pr_file": "lib/request.js",
        "discussion_id": "3813739",
        "commented_code": "@@ -472,7 +473,10 @@ req.__defineGetter__('path', function(){\n req.__defineGetter__('host', function(){\n   var trustProxy = this.app.get('trust proxy');\n   var host = trustProxy && this.get('X-Forwarded-Host');\n-  host = host || this.get('Host');\n+  if (host === false || typeof host === 'undefined')  // If X-Forwarded-Host is present but empty, return it.\n+    host = this.get('Host');\n+  if (typeof host === 'undefined')",
        "comment_created_at": "2013-04-16T15:13:30+00:00",
        "comment_author": "SLaks",
        "comment_body": "True, but I prefer to be more explicit (using strict equality).  \nUsing `=== undefined` would work, though.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "9212701",
    "pr_number": 1908,
    "pr_file": "lib/middleware.js",
    "created_at": "2014-01-28T00:15:36+00:00",
    "commented_code": "req.__proto__ = app.request;\n     res.__proto__ = app.response;\n \n-    res.locals = res.locals || utils.locals(res);\n+    res.locals = res.locals || {};",
    "repo_full_name": "expressjs/express",
    "discussion_comments": [
      {
        "comment_id": "9212701",
        "repo_full_name": "expressjs/express",
        "pr_number": 1908,
        "pr_file": "lib/middleware.js",
        "discussion_id": "9212701",
        "commented_code": "@@ -25,7 +25,7 @@ exports.init = function(app){\n     req.__proto__ = app.request;\n     res.__proto__ = app.response;\n \n-    res.locals = res.locals || utils.locals(res);\n+    res.locals = res.locals || {};",
        "comment_created_at": "2014-01-28T00:15:36+00:00",
        "comment_author": "jonathanong",
        "comment_body": "maybe `Object.create(null)` this too?\n",
        "pr_file_module": null
      }
    ]
  }
]