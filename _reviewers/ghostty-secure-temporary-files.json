[
  {
    "discussion_id": "2169317085",
    "pr_number": 7608,
    "pr_file": "src/shell-integration/bash/ghostty.bash",
    "created_at": "2025-06-26T15:16:17+00:00",
    "commented_code": "}\n fi\n \n+# SSH Integration\n+if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-(env|terminfo) ]]; then\n+\n+  if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+    readonly _CACHE=\"${GHOSTTY_RESOURCES_DIR}/shell-integration/shared/ghostty-ssh-cache\"\n+  fi\n+\n+  # SSH wrapper\n+  ssh() {\n+    local env=() opts=() ctrl=()\n+\n+    # Set up env vars first so terminfo installation inherits them\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-env ]]; then\n+      local vars=(\n+        COLORTERM=truecolor \n+        TERM_PROGRAM=ghostty\n+        ${TERM_PROGRAM_VERSION:+TERM_PROGRAM_VERSION=$TERM_PROGRAM_VERSION}\n+      )\n+      for v in \"${vars[@]}\"; do\n+        builtin export \"${v?}\"\n+        opts+=(-o \"SendEnv ${v%=*}\" -o \"SetEnv $v\")\n+      done\n+    fi\n+\n+    # Install terminfo if needed, reuse control connection for main session\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+      # Get target (only when needed for terminfo)\n+      builtin local target\n+      target=$(builtin command ssh -G \"$@\" 2>/dev/null | awk '/^(user|hostname) /{print $2}' | paste -sd'@')\n+      \n+      if [[ -n \"$target\" ]] && \"$_CACHE\" chk \"$target\"; then\n+        env+=(TERM=xterm-ghostty)\n+      elif builtin command -v infocmp >/dev/null 2>&1; then\n+        builtin local tinfo\n+        tinfo=$(infocmp -x xterm-ghostty 2>/dev/null) || builtin echo \"Warning: xterm-ghostty terminfo not found locally.\" >&2\n+        if [[ -n \"$tinfo\" ]]; then\n+          builtin echo \"Setting up Ghostty terminfo on remote host...\" >&2\n+          builtin local cpath\n+          cpath=\"/tmp/ghostty-ssh-$USER-$RANDOM-$(date +%s)\"",
    "repo_full_name": "ghostty-org/ghostty",
    "discussion_comments": [
      {
        "comment_id": "2169317085",
        "repo_full_name": "ghostty-org/ghostty",
        "pr_number": 7608,
        "pr_file": "src/shell-integration/bash/ghostty.bash",
        "discussion_id": "2169317085",
        "commented_code": "@@ -95,6 +95,78 @@ if [[ \"$GHOSTTY_SHELL_FEATURES\" == *\"sudo\"* && -n \"$TERMINFO\" ]]; then\n   }\n fi\n \n+# SSH Integration\n+if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-(env|terminfo) ]]; then\n+\n+  if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+    readonly _CACHE=\"${GHOSTTY_RESOURCES_DIR}/shell-integration/shared/ghostty-ssh-cache\"\n+  fi\n+\n+  # SSH wrapper\n+  ssh() {\n+    local env=() opts=() ctrl=()\n+\n+    # Set up env vars first so terminfo installation inherits them\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-env ]]; then\n+      local vars=(\n+        COLORTERM=truecolor \n+        TERM_PROGRAM=ghostty\n+        ${TERM_PROGRAM_VERSION:+TERM_PROGRAM_VERSION=$TERM_PROGRAM_VERSION}\n+      )\n+      for v in \"${vars[@]}\"; do\n+        builtin export \"${v?}\"\n+        opts+=(-o \"SendEnv ${v%=*}\" -o \"SetEnv $v\")\n+      done\n+    fi\n+\n+    # Install terminfo if needed, reuse control connection for main session\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+      # Get target (only when needed for terminfo)\n+      builtin local target\n+      target=$(builtin command ssh -G \"$@\" 2>/dev/null | awk '/^(user|hostname) /{print $2}' | paste -sd'@')\n+      \n+      if [[ -n \"$target\" ]] && \"$_CACHE\" chk \"$target\"; then\n+        env+=(TERM=xterm-ghostty)\n+      elif builtin command -v infocmp >/dev/null 2>&1; then\n+        builtin local tinfo\n+        tinfo=$(infocmp -x xterm-ghostty 2>/dev/null) || builtin echo \"Warning: xterm-ghostty terminfo not found locally.\" >&2\n+        if [[ -n \"$tinfo\" ]]; then\n+          builtin echo \"Setting up Ghostty terminfo on remote host...\" >&2\n+          builtin local cpath\n+          cpath=\"/tmp/ghostty-ssh-$USER-$RANDOM-$(date +%s)\"",
        "comment_created_at": "2025-06-26T15:16:17+00:00",
        "comment_author": "jparise",
        "comment_body": "I don't recall the exact best practice for this (will need to do some research), but I feel like we should be using something like `mktemp`.",
        "pr_file_module": null
      },
      {
        "comment_id": "2184484596",
        "repo_full_name": "ghostty-org/ghostty",
        "pr_number": 7608,
        "pr_file": "src/shell-integration/bash/ghostty.bash",
        "discussion_id": "2169317085",
        "commented_code": "@@ -95,6 +95,78 @@ if [[ \"$GHOSTTY_SHELL_FEATURES\" == *\"sudo\"* && -n \"$TERMINFO\" ]]; then\n   }\n fi\n \n+# SSH Integration\n+if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-(env|terminfo) ]]; then\n+\n+  if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+    readonly _CACHE=\"${GHOSTTY_RESOURCES_DIR}/shell-integration/shared/ghostty-ssh-cache\"\n+  fi\n+\n+  # SSH wrapper\n+  ssh() {\n+    local env=() opts=() ctrl=()\n+\n+    # Set up env vars first so terminfo installation inherits them\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-env ]]; then\n+      local vars=(\n+        COLORTERM=truecolor \n+        TERM_PROGRAM=ghostty\n+        ${TERM_PROGRAM_VERSION:+TERM_PROGRAM_VERSION=$TERM_PROGRAM_VERSION}\n+      )\n+      for v in \"${vars[@]}\"; do\n+        builtin export \"${v?}\"\n+        opts+=(-o \"SendEnv ${v%=*}\" -o \"SetEnv $v\")\n+      done\n+    fi\n+\n+    # Install terminfo if needed, reuse control connection for main session\n+    if [[ \"$GHOSTTY_SHELL_FEATURES\" =~ ssh-terminfo ]]; then\n+      # Get target (only when needed for terminfo)\n+      builtin local target\n+      target=$(builtin command ssh -G \"$@\" 2>/dev/null | awk '/^(user|hostname) /{print $2}' | paste -sd'@')\n+      \n+      if [[ -n \"$target\" ]] && \"$_CACHE\" chk \"$target\"; then\n+        env+=(TERM=xterm-ghostty)\n+      elif builtin command -v infocmp >/dev/null 2>&1; then\n+        builtin local tinfo\n+        tinfo=$(infocmp -x xterm-ghostty 2>/dev/null) || builtin echo \"Warning: xterm-ghostty terminfo not found locally.\" >&2\n+        if [[ -n \"$tinfo\" ]]; then\n+          builtin echo \"Setting up Ghostty terminfo on remote host...\" >&2\n+          builtin local cpath\n+          cpath=\"/tmp/ghostty-ssh-$USER-$RANDOM-$(date +%s)\"",
        "comment_created_at": "2025-07-04T05:58:52+00:00",
        "comment_author": "jasonrayne",
        "comment_body": "Yeah, good call. Fixed in https://github.com/ghostty-org/ghostty/pull/7608/commits/75c703071a6ab176f2d7982a17cde1e593e14737",
        "pr_file_module": null
      }
    ]
  }
]