[
  {
    "discussion_id": "2250349682",
    "pr_number": 57232,
    "pr_file": "samples/mtls-serve/mtls-server.yaml",
    "created_at": "2025-08-04T04:05:34+00:00",
    "commented_code": "+# Copyright Istio Authors\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: mtls-serve\n+  labels:\n+    app: mtls-serve\n+spec:\n+  ports:\n+    - port: 443\n+      targetPort: 8443\n+      protocol: TCP\n+      name: https\n+  selector:\n+    app: mtls-serve\n+---\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: mtls-serve\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: mtls-serve\n+  template:\n+    metadata:\n+      labels:\n+        app: mtls-serve\n+    spec:\n+      containers:\n+        - name: mtls-serve\n+          image: localhost:5000/mtls-server:latest",
    "repo_full_name": "istio/istio",
    "discussion_comments": [
      {
        "comment_id": "2250349682",
        "repo_full_name": "istio/istio",
        "pr_number": 57232,
        "pr_file": "samples/mtls-serve/mtls-server.yaml",
        "discussion_id": "2250349682",
        "commented_code": "@@ -0,0 +1,79 @@\n+# Copyright Istio Authors\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: mtls-serve\n+  labels:\n+    app: mtls-serve\n+spec:\n+  ports:\n+    - port: 443\n+      targetPort: 8443\n+      protocol: TCP\n+      name: https\n+  selector:\n+    app: mtls-serve\n+---\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: mtls-serve\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: mtls-serve\n+  template:\n+    metadata:\n+      labels:\n+        app: mtls-serve\n+    spec:\n+      containers:\n+        - name: mtls-serve\n+          image: localhost:5000/mtls-server:latest",
        "comment_created_at": "2025-08-04T04:05:34+00:00",
        "comment_author": "craigbox",
        "comment_body": "I bet \"serve\" and \"server\" is going to trip someone up one day",
        "pr_file_module": null
      },
      {
        "comment_id": "2251579709",
        "repo_full_name": "istio/istio",
        "pr_number": 57232,
        "pr_file": "samples/mtls-serve/mtls-server.yaml",
        "discussion_id": "2250349682",
        "commented_code": "@@ -0,0 +1,79 @@\n+# Copyright Istio Authors\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: mtls-serve\n+  labels:\n+    app: mtls-serve\n+spec:\n+  ports:\n+    - port: 443\n+      targetPort: 8443\n+      protocol: TCP\n+      name: https\n+  selector:\n+    app: mtls-serve\n+---\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: mtls-serve\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: mtls-serve\n+  template:\n+    metadata:\n+      labels:\n+        app: mtls-serve\n+    spec:\n+      containers:\n+        - name: mtls-serve\n+          image: localhost:5000/mtls-server:latest",
        "comment_created_at": "2025-08-04T13:56:20+00:00",
        "comment_author": "ilrudie",
        "comment_body": "Good point. We really need to update the manifest to point to our published version if we're going to use this.",
        "pr_file_module": null
      },
      {
        "comment_id": "2252693783",
        "repo_full_name": "istio/istio",
        "pr_number": 57232,
        "pr_file": "samples/mtls-serve/mtls-server.yaml",
        "discussion_id": "2250349682",
        "commented_code": "@@ -0,0 +1,79 @@\n+# Copyright Istio Authors\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: mtls-serve\n+  labels:\n+    app: mtls-serve\n+spec:\n+  ports:\n+    - port: 443\n+      targetPort: 8443\n+      protocol: TCP\n+      name: https\n+  selector:\n+    app: mtls-serve\n+---\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: mtls-serve\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: mtls-serve\n+  template:\n+    metadata:\n+      labels:\n+        app: mtls-serve\n+    spec:\n+      containers:\n+        - name: mtls-serve\n+          image: localhost:5000/mtls-server:latest",
        "comment_created_at": "2025-08-04T22:22:24+00:00",
        "comment_author": "craigbox",
        "comment_body": "to be explicit I would recommend you rename \"mtls-serve\" (directory, command) to \"mtls-server\"",
        "pr_file_module": null
      },
      {
        "comment_id": "2254590832",
        "repo_full_name": "istio/istio",
        "pr_number": 57232,
        "pr_file": "samples/mtls-serve/mtls-server.yaml",
        "discussion_id": "2250349682",
        "commented_code": "@@ -0,0 +1,79 @@\n+# Copyright Istio Authors\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: mtls-serve\n+  labels:\n+    app: mtls-serve\n+spec:\n+  ports:\n+    - port: 443\n+      targetPort: 8443\n+      protocol: TCP\n+      name: https\n+  selector:\n+    app: mtls-serve\n+---\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: mtls-serve\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      app: mtls-serve\n+  template:\n+    metadata:\n+      labels:\n+        app: mtls-serve\n+    spec:\n+      containers:\n+        - name: mtls-serve\n+          image: localhost:5000/mtls-server:latest",
        "comment_created_at": "2025-08-05T14:48:17+00:00",
        "comment_author": "ilrudie",
        "comment_body": "gotcha, took another crack at it :)",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1705695879",
    "pr_number": 52463,
    "pr_file": "manifests/charts/gateway/templates/deployment.yaml",
    "created_at": "2024-08-06T14:59:39+00:00",
    "commented_code": "labels:\n         {{- include \"gateway.sidecarInjectionLabels\" . | nindent 8 }}\n         {{- include \"gateway.selectorLabels\" . | nindent 8 }}\n+        # FIXME",
    "repo_full_name": "istio/istio",
    "discussion_comments": [
      {
        "comment_id": "1705695879",
        "repo_full_name": "istio/istio",
        "pr_number": 52463,
        "pr_file": "manifests/charts/gateway/templates/deployment.yaml",
        "discussion_id": "1705695879",
        "commented_code": "@@ -25,6 +25,7 @@ spec:\n       labels:\n         {{- include \"gateway.sidecarInjectionLabels\" . | nindent 8 }}\n         {{- include \"gateway.selectorLabels\" . | nindent 8 }}\n+        # FIXME",
        "comment_created_at": "2024-08-06T14:59:39+00:00",
        "comment_author": "Stevenjin8",
        "comment_body": "wrt `app.kubernetes.io/name` I see a few options:\r\n1. In `istio.labels` we have a line `app.kubernetes.io/name: {{ template \"name\" }}` and in each chart we define the `name` template in `_helpers.yaml`. I think this is the approach helm suggests. This reduces a lot of boilerplate but feels indirect.\r\n2. Before every use of `{{ include \"istio.labels\" }}`, we have `app.kubernetes.io/name: chartname` (this is what I have done in this chart). This is the most direct, but feels repetitive\r\n3. In every chart, we define a template that looks like\r\n  ```yaml\r\n{{ define mychart.labels }}\r\napp.kubernetes.name: chartname\r\n{{ include \"istio.labels\" . }}\r\n{{ end }}\r\n```\r\n  This also feels a bit repetitive.",
        "pr_file_module": null
      },
      {
        "comment_id": "1705704599",
        "repo_full_name": "istio/istio",
        "pr_number": 52463,
        "pr_file": "manifests/charts/gateway/templates/deployment.yaml",
        "discussion_id": "1705695879",
        "commented_code": "@@ -25,6 +25,7 @@ spec:\n       labels:\n         {{- include \"gateway.sidecarInjectionLabels\" . | nindent 8 }}\n         {{- include \"gateway.selectorLabels\" . | nindent 8 }}\n+        # FIXME",
        "comment_created_at": "2024-08-06T15:05:03+00:00",
        "comment_author": "bleggett",
        "comment_body": "> wrt `app.kubernetes.io/name` I see a few options:\r\n> 1. In `istio.labels` we have a line `app.kubernetes.io/name: {{ template \"name\" }}` and in each chart we define the `name` template in `_helpers.yaml`. I think this is the approach helm suggests. This reduces a lot of boilerplate but feels indirect.\r\n> 2. Before every use of `{{ include \"istio.labels\" }}`, we have `app.kubernetes.io/name: chartname` (this is what I have done in this chart). This is the most direct, but feels repetitive\r\n> 3. In every chart, we define a template that looks like\r\n>   ```yaml\r\n> {{ define mychart.labels }}\r\n> app.kubernetes.name: chartname\r\n> {{ include \"istio.labels\" . }}\r\n> {{ end }}\r\n> ```\r\n>   This also feels a bit repetitive.\r\n\r\nI am fine with repeating some, especially if they actually DO vary by chart. It's the ones that never vary and can be stamped out that I want a consistent pattern for.\r\n\r\n 2 seems pretty simple, and we can always improve that later and move it into the template this PR adds later if we want - I am fine with it.\r\n\r\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1715915570",
    "pr_number": 52463,
    "pr_file": "manifests/charts/default/templates/mutatingwebhook.yaml",
    "created_at": "2024-08-13T20:54:22+00:00",
    "commented_code": "operator.istio.io/component: \"Pilot\"\n     app: sidecar-injector\n     release: {{ .Release.Name }}\n+    app.kubernetes.io/name: \"sidecar-injector\"",
    "repo_full_name": "istio/istio",
    "discussion_comments": [
      {
        "comment_id": "1715915570",
        "repo_full_name": "istio/istio",
        "pr_number": 52463,
        "pr_file": "manifests/charts/default/templates/mutatingwebhook.yaml",
        "discussion_id": "1715915570",
        "commented_code": "@@ -38,6 +38,8 @@ metadata:\n     operator.istio.io/component: \"Pilot\"\n     app: sidecar-injector\n     release: {{ .Release.Name }}\n+    app.kubernetes.io/name: \"sidecar-injector\"",
        "comment_created_at": "2024-08-13T20:54:22+00:00",
        "comment_author": "howardjohn",
        "comment_body": "This is not really a component anymore. Do we want to use the legacy name to align with the `app` in this object, or change it to `istiod` to align with other objects?",
        "pr_file_module": null
      },
      {
        "comment_id": "1716008685",
        "repo_full_name": "istio/istio",
        "pr_number": 52463,
        "pr_file": "manifests/charts/default/templates/mutatingwebhook.yaml",
        "discussion_id": "1715915570",
        "commented_code": "@@ -38,6 +38,8 @@ metadata:\n     operator.istio.io/component: \"Pilot\"\n     app: sidecar-injector\n     release: {{ .Release.Name }}\n+    app.kubernetes.io/name: \"sidecar-injector\"",
        "comment_created_at": "2024-08-13T22:22:01+00:00",
        "comment_author": "bleggett",
        "comment_body": "+1 on just using `istiod` for this.",
        "pr_file_module": null
      }
    ]
  }
]