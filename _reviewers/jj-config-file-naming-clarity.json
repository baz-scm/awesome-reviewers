[
  {
    "discussion_id": "1597744976",
    "pr_number": 3670,
    "pr_file": "cli/src/config.rs",
    "created_at": "2024-05-12T23:57:32+00:00",
    "commented_code": "/// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
    "repo_full_name": "jj-vcs/jj",
    "discussion_comments": [
      {
        "comment_id": "1597744976",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-05-12T23:57:32+00:00",
        "comment_author": "ilyagr",
        "comment_body": "I'm wondering whether `.jj/working_copy/config.toml` might be a better location for this. Otherwise, this emphasizes the working-copy config over the repo-level config, and I'm not sure that's desired (people might assume this is the ONLY config file, and that it's therefore repo-level).\r\n\r\n@yuja , @martinvonz , WDYT?",
        "pr_file_module": null
      },
      {
        "comment_id": "1597776498",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-05-13T01:24:47+00:00",
        "comment_author": "yuja",
        "comment_body": "> I'm wondering whether `.jj/working_copy/config.toml` might be a better location for this.\r\n\r\nMy feeling is that `.jj/working_copy` is the store directory dedicated for the `WorkingCopy` implementation, so better to not add arbitrary files in it.\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "1597788259",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-05-13T01:52:56+00:00",
        "comment_author": "ilyagr",
        "comment_body": "OK.\r\n\r\nI suppose, if need be, we could later move `.jj/working_copy` to `.jj/workspace/working_copy` and then `.jj/config.toml` to `.jj/workspace/config.toml`.",
        "pr_file_module": null
      },
      {
        "comment_id": "1667140820",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-07-05T20:54:09+00:00",
        "comment_author": "ilyagr",
        "comment_body": "I still find myself a little worried about people thinking that workspaces are broken if they end up using `.jj/config.toml` instead of `.jj/repo/config.toml`.\r\n\r\nWDYT of putting this file in `.jj/workspace/config.toml` now, and then moving `working_copy` to that dir later?\r\n\r\nThis is made better by `jj config edit` and `jj config path` existing, so I don't think it's absolutely critical, but it would be nice to not have to move the config file later (with all the doc changes and backwards compatibility work that involves)",
        "pr_file_module": null
      },
      {
        "comment_id": "1667222548",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-07-06T01:12:10+00:00",
        "comment_author": "yuja",
        "comment_body": "Maybe the file can be renamed to `.jj/workspace-config.toml`, then?\r\n\r\nBTW, do we have any practical use case of workspace-specific configuration? If we don't, and if the existence of `.jj/config.toml` is confusing, it might be better to not support workspace config at all. Not having workspace config might help simplify `IncludeIf`-like conditional. #616",
        "pr_file_module": null
      },
      {
        "comment_id": "1667231602",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-07-06T02:13:03+00:00",
        "comment_author": "ilyagr",
        "comment_body": "> Maybe the file can be renamed to .jj/workspace-config.toml, then?\r\n\r\nDo you prefer this to `.jj/workspace/config.toml`? Another thing to consider is that at some point we might want a per-workspace ignore file (that might be more important than a per-workspace config, though it might also be more difficult to sync with Git[^1]) that could be called `.jj/workspace/.gitignore` or `.jj/workspace/exclude`.\r\n\r\nIf we do prefer `.jj/workspace-config.toml`, I think it would solve the confusion problem. Though, should we then also have a `.jj/repo-config.toml`?\r\n\r\n> BTW, do we have any practical use case of workspace-specific configuration?\r\n\r\nIt's a fair question. I can imagine, for example, making a sparse workspace and turning off fs-monitor there, but I haven't immediately thought of a very compelling use-case. But that might be because I don't use workspaces very much at the moment.\r\n\r\n[^1]: **Update:** It seems Git might not support the idea of per-worktree ignores at all, at least I can find no trace of it in https://git-scm.com/docs/git-worktree or https://git-scm.com/docs/gitignore.\r\n\r\n    I guess if people want to exclude different files in different trees, they'd just have to add all of them to the repo-white excludes.",
        "pr_file_module": null
      },
      {
        "comment_id": "1667320367",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-07-06T07:12:05+00:00",
        "comment_author": "yuja",
        "comment_body": "> > Maybe the file can be renamed to .jj/workspace-config.toml, then?\r\n> \r\n> Do you prefer this to `.jj/workspace/config.toml`?\r\n\r\nYes. It mirrors the internal data model (workspace -> repo), and I like somewhat flattened structure for user-facing data. `.jj/repo/config.toml` isn't neat, but repo config has to be naturally accessible from multiple workspaces.\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "1741318489",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-03T00:57:56+00:00",
        "comment_author": "ilyagr",
        "comment_body": "I keep coming back to this occasionally, and I will say that while your argument makes some sense conceptually, I still feel that `.jj/workspace/config.toml` is the clearest option given that `.jj/repo/config.toml` exists. Putting a file in the top-level `.jj` dir will encourage people to pay attention to it, whereas they should generally pay more attention to `.jj/repo/config.toml`.\r\n\r\nThat said, I did suggest some other options above that you seemed happier with, and that would also work (or we could come up with something else, of course). It also depends a lot on the use-case. Currently, the use-case for the workspace config that I have in mind (and the reason I came back to this discussion) is to use it for setting up ignored/untracked files, as in https://github.com/martinvonz/jj/pull/4338#discussion_r1741304289 (which is one of several possible approaches).",
        "pr_file_module": null
      },
      {
        "comment_id": "1741424706",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-03T04:56:29+00:00",
        "comment_author": "martinvonz",
        "comment_body": "I agree with @yuja that `.jj/config.toml` most closely matches the model. I see `.jj/repo/` as containing repo state, `.jj/working_copy/`as containing working-copy state, and `.jj/` as being the whole workspace state (the combination of repo and working-copy state).\r\n\r\n> Putting a file in the top-level `.jj` dir will encourage people to pay attention to it, whereas they should generally pay more attention to `.jj/repo/config.toml`.\r\n\r\nThat's a good point. Perhaps we can help avoid that by writing a comment to the top of the file telling the user that it's specific to the workspace and that they might be looking for the repo-level config.",
        "pr_file_module": null
      },
      {
        "comment_id": "1742871205",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-04T01:30:59+00:00",
        "comment_author": "ilyagr",
        "comment_body": ">  Perhaps we can help avoid that by writing a comment to the top of the file\r\n\r\nI would prefer to do a bit more. If we don't want a `.jj/workspace/` dir, I'd rename the workspace config file to something like `.jj/workspace-config.toml`. Just a comment on its own feels a bit insufficient to me[^fluff], though if people prefer it, it wouldn't be the end of the world.\r\n\r\n[^fluff]: I'm imagining one person telling what to do to another slightly confused and rushed person over the phone. If they forget to stress this point, the other person might not read the comment because they are following instructions. I want to give them some reason to ask \"hey, it's not called config, it's called workspace-config, is that OK?\" or to make it likely they find both files.\r\n\r\nI'm starting to suspect we use the term \"workspace\" very slightly differently. As a user I don't think of \"workspace state\" (in the sense of what the `jj workspace` command manages) as including the repo state. You are right that in the implementation, it does.\r\n\r\nTo be clear, my intention was to keep the workspace `config.toml` next to `working_copy`, and move both over to `.jj/workspace`. But if I haven't convinced you about the `workspace` directory at this point, we should probably just go with the other option. ",
        "pr_file_module": null
      },
      {
        "comment_id": "1770578212",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-22T15:25:20+00:00",
        "comment_author": "martinvonz",
        "comment_body": "Calling the file `.jj/workspace-config.toml` works for me. Are you also okay with that, @yuja? Sorry that this got stalled, @HybridEidolon.",
        "pr_file_module": null
      },
      {
        "comment_id": "1770644419",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-22T22:02:04+00:00",
        "comment_author": "yuja",
        "comment_body": "> Calling the file `.jj/workspace-config.toml` works for me.\r\n\r\nYes, that seems okay.\r\n\r\nAnother option is to not add workspace config until we find a real use case.\r\n\r\n> BTW, do we have any practical use case of workspace-specific configuration? If we don't, and if the existence of `.jj/config.toml` is confusing, it might be better to not support workspace config at all. Not having workspace config might help simplify `IncludeIf`-like conditional. #616\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "1770646506",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-22T22:15:42+00:00",
        "comment_author": "martinvonz",
        "comment_body": "I was thinking that the config for not ignoring the executable bit in the working copy (#4478) could be stored in a workspace-level config instead of detecting support every time we try to snapshot the working copy.",
        "pr_file_module": null
      },
      {
        "comment_id": "1770656263",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-22T23:18:45+00:00",
        "comment_author": "yuja",
        "comment_body": "> I was thinking that the config for not ignoring the executable bit in the working copy (#4478) could be stored in a workspace-level config\r\n\r\nYes, but I assumed it's practically okay to set it to repo/config.toml. (Maybe I should say \"immediate need\", not \"real use case\".)",
        "pr_file_module": null
      },
      {
        "comment_id": "1770668615",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-23T00:25:59+00:00",
        "comment_author": "ilyagr",
        "comment_body": "If we go in the direction of supporting \"IncludeIf\" and conditional config, it might make sense to put workspace config inside repo config under a key like `[if.workspace.default]` (assuming `if.something` is how other conditional config can be setup; I'd want these to have similar syntax if possible, thought it's not absolutely necessary).\r\n\r\nFor something like executable bits, we could eventually have a fancier conditionals like \"Config for all workspaces under `/mnt/c`\" (or whatever the WSL mount for the NTFS C: drive is).\r\n\r\nAt the same time, I'm not sure whether the conditional config idea is more practical for now (or in general). It might be easier to have `workspace-config.toml` for now (or even permanently).",
        "pr_file_module": null
      },
      {
        "comment_id": "1770729904",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-23T02:54:31+00:00",
        "comment_author": "HybridEidolon",
        "comment_body": "For context, the reason I went ahead and implemented the workspace config is because I had a complex repository scenario where multiple related-but-divergent trunks shared a lot of history, and wanted to use multiple workspaces to manage the different related codebases with different jj templates and revsets for each.",
        "pr_file_module": null
      },
      {
        "comment_id": "1770775064",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-23T05:05:30+00:00",
        "comment_author": "yuja",
        "comment_body": "Ok, if there's a real need, we shouldn't be too nitpicky. Let's land `.jj/config.toml` or `.jj/workspace-config.toml`. I think @ilyagr is okay with `.jj/workspace-config.toml`.",
        "pr_file_module": null
      },
      {
        "comment_id": "1770792770",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 3670,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "1597744976",
        "commented_code": "@@ -59,7 +60,7 @@ pub struct AnnotatedValue {\n /// 2. Base environment variables\n /// 3. [User config](https://github.com/martinvonz/jj/blob/main/docs/config.md#configuration)\n /// 4. Repo config `.jj/repo/config.toml`\n-/// 5. TODO: Workspace config `.jj/config.toml`\n+/// 5. Workspace config `.jj/config.toml`",
        "comment_created_at": "2024-09-23T05:39:05+00:00",
        "comment_author": "ilyagr",
        "comment_body": "I'm OK with `.jj/workspace-config.toml`. I appreciate Eidolon explaining one more use-case; I don't have a clear opinion on what the conclusion from that or from Martin's use-case should be.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2132049317",
    "pr_number": 6636,
    "pr_file": "cli/src/config.rs",
    "created_at": "2025-06-06T11:48:35+00:00",
    "commented_code": "Ok(())\n     }\n \n+    /// Sets the directory where workspace-specific config file is stored. The\n+    /// path is usually `.jj/config.toml`.\n+    pub fn reset_workspace_path(&mut self, path: &Path) {\n+        self.workspace_path = Some(path.to_owned());\n+        self.workspace_config_path = Some(ConfigPath::new(path.join(\"config.toml\")));",
    "repo_full_name": "jj-vcs/jj",
    "discussion_comments": [
      {
        "comment_id": "2132049317",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 6636,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "2132049317",
        "commented_code": "@@ -486,6 +491,87 @@ impl ConfigEnv {\n         Ok(())\n     }\n \n+    /// Sets the directory where workspace-specific config file is stored. The\n+    /// path is usually `.jj/config.toml`.\n+    pub fn reset_workspace_path(&mut self, path: &Path) {\n+        self.workspace_path = Some(path.to_owned());\n+        self.workspace_config_path = Some(ConfigPath::new(path.join(\"config.toml\")));",
        "comment_created_at": "2025-06-06T11:48:35+00:00",
        "comment_author": "yuja",
        "comment_body": "@ilyagr do you still have concern about the `<workspace_root>/.jj/config.toml` path?",
        "pr_file_module": null
      },
      {
        "comment_id": "2134389799",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 6636,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "2132049317",
        "commented_code": "@@ -486,6 +491,87 @@ impl ConfigEnv {\n         Ok(())\n     }\n \n+    /// Sets the directory where workspace-specific config file is stored. The\n+    /// path is usually `.jj/config.toml`.\n+    pub fn reset_workspace_path(&mut self, path: &Path) {\n+        self.workspace_path = Some(path.to_owned());\n+        self.workspace_config_path = Some(ConfigPath::new(path.join(\"config.toml\")));",
        "comment_created_at": "2025-06-08T04:08:57+00:00",
        "comment_author": "ilyagr",
        "comment_body": "Yes, I still think that people will confuse `.jj/config.toml` with `.jj/repo/config.toml`.\r\n\r\nMy preference would be `.jj/workspace/config.toml`. We could (optionally) eventually move `working_copy` to `.jj/workspace/working_copy`.\r\n\r\nIf you and/or others don't agree (I remember we had some disagreement; I don't remember whether it was limited to my older proposal of `.jj/working_copy/config.toml`), I don't think I want to block the PR on this though.",
        "pr_file_module": null
      },
      {
        "comment_id": "2134390849",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 6636,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "2132049317",
        "commented_code": "@@ -486,6 +491,87 @@ impl ConfigEnv {\n         Ok(())\n     }\n \n+    /// Sets the directory where workspace-specific config file is stored. The\n+    /// path is usually `.jj/config.toml`.\n+    pub fn reset_workspace_path(&mut self, path: &Path) {\n+        self.workspace_path = Some(path.to_owned());\n+        self.workspace_config_path = Some(ConfigPath::new(path.join(\"config.toml\")));",
        "comment_created_at": "2025-06-08T04:11:26+00:00",
        "comment_author": "ilyagr",
        "comment_body": "Another thought is that we might, at some point, want a workspace-specific ignore file next to the workspace-specific config file.\r\n\r\nLooking over the old discussion in https://github.com/jj-vcs/jj/pull/3670, there was the option of `.jj/workspace-config.toml`, that I still like better than `.jj/config.toml` but less than `.jj/workspace/config.toml`.\r\n\r\nIt looks like other people did not like `.jj/workspace/config.toml`, though.\r\n\r\n\r\n-------\r\n\r\nIf we go with `.jj/config.toml`, we'll have the option of pre-populating it with the schema and a comment along the lines of (but with more details and a different tone, of course):\r\n\r\n> This is the *workspace* config file, you probably want `.jj/repo/config.toml` instead.\r\n\r\nWe'd then do something similar with the ignore file, I guess, if that ever appears.",
        "pr_file_module": null
      },
      {
        "comment_id": "2138048778",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 6636,
        "pr_file": "cli/src/config.rs",
        "discussion_id": "2132049317",
        "commented_code": "@@ -486,6 +491,87 @@ impl ConfigEnv {\n         Ok(())\n     }\n \n+    /// Sets the directory where workspace-specific config file is stored. The\n+    /// path is usually `.jj/config.toml`.\n+    pub fn reset_workspace_path(&mut self, path: &Path) {\n+        self.workspace_path = Some(path.to_owned());\n+        self.workspace_config_path = Some(ConfigPath::new(path.join(\"config.toml\")));",
        "comment_created_at": "2025-06-10T14:24:31+00:00",
        "comment_author": "yuja",
        "comment_body": "To be clear,\r\n\r\n* I (and Martin, I think) consider that `.jj/workspace/config.toml` goes against the current data model.\r\n* I and Martin think `.jj/config.toml` is good for consistency, but Ilya don't like it because it looks like \"the\" repository config file. That's understandable.\r\n* We're okay with `.jj/workspace-config.toml`.\r\n\r\nSo `.jj/workspace-config.toml` is the least bad choice?",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2419898322",
    "pr_number": 7643,
    "pr_file": "cli/src/cli_util.rs",
    "created_at": "2025-10-10T12:34:25+00:00",
    "commented_code": ".map_err(|err| map_workspace_load_error(err, Some(path)))?;\n             config_env.reset_repo_path(loader.repo_path());\n             config_env.reload_repo_config(&mut raw_config)?;\n+            // update workspace path too\n+            let ws_conf_dir = loader.workspace_root().join(\".jj\");\n+            config_env.reset_workspace_path(&ws_conf_dir);\n+            config_env.reload_workspace_config(&mut raw_config)?;",
    "repo_full_name": "jj-vcs/jj",
    "discussion_comments": [
      {
        "comment_id": "2419898322",
        "repo_full_name": "jj-vcs/jj",
        "pr_number": 7643,
        "pr_file": "cli/src/cli_util.rs",
        "discussion_id": "2419898322",
        "commented_code": "@@ -3866,6 +3873,10 @@ impl<'a> CliRunner<'a> {\n                 .map_err(|err| map_workspace_load_error(err, Some(path)))?;\n             config_env.reset_repo_path(loader.repo_path());\n             config_env.reload_repo_config(&mut raw_config)?;\n+            // update workspace path too\n+            let ws_conf_dir = loader.workspace_root().join(\".jj\");\n+            config_env.reset_workspace_path(&ws_conf_dir);\n+            config_env.reload_workspace_config(&mut raw_config)?;",
        "comment_created_at": "2025-10-10T12:34:25+00:00",
        "comment_author": "yuja",
        "comment_body": "We'll need to do this in `CommandHelper::settings_for_new_workspace()`, too. Check callers of `resolve_config()`.",
        "pr_file_module": null
      }
    ]
  }
]