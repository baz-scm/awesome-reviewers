[
  {
    "discussion_id": "2143687684",
    "pr_number": 823,
    "pr_file": ".buildkite/install-env.sh",
    "created_at": "2025-06-12T21:24:24+00:00",
    "commented_code": "uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
    "repo_full_name": "LMCache/LMCache",
    "discussion_comments": [
      {
        "comment_id": "2143687684",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-12T21:24:24+00:00",
        "comment_author": "Shaoting-Feng",
        "comment_body": "In `.buildkite/pipeline.yml` line 24, the restored venv of step 2 might hit the venv of step 1 from previous run, because `requirements/common.txt` and `requirements/test.txt` in the key didn't change. Then the venv does not include `pytest-cov` and `pytest-html`.",
        "pr_file_module": null
      },
      {
        "comment_id": "2144802529",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-13T11:06:06+00:00",
        "comment_author": "hickeyma",
        "comment_body": "Ok. I investigated this but can't find how to regenerate the virtual environment so that it will run the install of the updated test requirement file.\r\n\r\n@Shaoting-Feng How do I trigger this?",
        "pr_file_module": null
      },
      {
        "comment_id": "2145461166",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-13T16:18:51+00:00",
        "comment_author": "Shaoting-Feng",
        "comment_body": "I suggest try to include the unique build ID (BUILDKITE_BUILD_ID) in the cache key so that each build has its own key. Then only the .venv saved in the current build is restored.",
        "pr_file_module": null
      },
      {
        "comment_id": "2146971703",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-14T14:42:49+00:00",
        "comment_author": "hickeyma",
        "comment_body": "Can you provide more details to explain this?",
        "pr_file_module": null
      },
      {
        "comment_id": "2150460664",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-16T16:59:02+00:00",
        "comment_author": "Shaoting-Feng",
        "comment_body": "Like this:\r\n```yaml\r\nplugins:\r\n      - cache#v1.5.2:\r\n          key: \"venv-{{ BUILDKITE_BUILD_ID }}-{{ checksum \\\"requirements/common.txt\\\" }}-{{ checksum \\\"requirements/test.txt\\\" }}\"\r\n          path: \".venv\"\r\n          save: \"pipeline\"\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "2162035623",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-23T16:39:18+00:00",
        "comment_author": "hickeyma",
        "comment_body": "Thanks @Shaoting-Feng. I tried your suggestion above with the build id but doesn't seem to be working. Any ideas?",
        "pr_file_module": null
      },
      {
        "comment_id": "2162157889",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-23T17:54:30+00:00",
        "comment_author": "Shaoting-Feng",
        "comment_body": "The plugin only allows a single cache save per pipeline, regardless of the cache key. I\u2019ve added force: true (https://github.com/buildkite-plugins/cache-buildkite-plugin?tab=readme-ov-file#force-boolean-save-only) to force it to overwrite and save on each run.",
        "pr_file_module": null
      },
      {
        "comment_id": "2163756802",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 823,
        "pr_file": ".buildkite/install-env.sh",
        "discussion_id": "2143687684",
        "commented_code": "@@ -18,7 +18,10 @@ CUDA_VERSION=\"12.1\"\n uv pip install --upgrade pip setuptools wheel\n uv pip install -r requirements/common.txt\n uv pip install -r requirements/test.txt\n-uv pip install coverage\n+\n+# Added these install as latestrequirements/test.txt is not being installed\n+uv pip install pytest-cov",
        "comment_created_at": "2025-06-24T11:56:04+00:00",
        "comment_author": "hickeyma",
        "comment_body": "Thank you @Shaoting-Feng for fixing the caching issue and enabling the test pipeline to pickup the latest test requirements file for pytest coverage dependencies. Pipeline passing now.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1704833025",
    "pr_number": 40,
    "pr_file": ".buildkite/install-lmcache.sh",
    "created_at": "2024-08-06T02:39:29+00:00",
    "commented_code": "+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH",
    "repo_full_name": "LMCache/LMCache",
    "discussion_comments": [
      {
        "comment_id": "1704833025",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 40,
        "pr_file": ".buildkite/install-lmcache.sh",
        "discussion_id": "1704833025",
        "commented_code": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH",
        "comment_created_at": "2024-08-06T02:39:29+00:00",
        "comment_author": "KuntaiDu",
        "comment_body": "My gut feeling is that there are too many bash scripts. We are definitely going to add more scripts in the future, so it would be ideal if we can reduce the # of bash scripts.",
        "pr_file_module": null
      },
      {
        "comment_id": "1705843124",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 40,
        "pr_file": ".buildkite/install-lmcache.sh",
        "discussion_id": "1704833025",
        "commented_code": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH",
        "comment_created_at": "2024-08-06T16:46:42+00:00",
        "comment_author": "ApostaC",
        "comment_body": "Merged install-env.sh and install-packages.sh",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1704833469",
    "pr_number": 40,
    "pr_file": ".buildkite/install-lmcache.sh",
    "created_at": "2024-08-06T02:40:13+00:00",
    "commented_code": "+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH\n+export PATH=$CUDA_HOME/bin:$PATH\n+\n+eval \"$(conda shell.bash hook)\"\n+conda activate ${CONDA_ENV_NAME}\n+\n+set -xe \n+\n+pip install -e third_party/torchac_cuda\n+pip install -e .",
    "repo_full_name": "LMCache/LMCache",
    "discussion_comments": [
      {
        "comment_id": "1704833469",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 40,
        "pr_file": ".buildkite/install-lmcache.sh",
        "discussion_id": "1704833469",
        "commented_code": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH\n+export PATH=$CUDA_HOME/bin:$PATH\n+\n+eval \"$(conda shell.bash hook)\"\n+conda activate ${CONDA_ENV_NAME}\n+\n+set -xe \n+\n+pip install -e third_party/torchac_cuda\n+pip install -e .",
        "comment_created_at": "2024-08-06T02:40:13+00:00",
        "comment_author": "KuntaiDu",
        "comment_body": "Consider using ccache to cache some compile work --- compile is slow.",
        "pr_file_module": null
      },
      {
        "comment_id": "1705848196",
        "repo_full_name": "LMCache/LMCache",
        "pr_number": 40,
        "pr_file": ".buildkite/install-lmcache.sh",
        "discussion_id": "1704833469",
        "commented_code": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+\n+CONDA_ENV_NAME=\"buildkite\"\n+PYTHON_VERSION=3.10\n+\n+cuda_version=12.1\n+export CUDA_HOME=/usr/local/cuda-${cuda_version}\n+export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH\n+export PATH=$CUDA_HOME/bin:$PATH\n+\n+eval \"$(conda shell.bash hook)\"\n+conda activate ${CONDA_ENV_NAME}\n+\n+set -xe \n+\n+pip install -e third_party/torchac_cuda\n+pip install -e .",
        "comment_created_at": "2024-08-06T16:51:00+00:00",
        "comment_author": "ApostaC",
        "comment_body": "Added a new ticket #43 for this. Also, will do this in v0.1.x",
        "pr_file_module": null
      }
    ]
  }
]