[
  {
    "discussion_id": "2191478594",
    "pr_number": 8352,
    "pr_file": "src/hooks/useMainInterfaceAnalytics.ts",
    "created_at": "2025-07-08T04:59:20+00:00",
    "commented_code": "+import { useChatStore } from '@/store/chat';\n+import { chatSelectors } from '@/store/chat/selectors';\n+import { useGlobalStore } from '@/store/global';\n+import { systemStatusSelectors } from '@/store/global/selectors';\n+import { useSessionStore } from '@/store/session';\n+import { sessionSelectors } from '@/store/session/selectors';\n+\n+export interface MainInterfaceAnalyticsData {\n+  active_assistant: string | null;\n+  has_chat_history: boolean;\n+  session_id: string;\n+  sidebar_state: 'expanded' | 'collapsed';\n+  visible_assistants_count: number;\n+}\n+\n+export const useMainInterfaceAnalytics = (): MainInterfaceAnalyticsData => {",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2191478594",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8352,
        "pr_file": "src/hooks/useMainInterfaceAnalytics.ts",
        "discussion_id": "2191478594",
        "commented_code": "@@ -0,0 +1,30 @@\n+import { useChatStore } from '@/store/chat';\n+import { chatSelectors } from '@/store/chat/selectors';\n+import { useGlobalStore } from '@/store/global';\n+import { systemStatusSelectors } from '@/store/global/selectors';\n+import { useSessionStore } from '@/store/session';\n+import { sessionSelectors } from '@/store/session/selectors';\n+\n+export interface MainInterfaceAnalyticsData {\n+  active_assistant: string | null;\n+  has_chat_history: boolean;\n+  session_id: string;\n+  sidebar_state: 'expanded' | 'collapsed';\n+  visible_assistants_count: number;\n+}\n+\n+export const useMainInterfaceAnalytics = (): MainInterfaceAnalyticsData => {",
        "comment_created_at": "2025-07-08T04:59:20+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u6211\u5728\u60f3\u8fd9\u91cc\u65e2\u7136\u90fd\u662f\u53d6\u7684\u77ac\u65f6\u503c\uff0c\u6ca1\u6709\u5fc5\u8981\u505a\u6210 useXXXX \u7684\u5f62\u5f0f\u5427\uff0c\u76f4\u63a5\n\n`sessionSelectors.currentSession(getSessionStoreState())`\n\n\u5c31\u662f\u6700\u65b0\u72b6\u6001\uff0c\u800c\u4e14\u66f4\u52a0\u7075\u6d3b\u5e76\u4e14\u4e0d\u4f1a\u9020\u6210 rerender\u3002\n\n\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u5199\u6210 `getMainInterfaceAnalytics` \u7136\u540e\u653e\u5230 Analytics \u7ec4\u4ef6\u91cc\uff1f",
        "pr_file_module": null
      },
      {
        "comment_id": "2191969175",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8352,
        "pr_file": "src/hooks/useMainInterfaceAnalytics.ts",
        "discussion_id": "2191478594",
        "commented_code": "@@ -0,0 +1,30 @@\n+import { useChatStore } from '@/store/chat';\n+import { chatSelectors } from '@/store/chat/selectors';\n+import { useGlobalStore } from '@/store/global';\n+import { systemStatusSelectors } from '@/store/global/selectors';\n+import { useSessionStore } from '@/store/session';\n+import { sessionSelectors } from '@/store/session/selectors';\n+\n+export interface MainInterfaceAnalyticsData {\n+  active_assistant: string | null;\n+  has_chat_history: boolean;\n+  session_id: string;\n+  sidebar_state: 'expanded' | 'collapsed';\n+  visible_assistants_count: number;\n+}\n+\n+export const useMainInterfaceAnalytics = (): MainInterfaceAnalyticsData => {",
        "comment_created_at": "2025-07-08T09:26:15+00:00",
        "comment_author": "sudongyuer",
        "comment_body": "\u6211\u53ef\u4ee5\u6539\u6210sessionSelectors.currentSession(getSessionStoreState())\u8fd9\u79cd\u5f62\u5f0f\uff0c\u7528use\u662f\u6015\u9875\u9762\u521a\u52a0\u8f7d\u7684\u65f6\u5019\u62ff\u4e0d\u5230\u6240\u6709\u7684\u503c\uff0c\u6240\u4ee5\u7528\u7684hook\u53bb\u53d6\u503c\u3002\u6211\u8bd5\u8bd5\u62ff\u77ac\u65f6\u503c\uff0c\u80fd\u4e0d\u80fd\u4e00\u6b21\u6027\u62ff\u5230",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1546409219",
    "pr_number": 1834,
    "pr_file": "src/store/chat/slices/topic/action.ts",
    "created_at": "2024-04-01T14:50:27+00:00",
    "commented_code": "},\n       },\n     ),\n-  useSearchTopics: (keywords) =>\n+  useSearchTopics: (keywords, sessionId) =>\n     useSWR<ChatTopic[]>(\n-      [SWR_USE_SEARCH_TOPIC, keywords],\n-      ([, keywords]: [string, string]) => topicService.searchTopics(keywords),\n+      [SWR_USE_SEARCH_TOPIC, keywords, sessionId],\n+      ([, keywords, sessionId]: [string, string, string]) =>\n+        topicService.searchTopics(keywords, sessionId),\n       {\n         onSuccess: (data) => {\n           set({ searchTopics: data }, false, n('useSearchTopics(success)', { keywords }));",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "1546409219",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 1834,
        "pr_file": "src/store/chat/slices/topic/action.ts",
        "discussion_id": "1546409219",
        "commented_code": "@@ -154,10 +154,11 @@ export const chatTopic: StateCreator<\n         },\n       },\n     ),\n-  useSearchTopics: (keywords) =>\n+  useSearchTopics: (keywords, sessionId) =>\n     useSWR<ChatTopic[]>(\n-      [SWR_USE_SEARCH_TOPIC, keywords],\n-      ([, keywords]: [string, string]) => topicService.searchTopics(keywords),\n+      [SWR_USE_SEARCH_TOPIC, keywords, sessionId],\n+      ([, keywords, sessionId]: [string, string, string]) =>\n+        topicService.searchTopics(keywords, sessionId),\n       {\n         onSuccess: (data) => {\n           set({ searchTopics: data }, false, n('useSearchTopics(success)', { keywords }));",
        "comment_created_at": "2024-04-01T14:50:27+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u611f\u89c9\u641c\u7d22\u6001\u662f\u4e0d\u662f\u5e94\u8be5\u5728\u8fd9\uff0c `{searchTopics: data,  isSearchingTopic : !!keywords }`",
        "pr_file_module": null
      },
      {
        "comment_id": "1547739786",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 1834,
        "pr_file": "src/store/chat/slices/topic/action.ts",
        "discussion_id": "1546409219",
        "commented_code": "@@ -154,10 +154,11 @@ export const chatTopic: StateCreator<\n         },\n       },\n     ),\n-  useSearchTopics: (keywords) =>\n+  useSearchTopics: (keywords, sessionId) =>\n     useSWR<ChatTopic[]>(\n-      [SWR_USE_SEARCH_TOPIC, keywords],\n-      ([, keywords]: [string, string]) => topicService.searchTopics(keywords),\n+      [SWR_USE_SEARCH_TOPIC, keywords, sessionId],\n+      ([, keywords, sessionId]: [string, string, string]) =>\n+        topicService.searchTopics(keywords, sessionId),\n       {\n         onSuccess: (data) => {\n           set({ searchTopics: data }, false, n('useSearchTopics(success)', { keywords }));",
        "comment_created_at": "2024-04-02T12:05:42+00:00",
        "comment_author": "mosade",
        "comment_body": "\u6d4b\u8bd5\u7528\u4f8b\u5df2\u7ecf\u8865\u5145\u3002\r\n\u7136\u540e\u5173\u4e8e\u641c\u7d22\u72b6\u6001\uff0c\u6211\u8bd5\u4e86\u52a0\u5728\u8fd9\u4e0d\u4f1a\u89e6\u53d1\uff0c\u56e0\u4e3a\u5207\u6362\u4f1a\u8bdd\u4e4b\u540e\uff0c\u53f3\u4fa7\u7ec4\u4ef6\u4f1a\u5378\u8f7d\u4e4b\u540e\u91cd\u65b0\u6302\u8f7d\u800c\u4e0d\u662f\u91cd\u65b0\u6e32\u67d3\u3002\r\n\u6216\u8bb8\u4e5f\u53ef\u4ee5\u5728```TopicSearchBar```\u5378\u8f7d\u7684\u65f6\u5019\u5c06isSearchingTopic\u7f6e\u4e3afalse?",
        "pr_file_module": null
      }
    ]
  }
]