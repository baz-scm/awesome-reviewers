[
  {
    "discussion_id": "2310794108",
    "pr_number": 8453,
    "pr_file": "src/server/services/usage/index.ts",
    "created_at": "2025-08-29T18:09:12+00:00",
    "commented_code": "+import { LOBE_DEFAULT_MODEL_LIST } from '@/config/aiModels';\n+import { AiModelModel } from '@/database/models/aiModel';\n+import { UsageRecordModel } from '@/database/models/usage';\n+import { NewUsageRecord } from '@/database/schemas';\n+import { LobeChatDatabase } from '@/database/type';\n+import { getDetailsToken } from '@/features/Conversation/Extras/Usage/UsageDetail/tokens';",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2310794108",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "src/server/services/usage/index.ts",
        "discussion_id": "2310794108",
        "commented_code": "@@ -0,0 +1,68 @@\n+import { LOBE_DEFAULT_MODEL_LIST } from '@/config/aiModels';\n+import { AiModelModel } from '@/database/models/aiModel';\n+import { UsageRecordModel } from '@/database/models/usage';\n+import { NewUsageRecord } from '@/database/schemas';\n+import { LobeChatDatabase } from '@/database/type';\n+import { getDetailsToken } from '@/features/Conversation/Extras/Usage/UsageDetail/tokens';",
        "comment_created_at": "2025-08-29T18:09:12+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u4e2a\u5b9e\u73b0\u4e0d\u5bf9\uff0c server \u65b9\u6cd5\u600e\u4e48\u80fd\u5f15\u5165 client \u7684 `getDetailsToken` \u65b9\u6cd5\u5462\uff1f\u5982\u679c\u662f\u8ba1\u7b97 token \u7684\u8bdd\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u62bd\u5230 utils \u53bb",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2297393993",
    "pr_number": 8916,
    "pr_file": "packages/database/src/schemas/chatGroup.ts",
    "created_at": "2025-08-25T07:58:04+00:00",
    "commented_code": "+/* eslint-disable sort-keys-fix/sort-keys-fix  */\n+import {\n+  boolean,\n+  integer,\n+  jsonb,\n+  pgTable,\n+  primaryKey,\n+  text,\n+  uniqueIndex,\n+  varchar,\n+} from 'drizzle-orm/pg-core';\n+import { createInsertSchema } from 'drizzle-zod';\n+\n+import { idGenerator, randomSlug } from '@/database/utils/idGenerator';\n+\n+import { timestamps } from './_helpers';\n+import { agents } from './agent';\n+import { users } from './user';\n+\n+/**\n+ * Chat groups table for multi-agent conversations\n+ * Allows multiple agents to participate in a single chat session\n+ */\n+export const chatGroups = pgTable(\n+  'chat_groups',\n+  {\n+    id: text('id')\n+      .primaryKey()\n+      .$defaultFn(() => idGenerator('chatGroups'))\n+      .notNull(),\n+    slug: varchar('slug', { length: 100 })\n+      .$defaultFn(() => randomSlug(4))\n+      .unique(),\n+    title: text('title'),\n+    description: text('description'),\n+\n+    /**\n+     * Group configuration\n+     */\n+    config: jsonb('config').$type<{",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2297393993",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8916,
        "pr_file": "packages/database/src/schemas/chatGroup.ts",
        "discussion_id": "2297393993",
        "commented_code": "@@ -0,0 +1,108 @@\n+/* eslint-disable sort-keys-fix/sort-keys-fix  */\n+import {\n+  boolean,\n+  integer,\n+  jsonb,\n+  pgTable,\n+  primaryKey,\n+  text,\n+  uniqueIndex,\n+  varchar,\n+} from 'drizzle-orm/pg-core';\n+import { createInsertSchema } from 'drizzle-zod';\n+\n+import { idGenerator, randomSlug } from '@/database/utils/idGenerator';\n+\n+import { timestamps } from './_helpers';\n+import { agents } from './agent';\n+import { users } from './user';\n+\n+/**\n+ * Chat groups table for multi-agent conversations\n+ * Allows multiple agents to participate in a single chat session\n+ */\n+export const chatGroups = pgTable(\n+  'chat_groups',\n+  {\n+    id: text('id')\n+      .primaryKey()\n+      .$defaultFn(() => idGenerator('chatGroups'))\n+      .notNull(),\n+    slug: varchar('slug', { length: 100 })\n+      .$defaultFn(() => randomSlug(4))\n+      .unique(),\n+    title: text('title'),\n+    description: text('description'),\n+\n+    /**\n+     * Group configuration\n+     */\n+    config: jsonb('config').$type<{",
        "comment_created_at": "2025-08-25T07:58:04+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u91cc\u7684 config type \u5e94\u8be5\u5355\u72ec\u63d0\u51fa\u53bb",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2197207594",
    "pr_number": 8335,
    "pr_file": "src/server/services/file/index.ts",
    "created_at": "2025-07-10T10:04:12+00:00",
    "commented_code": "// if file not found, delete it from db\n       if ((e as any).Code === 'NoSuchKey') {\n         await this.fileModel.delete(fileId, serverDBEnv.REMOVE_GLOBAL_FILE);\n-        throw new TRPCError({ code: 'BAD_REQUEST', message: 'File not found' });\n+        throw new TRPCError({ code: 'BAD_REQUEST', message: 'Origin File Not Found' });",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2197207594",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8335,
        "pr_file": "src/server/services/file/index.ts",
        "discussion_id": "2197207594",
        "commented_code": "@@ -96,7 +96,7 @@ export class FileService {\n       // if file not found, delete it from db\n       if ((e as any).Code === 'NoSuchKey') {\n         await this.fileModel.delete(fileId, serverDBEnv.REMOVE_GLOBAL_FILE);\n-        throw new TRPCError({ code: 'BAD_REQUEST', message: 'File not found' });\n+        throw new TRPCError({ code: 'BAD_REQUEST', message: 'Origin File Not Found' });",
        "comment_created_at": "2025-07-10T10:04:12+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u5982\u679c\u62ff 'Origin File Not Found' \u8fd9\u4e2a\u505a\u5224\u65ad\uff0c\u6211\u611f\u89c9\u5f97\u628a\u8fd9\u4e2a\u62bd\u6210\u4e00\u4e2a\u53d8\u91cf\u51fa\u6765\uff0c\u800c\u4e0d\u662f\u4e24\u8fb9\u90fd\u5b57\u7b26\u4e32\u5904\u7406\u3002\u5426\u5219\u4e07\u4e00\u540e\u9762\u8c01\u6539\u4e86\u8fd9\u91cc\uff0c\u90a3\u8fb9\u7684\u5224\u65ad\u5c31\u6ca1\u7528\u4e86",
        "pr_file_module": null
      },
      {
        "comment_id": "2215095391",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8335,
        "pr_file": "src/server/services/file/index.ts",
        "discussion_id": "2197207594",
        "commented_code": "@@ -96,7 +96,7 @@ export class FileService {\n       // if file not found, delete it from db\n       if ((e as any).Code === 'NoSuchKey') {\n         await this.fileModel.delete(fileId, serverDBEnv.REMOVE_GLOBAL_FILE);\n-        throw new TRPCError({ code: 'BAD_REQUEST', message: 'File not found' });\n+        throw new TRPCError({ code: 'BAD_REQUEST', message: 'Origin File Not Found' });",
        "comment_created_at": "2025-07-18T06:29:54+00:00",
        "comment_author": "ONLY-yours",
        "comment_body": "\u6211\u7edf\u4e00\u62bd\u4e86\u4e0b files \u91cc\u9762\u7684 trpc message ",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2002466038",
    "pr_number": 7036,
    "pr_file": "packages/web-crawler/src/crawImpl/search1api.ts",
    "created_at": "2025-03-19T05:46:32+00:00",
    "commented_code": "+import { CrawlImpl, CrawlSuccessResult } from '../type';\n+import { NetworkConnectionError, PageNotFoundError, TimeoutError } from '../utils/errorType';\n+\n+interface Search1ApiResponse {\n+  crawlParameters: {\n+    url: string;\n+  };\n+  results: {\n+    title?: string;\n+    link?: string;\n+    content?: string;\n+  };\n+}\n+\n+const TIMEOUT_CONTROL = 10_000;\n+\n+const withTimeout = <T>(promise: Promise<T>, ms: number): Promise<T> => {",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2002466038",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 7036,
        "pr_file": "packages/web-crawler/src/crawImpl/search1api.ts",
        "discussion_id": "2002466038",
        "commented_code": "@@ -0,0 +1,96 @@\n+import { CrawlImpl, CrawlSuccessResult } from '../type';\n+import { NetworkConnectionError, PageNotFoundError, TimeoutError } from '../utils/errorType';\n+\n+interface Search1ApiResponse {\n+  crawlParameters: {\n+    url: string;\n+  };\n+  results: {\n+    title?: string;\n+    link?: string;\n+    content?: string;\n+  };\n+}\n+\n+const TIMEOUT_CONTROL = 10_000;\n+\n+const withTimeout = <T>(promise: Promise<T>, ms: number): Promise<T> => {",
        "comment_created_at": "2025-03-19T05:46:32+00:00",
        "comment_author": "arvinxx",
        "comment_body": "withTimeout \u8fd9\u4e2a\u65b9\u6cd5\u62bd\u5230 util \u91cc\u5427\uff0c\u7136\u540e\u628a naive \u7684\u4e5f\u6539\u4e0b",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1768498125",
    "pr_number": 4042,
    "pr_file": "src/app/manifest.ts",
    "created_at": "2024-09-20T12:22:50+00:00",
    "commented_code": "+import { kebabCase } from 'lodash-es';\n+import type { MetadataRoute } from 'next';\n+import qs from 'query-string';\n+\n+import { BRANDING_LOGO_URL, BRANDING_NAME } from '@/const/branding';\n+import { translation } from '@/server/translation';\n+import { getCanonicalUrl } from '@/server/utils/url';\n+\n+const genImage = (url: string, version: number = 1) =>",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "1768498125",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 4042,
        "pr_file": "src/app/manifest.ts",
        "discussion_id": "1768498125",
        "commented_code": "@@ -0,0 +1,185 @@\n+import { kebabCase } from 'lodash-es';\n+import type { MetadataRoute } from 'next';\n+import qs from 'query-string';\n+\n+import { BRANDING_LOGO_URL, BRANDING_NAME } from '@/const/branding';\n+import { translation } from '@/server/translation';\n+import { getCanonicalUrl } from '@/server/utils/url';\n+\n+const genImage = (url: string, version: number = 1) =>",
        "comment_created_at": "2024-09-20T12:22:50+00:00",
        "comment_author": "arvinxx",
        "comment_body": "version \u63d0\u6210\u5355\u72ec\u7684\u53d8\u91cf\u5427\uff0c\u4e0d\u9700\u8981\u51fd\u6570\u8fd9\u91cc\u63a7\u5236\u3002\r\n\r\nconst VERSION = 1;\r\n\r\nconst genImage = (url: string) =>\r\n  BRANDING_LOGO_URL || qs.stringifyUrl({ query: { v: VERSION }, url });",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1418268353",
    "pr_number": 587,
    "pr_file": "src/store/file/slices/tts/action.ts",
    "created_at": "2023-12-07T03:35:08+00:00",
    "commented_code": "+import useSWR, { SWRResponse } from 'swr';\n+import { StateCreator } from 'zustand/vanilla';\n+\n+import { fileService } from '@/services/file';\n+import { FilePreview } from '@/types/files';\n+\n+import { FileStore } from '../../store';\n+\n+export interface TTSFileAction {\n+  removeTTSFile: (id: string) => Promise<void>;\n+\n+  uploadTTSFile: (file: File) => Promise<string | undefined>;\n+\n+  useFetchTTSFile: (id: string | null) => SWRResponse<FilePreview>;\n+}\n+\n+export const createTTSFileSlice: StateCreator<\n+  FileStore,\n+  [['zustand/devtools', never]],\n+  [],\n+  TTSFileAction\n+> = () => ({\n+  removeTTSFile: async (id) => {\n+    await fileService.removeFile(id);\n+  },\n+  uploadTTSFile: async (file) => {",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "1418268353",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 587,
        "pr_file": "src/store/file/slices/tts/action.ts",
        "discussion_id": "1418268353",
        "commented_code": "@@ -0,0 +1,44 @@\n+import useSWR, { SWRResponse } from 'swr';\n+import { StateCreator } from 'zustand/vanilla';\n+\n+import { fileService } from '@/services/file';\n+import { FilePreview } from '@/types/files';\n+\n+import { FileStore } from '../../store';\n+\n+export interface TTSFileAction {\n+  removeTTSFile: (id: string) => Promise<void>;\n+\n+  uploadTTSFile: (file: File) => Promise<string | undefined>;\n+\n+  useFetchTTSFile: (id: string | null) => SWRResponse<FilePreview>;\n+}\n+\n+export const createTTSFileSlice: StateCreator<\n+  FileStore,\n+  [['zustand/devtools', never]],\n+  [],\n+  TTSFileAction\n+> = () => ({\n+  removeTTSFile: async (id) => {\n+    await fileService.removeFile(id);\n+  },\n+  uploadTTSFile: async (file) => {",
        "comment_created_at": "2023-12-07T03:35:08+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u90e8\u5206 TTS \u548c Image \u7684\u5b9e\u73b0\u662f\u5426\u4e00\u6a21\u4e00\u6837\uff1f\u4e00\u6837\u7684\u8bdd\u611f\u89c9\u6ca1\u5fc5\u8981\u91cd\u5199\u4e00\u904d\u3002",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1897891576",
    "pr_number": 5177,
    "pr_file": "src/server/globalConfig/parseSystemAgent.ts",
    "created_at": "2024-12-26T12:30:56+00:00",
    "commented_code": null,
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "1897891576",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 5177,
        "pr_file": "src/server/globalConfig/parseSystemAgent.ts",
        "discussion_id": "1897891576",
        "commented_code": null,
        "comment_created_at": "2024-12-26T12:30:56+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u91cc\u7684\u5b9e\u73b0\u903b\u8f91\u5e76\u4e0d\u5408\u7406\u3002system agent \u548c embedding \u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u4e1a\u52a1\u529f\u80fd\u6a21\u5757\uff0c\u4e0d\u5e94\u8be5\u6df7\u5728\u4e00\u8d77\u3002\u5355\u72ec\u5199\u4e00\u4e2a parseFileConfig",
        "pr_file_module": null
      }
    ]
  }
]