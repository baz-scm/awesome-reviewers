[
  {
    "discussion_id": "2296508331",
    "pr_number": 8453,
    "pr_file": "packages/database/src/schemas/usage.ts",
    "created_at": "2025-08-24T04:50:45+00:00",
    "commented_code": "+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2296508331",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "packages/database/src/schemas/usage.ts",
        "discussion_id": "2296508331",
        "commented_code": "@@ -0,0 +1,48 @@\n+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')",
        "comment_created_at": "2025-08-24T04:50:45+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u4e2a id \u611f\u89c9\u53ef\u4ee5\u76f4\u63a5\u7528 indentity \uff0c\u4e0d\u9700\u8981text",
        "pr_file_module": null
      },
      {
        "comment_id": "2296562474",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "packages/database/src/schemas/usage.ts",
        "discussion_id": "2296508331",
        "commented_code": "@@ -0,0 +1,48 @@\n+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')",
        "comment_created_at": "2025-08-24T08:14:38+00:00",
        "comment_author": "cy948",
        "comment_body": "\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u751f\u6210\u5417\uff1f\r\n\r\n```ts\r\nid: integer(\"id\").primaryKey().generatedByDefaultAsIdentity(),\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "2310781840",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "packages/database/src/schemas/usage.ts",
        "discussion_id": "2296508331",
        "commented_code": "@@ -0,0 +1,48 @@\n+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')",
        "comment_created_at": "2025-08-29T18:02:50+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u5bf9",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2296508542",
    "pr_number": 8453,
    "pr_file": "packages/database/src/schemas/usage.ts",
    "created_at": "2025-08-24T04:51:31+00:00",
    "commented_code": "+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')\n+            .$defaultFn(() => idGenerator('usageRecords', 16))\n+            .primaryKey(),\n+        // Model \u4fe1\u606f\n+        model: text('model').notNull(),\n+        provider: text('provider').notNull(),\n+        // Pricing \u4fe1\u606f\n+        spend: doublePrecision('spend').notNull().default(0.0),\n+        // \u8c03\u7528\u4fe1\u606f\uff0c\u8c01\u7528\u54ea\u4e2aAPI\u8c03\u7528\u4e86\n+            // API \u8c03\u7528\u4fe1\u606f\n+        callType: text('call_type', { enum: ['chat', 'history_summary'] }).notNull(),",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2296508542",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "packages/database/src/schemas/usage.ts",
        "discussion_id": "2296508542",
        "commented_code": "@@ -0,0 +1,48 @@\n+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')\n+            .$defaultFn(() => idGenerator('usageRecords', 16))\n+            .primaryKey(),\n+        // Model \u4fe1\u606f\n+        model: text('model').notNull(),\n+        provider: text('provider').notNull(),\n+        // Pricing \u4fe1\u606f\n+        spend: doublePrecision('spend').notNull().default(0.0),\n+        // \u8c03\u7528\u4fe1\u606f\uff0c\u8c01\u7528\u54ea\u4e2aAPI\u8c03\u7528\u4e86\n+            // API \u8c03\u7528\u4fe1\u606f\n+        callType: text('call_type', { enum: ['chat', 'history_summary'] }).notNull(),",
        "comment_created_at": "2025-08-24T04:51:31+00:00",
        "comment_author": "arvinxx",
        "comment_body": "\u8fd9\u91cc enum \u4e0d\u7528\u914d\u7f6e\u3002\u53e6\u5916\u8fd9\u79cd type \u53ef\u4ee5\u7528 varchar 255 \u6765\u9650\u5b9a\u4f7f\u75281\u5b57\u8282\u5b58\u50a8",
        "pr_file_module": null
      },
      {
        "comment_id": "2296573072",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8453,
        "pr_file": "packages/database/src/schemas/usage.ts",
        "discussion_id": "2296508542",
        "commented_code": "@@ -0,0 +1,48 @@\n+import { text, integer, uniqueIndex, pgTable, doublePrecision, jsonb, timestamp, real } from 'drizzle-orm/pg-core'\n+\n+import { idGenerator } from '../utils/idGenerator'\n+\n+import { timestamps } from './_helpers'\n+import { users } from './user'\n+import { MessageMetadata } from '@/types/message';\n+\n+export const usageRecords = pgTable(\n+    'usage_records',\n+    {\n+        id: text('id')\n+            .$defaultFn(() => idGenerator('usageRecords', 16))\n+            .primaryKey(),\n+        // Model \u4fe1\u606f\n+        model: text('model').notNull(),\n+        provider: text('provider').notNull(),\n+        // Pricing \u4fe1\u606f\n+        spend: doublePrecision('spend').notNull().default(0.0),\n+        // \u8c03\u7528\u4fe1\u606f\uff0c\u8c01\u7528\u54ea\u4e2aAPI\u8c03\u7528\u4e86\n+            // API \u8c03\u7528\u4fe1\u606f\n+        callType: text('call_type', { enum: ['chat', 'history_summary'] }).notNull(),",
        "comment_created_at": "2025-08-24T08:47:56+00:00",
        "comment_author": "cy948",
        "comment_body": "\u6539\u6210\u4e0b\u9762\u7684\u5f62\u5f0f\u4e86\r\n```ts\r\ncallType: varchar('call_type', { length: 256 }).notNull(),\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2133367654",
    "pr_number": 8101,
    "pr_file": "src/database/schemas/rbac.ts",
    "created_at": "2025-06-07T05:08:38+00:00",
    "commented_code": "+/* eslint-disable sort-keys-fix/sort-keys-fix  */\n+import { boolean, index, pgTable, primaryKey, text, timestamp } from 'drizzle-orm/pg-core';\n+\n+import { timestamps } from './_helpers';\n+import { users } from './user';\n+\n+// Roles table\n+export const roles = pgTable('rbac_roles', {\n+  id: text('id').primaryKey().notNull(),",
    "repo_full_name": "lobehub/lobe-chat",
    "discussion_comments": [
      {
        "comment_id": "2133367654",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8101,
        "pr_file": "src/database/schemas/rbac.ts",
        "discussion_id": "2133367654",
        "commented_code": "@@ -0,0 +1,82 @@\n+/* eslint-disable sort-keys-fix/sort-keys-fix  */\n+import { boolean, index, pgTable, primaryKey, text, timestamp } from 'drizzle-orm/pg-core';\n+\n+import { timestamps } from './_helpers';\n+import { users } from './user';\n+\n+// Roles table\n+export const roles = pgTable('rbac_roles', {\n+  id: text('id').primaryKey().notNull(),",
        "comment_created_at": "2025-06-07T05:08:38+00:00",
        "comment_author": "arvinxx",
        "comment_body": "rbac_roles \u548c rbac_permissions  \u4e24\u4e2a\u4e3b\u952e id \u5982\u679c\u6ca1\u6709\u522b\u7684\u8bed\u4e49\u8981\u6c42\u7684\u8bdd\uff0c\u611f\u89c9\u53ef\u4ee5\u76f4\u63a5\u6362\u6210\u81ea\u589e\u7684 Identity \uff1f\r\n\r\n```ts\r\n    id: integer('id').primaryKey().generatedAlwaysAsIdentity(),\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "2133380744",
        "repo_full_name": "lobehub/lobe-chat",
        "pr_number": 8101,
        "pr_file": "src/database/schemas/rbac.ts",
        "discussion_id": "2133367654",
        "commented_code": "@@ -0,0 +1,82 @@\n+/* eslint-disable sort-keys-fix/sort-keys-fix  */\n+import { boolean, index, pgTable, primaryKey, text, timestamp } from 'drizzle-orm/pg-core';\n+\n+import { timestamps } from './_helpers';\n+import { users } from './user';\n+\n+// Roles table\n+export const roles = pgTable('rbac_roles', {\n+  id: text('id').primaryKey().notNull(),",
        "comment_created_at": "2025-06-07T05:21:10+00:00",
        "comment_author": "MarioJames",
        "comment_body": "\u53ef\u4ee5\u7684",
        "pr_file_module": null
      }
    ]
  }
]