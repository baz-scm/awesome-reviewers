[
  {
    "discussion_id": "1155438084",
    "pr_number": 19644,
    "pr_file": "dist/nginx.conf",
    "created_at": "2023-04-03T02:43:00+00:00",
    "commented_code": "listen [::]:80;\n   server_name example.com;\n   root /home/mastodon/live/public;\n-  location /.well-known/acme-challenge/ { allow all; }\n-  location / { return 301 https://$host$request_uri; }\n+  # Hide /acme-challenge subdirectory and return 404 on all requests.\n+  # It is somewhat more secure than letting Nginx return 403.",
    "repo_full_name": "mastodon/mastodon",
    "discussion_comments": [
      {
        "comment_id": "1155438084",
        "repo_full_name": "mastodon/mastodon",
        "pr_number": 19644,
        "pr_file": "dist/nginx.conf",
        "discussion_id": "1155438084",
        "commented_code": "@@ -18,8 +18,20 @@ server {\n   listen [::]:80;\n   server_name example.com;\n   root /home/mastodon/live/public;\n-  location /.well-known/acme-challenge/ { allow all; }\n-  location / { return 301 https://$host$request_uri; }\n+  # Hide /acme-challenge subdirectory and return 404 on all requests.\n+  # It is somewhat more secure than letting Nginx return 403.",
        "comment_created_at": "2023-04-03T02:43:00+00:00",
        "comment_author": "vivlim",
        "comment_body": "Can you explain the claim that it is \"somewhat more secure\" to return a 404 on requests to `/acme-challenge` instead of 403?\r\n\r\nI could only find this referenced in a couple of blog posts and the gist you linked, which is six years old.",
        "pr_file_module": null
      },
      {
        "comment_id": "1155475071",
        "repo_full_name": "mastodon/mastodon",
        "pr_number": 19644,
        "pr_file": "dist/nginx.conf",
        "discussion_id": "1155438084",
        "commented_code": "@@ -18,8 +18,20 @@ server {\n   listen [::]:80;\n   server_name example.com;\n   root /home/mastodon/live/public;\n-  location /.well-known/acme-challenge/ { allow all; }\n-  location / { return 301 https://$host$request_uri; }\n+  # Hide /acme-challenge subdirectory and return 404 on all requests.\n+  # It is somewhat more secure than letting Nginx return 403.",
        "comment_created_at": "2023-04-03T04:41:22+00:00",
        "comment_author": "Izorkin",
        "comment_body": "With a 403 response, the client may assume that the directory /.well-known/acme-challenge/ may be present on the server and used to obtain certificates, but it is not accessible. With a 404 response, it's already harder to know if this directory exists.\r\n",
        "pr_file_module": null
      }
    ]
  }
]