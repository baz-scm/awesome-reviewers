[
  {
    "discussion_id": "2137963645",
    "pr_number": 15985,
    "pr_file": ".github/workflows/sync-public-api-docs.yml",
    "created_at": "2025-06-10T13:50:31+00:00",
    "commented_code": "+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4",
    "repo_full_name": "n8n-io/n8n",
    "discussion_comments": [
      {
        "comment_id": "2137963645",
        "repo_full_name": "n8n-io/n8n",
        "pr_number": 15985,
        "pr_file": ".github/workflows/sync-public-api-docs.yml",
        "discussion_id": "2137963645",
        "commented_code": "@@ -0,0 +1,108 @@\n+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4",
        "comment_created_at": "2025-06-10T13:50:31+00:00",
        "comment_author": "shortstacked",
        "comment_body": "We'll have to pin versions by commit or the security scanner complains.",
        "pr_file_module": null
      },
      {
        "comment_id": "2137981677",
        "repo_full_name": "n8n-io/n8n",
        "pr_number": 15985,
        "pr_file": ".github/workflows/sync-public-api-docs.yml",
        "discussion_id": "2137963645",
        "commented_code": "@@ -0,0 +1,108 @@\n+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4",
        "comment_created_at": "2025-06-10T13:58:28+00:00",
        "comment_author": "MarcL",
        "comment_body": "Forgot about this one. I did it for the other one. Thanks.",
        "pr_file_module": null
      },
      {
        "comment_id": "2174786216",
        "repo_full_name": "n8n-io/n8n",
        "pr_number": 15985,
        "pr_file": ".github/workflows/sync-public-api-docs.yml",
        "discussion_id": "2137963645",
        "commented_code": "@@ -0,0 +1,108 @@\n+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4",
        "comment_created_at": "2025-06-30T10:49:35+00:00",
        "comment_author": "MarcL",
        "comment_body": "Added the SHA.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2137976699",
    "pr_number": 15985,
    "pr_file": ".github/workflows/sync-public-api-docs.yml",
    "created_at": "2025-06-10T13:56:15+00:00",
    "commented_code": "+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4\n+\n+      - name: Setup PNPM\n+        uses: pnpm/action-setup@v3\n+        with:\n+          version: 10\n+\n+      - name: Setup Node.js\n+        uses: actions/setup-node@v4\n+        with:\n+          node-version: '20'\n+          cache: 'pnpm'\n+\n+      - name: Install Dependencies\n+        run: pnpm install --frozen-lockfile\n+\n+      - name: Build Public API Schema\n+        run: pnpm run build:data\n+\n+      - name: Verify OpenAPI schema exists\n+        id: verify_file\n+        run: |\n+          if [[ -f \"packages/cli/dist/public-api/v1/openapi.yml\" ]]; then\n+            echo \"OpenAPI file found: packages/cli/dist/public-api/v1/openapi.yml\"\n+            echo \"file_exists=true\" >> $GITHUB_OUTPUT\n+          else\n+            echo \"ERROR: OpenAPI file not found at packages/cli/dist/public-api/v1/openapi.yml after build.\"\n+            echo \"file_exists=false\" >> $GITHUB_OUTPUT\n+          fi\n+\n+      - name: Generate GitHub App Token\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        id: generate_token\n+        uses: actions/create-github-app-token@v2\n+        with:\n+          app-id: ${{ secrets.N8N_ASSISTANT_APP_ID }}\n+          private-key: ${{ secrets.N8N_ASSISTANT_PRIVATE_KEY }}\n+\n+      - name: Checkout Docs Repository\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        uses: actions/checkout@v4\n+        with:\n+          repository: n8n-io/n8n-docs\n+          token: ${{ steps.generate_token.outputs.token }}\n+          path: public-docs\n+\n+      - name: Copy OpenAPI file to Docs Repo\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        run: |\n+          # Destination path within the 'public-docs' checkout directory\n+          DOCS_TARGET_PATH=\"public-docs/docs/api/v1/openapi.yml\"\n+\n+          echo \"Copying 'packages/cli/dist/public-api/v1/openapi.yml' to '${DOCS_TARGET_PATH}'\"\n+          cp packages/cli/dist/public-api/v1/openapi.yml \"${DOCS_TARGET_PATH}\"\n+\n+      - name: Create PR in Docs Repo\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+\n+        # Pin v7.0.8\n+        uses: peter-evans/create-pull-request@271a8d0340265f705b14b6d32b9829c1cb33d45e\n+        with:\n+          token: ${{ steps.generate_token.outputs.token }}\n+\n+          path: public-docs\n+          commit-message: 'feat(public-api): Update Public API schema'\n+          committer: GitHub <noreply@github.com>\n+          author: ${{ github.actor }} <${{ github.actor_id }}+${{ github.actor }}@users.noreply.github.com>\n+          signoff: false\n+\n+          # Create a unique branch and delete after we're done\n+          branch: 'chore/openapi-sync-${{ github.run_id }}'",
    "repo_full_name": "n8n-io/n8n",
    "discussion_comments": [
      {
        "comment_id": "2137976699",
        "repo_full_name": "n8n-io/n8n",
        "pr_number": 15985,
        "pr_file": ".github/workflows/sync-public-api-docs.yml",
        "discussion_id": "2137976699",
        "commented_code": "@@ -0,0 +1,108 @@\n+name: Sync Public API Schema to Docs Repo\n+\n+on:\n+  # Triggers for the master branch if relevant Public API files have changed\n+  push:\n+    branches:\n+      - master\n+    paths:\n+      # Trigger if:\n+      # - any of the public API files change\n+      - 'packages/cli/src/public-api/**'\n+      # - the build script or dependencies change\n+      - 'packages/cli/package.json'\n+      # - any main dependencies change\n+      - 'pnpm-lock.yaml'\n+\n+  # Allow manual trigger\n+  workflow_dispatch:\n+\n+jobs:\n+  sync-public-api:\n+    runs-on: ubuntu-latest\n+    permissions:\n+      contents: read\n+\n+    steps:\n+      - name: Checkout Main n8n Repository\n+        uses: actions/checkout@v4\n+\n+      - name: Setup PNPM\n+        uses: pnpm/action-setup@v3\n+        with:\n+          version: 10\n+\n+      - name: Setup Node.js\n+        uses: actions/setup-node@v4\n+        with:\n+          node-version: '20'\n+          cache: 'pnpm'\n+\n+      - name: Install Dependencies\n+        run: pnpm install --frozen-lockfile\n+\n+      - name: Build Public API Schema\n+        run: pnpm run build:data\n+\n+      - name: Verify OpenAPI schema exists\n+        id: verify_file\n+        run: |\n+          if [[ -f \"packages/cli/dist/public-api/v1/openapi.yml\" ]]; then\n+            echo \"OpenAPI file found: packages/cli/dist/public-api/v1/openapi.yml\"\n+            echo \"file_exists=true\" >> $GITHUB_OUTPUT\n+          else\n+            echo \"ERROR: OpenAPI file not found at packages/cli/dist/public-api/v1/openapi.yml after build.\"\n+            echo \"file_exists=false\" >> $GITHUB_OUTPUT\n+          fi\n+\n+      - name: Generate GitHub App Token\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        id: generate_token\n+        uses: actions/create-github-app-token@v2\n+        with:\n+          app-id: ${{ secrets.N8N_ASSISTANT_APP_ID }}\n+          private-key: ${{ secrets.N8N_ASSISTANT_PRIVATE_KEY }}\n+\n+      - name: Checkout Docs Repository\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        uses: actions/checkout@v4\n+        with:\n+          repository: n8n-io/n8n-docs\n+          token: ${{ steps.generate_token.outputs.token }}\n+          path: public-docs\n+\n+      - name: Copy OpenAPI file to Docs Repo\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+        run: |\n+          # Destination path within the 'public-docs' checkout directory\n+          DOCS_TARGET_PATH=\"public-docs/docs/api/v1/openapi.yml\"\n+\n+          echo \"Copying 'packages/cli/dist/public-api/v1/openapi.yml' to '${DOCS_TARGET_PATH}'\"\n+          cp packages/cli/dist/public-api/v1/openapi.yml \"${DOCS_TARGET_PATH}\"\n+\n+      - name: Create PR in Docs Repo\n+        if: steps.verify_file.outputs.file_exists == 'true'\n+\n+        # Pin v7.0.8\n+        uses: peter-evans/create-pull-request@271a8d0340265f705b14b6d32b9829c1cb33d45e\n+        with:\n+          token: ${{ steps.generate_token.outputs.token }}\n+\n+          path: public-docs\n+          commit-message: 'feat(public-api): Update Public API schema'\n+          committer: GitHub <noreply@github.com>\n+          author: ${{ github.actor }} <${{ github.actor_id }}+${{ github.actor }}@users.noreply.github.com>\n+          signoff: false\n+\n+          # Create a unique branch and delete after we're done\n+          branch: 'chore/openapi-sync-${{ github.run_id }}'",
        "comment_created_at": "2025-06-10T13:56:15+00:00",
        "comment_author": "shortstacked",
        "comment_body": "You could put the attempt id in here as well, if there is a chance the action could fail after this point. You would have\r\nrunid-1\r\nrunid-2 (on a rerun)",
        "pr_file_module": null
      }
    ]
  }
]