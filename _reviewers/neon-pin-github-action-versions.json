[
  {
    "discussion_id": "2177281767",
    "pr_number": 12357,
    "pr_file": ".github/workflows/build-macos.yml",
    "created_at": "2025-07-01T11:07:43+00:00",
    "commented_code": "with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v14\n           path: pg_install/v14\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v14-${{ steps.pg_rev.outputs.pg_rev_v14 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v15\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v15\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v15\n           path: pg_install/v15\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v15-${{ steps.pg_rev.outputs.pg_rev_v15 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v16\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v16\" cache\n+        uses: actions/cache/restore@v4",
    "repo_full_name": "neondatabase/neon",
    "discussion_comments": [
      {
        "comment_id": "2177281767",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12357,
        "pr_file": ".github/workflows/build-macos.yml",
        "discussion_id": "2177281767",
        "commented_code": "@@ -203,41 +113,51 @@ jobs:\n         with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v14\n           path: pg_install/v14\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v14-${{ steps.pg_rev.outputs.pg_rev_v14 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v15\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v15\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v15\n           path: pg_install/v15\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v15-${{ steps.pg_rev.outputs.pg_rev_v15 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v16\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v16\" cache\n+        uses: actions/cache/restore@v4",
        "comment_created_at": "2025-07-01T11:07:43+00:00",
        "comment_author": "bayandin",
        "comment_body": "```suggestion\r\n        uses: actions/cache/restore@5a3ec84eff668545956fd18022155c47e93e2684 # v4.2.3\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "2183232263",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12357,
        "pr_file": ".github/workflows/build-macos.yml",
        "discussion_id": "2177281767",
        "commented_code": "@@ -203,41 +113,51 @@ jobs:\n         with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v14\n           path: pg_install/v14\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v14-${{ steps.pg_rev.outputs.pg_rev_v14 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v15\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v15\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v15\n           path: pg_install/v15\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v15-${{ steps.pg_rev.outputs.pg_rev_v15 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v16\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v16\" cache\n+        uses: actions/cache/restore@v4",
        "comment_created_at": "2025-07-03T16:37:09+00:00",
        "comment_author": "hlinnaka",
        "comment_body": "ok committed that.\r\n\r\nThere are a few of these in other workflows, should they be changed too?\r\n\r\n```\r\n$ git grep \"cache@v4\"\r\n.github/actions/allure-report-generate/action.yml:      uses: actions/cache@v4\r\n.github/actions/run-python-test-set/action.yml:      uses: actions/cache@v4\r\n.github/workflows/periodic_pagebench.yml:      uses: actions/cache@v4\r\n```\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "2183393199",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12357,
        "pr_file": ".github/workflows/build-macos.yml",
        "discussion_id": "2177281767",
        "commented_code": "@@ -203,41 +113,51 @@ jobs:\n         with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v14\n           path: pg_install/v14\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v14-${{ steps.pg_rev.outputs.pg_rev_v14 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v15\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v15\" cache\n+        uses: actions/cache/restore@v4\n         with:\n-          name: pg_install--v15\n           path: pg_install/v15\n+          key: v1-${{ runner.os }}-${{ runner.arch }}-${{ env.BUILD_TYPE }}-pg-install-v15-${{ steps.pg_rev.outputs.pg_rev_v15 }}-${{ hashFiles('Makefile') }}\n+          fail-on-cache-miss: true\n \n-      - name: Download \"pg_install/v16\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Restore \"pg_install/v16\" cache\n+        uses: actions/cache/restore@v4",
        "comment_created_at": "2025-07-03T17:49:30+00:00",
        "comment_author": "bayandin",
        "comment_body": "Thanks!\r\nWe try not to add new unpinned usage of actions (we should add a linter for that, but not a priority at this moment).\r\n\r\n> There are a few of these in other workflows, should they be changed too?\r\n\r\nThat's up to you \ud83d\ude04 \r\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2177283622",
    "pr_number": 12357,
    "pr_file": ".github/workflows/build-macos.yml",
    "created_at": "2025-07-01T11:08:10+00:00",
    "commented_code": "with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4",
    "repo_full_name": "neondatabase/neon",
    "discussion_comments": [
      {
        "comment_id": "2177283622",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12357,
        "pr_file": ".github/workflows/build-macos.yml",
        "discussion_id": "2177283622",
        "commented_code": "@@ -203,41 +113,51 @@ jobs:\n         with:\n           submodules: true\n \n-      - name: Download \"pg_install/v14\" artifact\n-        uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0\n+      - name: Get pg revisions for restoring cache\n+        id: pg_rev\n+        run: |\n+          echo pg_rev_v14=$(git rev-parse HEAD:vendor/postgres-v14) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v15=$(git rev-parse HEAD:vendor/postgres-v15) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v16=$(git rev-parse HEAD:vendor/postgres-v16) | tee -a \"${GITHUB_OUTPUT}\"\n+          echo pg_rev_v17=$(git rev-parse HEAD:vendor/postgres-v17) | tee -a \"${GITHUB_OUTPUT}\"\n+\n+      - name: Restore \"pg_install/v14\" cache\n+        uses: actions/cache/restore@v4",
        "comment_created_at": "2025-07-01T11:08:10+00:00",
        "comment_author": "bayandin",
        "comment_body": "```suggestion\r\n        uses: actions/cache/restore@5a3ec84eff668545956fd18022155c47e93e2684 # v4.2.3\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2127039880",
    "pr_number": 12069,
    "pr_file": ".github/workflows/build_and_test.yml",
    "created_at": "2025-06-04T16:50:10+00:00",
    "commented_code": "build-tools-image: ${{ needs.build-build-tools-image.outputs.image }}-bookworm\n     secrets: inherit\n \n+  validate-compute-manifest:\n+    runs-on: ubuntu-22.04\n+    steps:\n+\n+      - uses: actions/checkout@v4",
    "repo_full_name": "neondatabase/neon",
    "discussion_comments": [
      {
        "comment_id": "2127039880",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12069,
        "pr_file": ".github/workflows/build_and_test.yml",
        "discussion_id": "2127039880",
        "commented_code": "@@ -199,6 +199,23 @@ jobs:\n       build-tools-image: ${{ needs.build-build-tools-image.outputs.image }}-bookworm\n     secrets: inherit\n \n+  validate-compute-manifest:\n+    runs-on: ubuntu-22.04\n+    steps:\n+\n+      - uses: actions/checkout@v4",
        "comment_created_at": "2025-06-04T16:50:10+00:00",
        "comment_author": "bayandin",
        "comment_body": "Actions should be pinned to a commit\r\n\r\n```suggestion\r\n      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2127041023",
    "pr_number": 12069,
    "pr_file": ".github/workflows/build_and_test.yml",
    "created_at": "2025-06-04T16:50:51+00:00",
    "commented_code": "build-tools-image: ${{ needs.build-build-tools-image.outputs.image }}-bookworm\n     secrets: inherit\n \n+  validate-compute-manifest:\n+    runs-on: ubuntu-22.04\n+    steps:\n+\n+      - uses: actions/checkout@v4\n+\n+      - name: Set up Node.js\n+        uses: actions/setup-node@v4",
    "repo_full_name": "neondatabase/neon",
    "discussion_comments": [
      {
        "comment_id": "2127041023",
        "repo_full_name": "neondatabase/neon",
        "pr_number": 12069,
        "pr_file": ".github/workflows/build_and_test.yml",
        "discussion_id": "2127041023",
        "commented_code": "@@ -199,6 +199,23 @@ jobs:\n       build-tools-image: ${{ needs.build-build-tools-image.outputs.image }}-bookworm\n     secrets: inherit\n \n+  validate-compute-manifest:\n+    runs-on: ubuntu-22.04\n+    steps:\n+\n+      - uses: actions/checkout@v4\n+\n+      - name: Set up Node.js\n+        uses: actions/setup-node@v4",
        "comment_created_at": "2025-06-04T16:50:51+00:00",
        "comment_author": "bayandin",
        "comment_body": "```suggestion\r\n        uses: actions/setup-node@49933ea5288caeca8642d1e84afbd3f7d6820020 # v4.4.0\r\n```",
        "pr_file_module": null
      }
    ]
  }
]