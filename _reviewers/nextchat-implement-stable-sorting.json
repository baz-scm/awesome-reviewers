[
  {
    "discussion_id": "1703625783",
    "pr_number": 5180,
    "pr_file": "app/utils/model.ts",
    "created_at": "2024-08-05T06:53:53+00:00",
    "commented_code": "}\n     });\n \n+  // default models",
    "repo_full_name": "ChatGPTNextWeb/NextChat",
    "discussion_comments": [
      {
        "comment_id": "1703625783",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703625783",
        "commented_code": "@@ -89,6 +80,15 @@ export function collectModelTable(\n       }\n     });\n \n+  // default models",
        "comment_created_at": "2024-08-05T06:53:53+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u7b80\u5355\u7684\u628a\u8fd9\u4e2adefault models\u79fb\u5230\u540e\u9762\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u903b\u8f91\u4e0a\u7684\u95ee\u9898\u3002\r\n\u6b63\u786e\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u5e94\u8be5\u662f\u4e0d\u66f4\u6539\u8fd9\u91cc\u7684\u903b\u8f91\uff0c\u800c\u662f\u5728 `collectModels`\u51fd\u6570\u4e2d`Object.values`\u540e\u9762\u5f15\u5165\u4e00\u4e2a\u6392\u5e8f\u903b\u8f91",
        "pr_file_module": null
      },
      {
        "comment_id": "1703748024",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703625783",
        "commented_code": "@@ -89,6 +80,15 @@ export function collectModelTable(\n       }\n     });\n \n+  // default models",
        "comment_created_at": "2024-08-05T08:38:53+00:00",
        "comment_author": "frostime",
        "comment_body": "\u597d\u7684\uff0c\u6211\u5728\u65b0\u7684 commit (b023) \u4e2d\uff0c\u53bb\u6389\u4e86\u4e4b\u524d\u7684\u5b9e\u73b0\u65b9\u5f0f\uff1b\u5e76\u6309\u7167\u4f60\u7684\u5efa\u8bae\uff0c\u5728 collect \u51fd\u6570\u540e\u9762\u589e\u52a0\u4e86\u989d\u5916\u7684\u6392\u5e8f\u5904\u7406\u3002",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1703756718",
    "pr_number": 5180,
    "pr_file": "app/utils/model.ts",
    "created_at": "2024-08-05T08:45:06+00:00",
    "commented_code": "providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
    "repo_full_name": "ChatGPTNextWeb/NextChat",
    "discussion_comments": [
      {
        "comment_id": "1703756718",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T08:45:06+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u8fd9\u91cc\u6392\u5e8f\uff0celse\u7684\u60c5\u51b5\u4e0b\uff0c\u662f\u5426\u53ef\u4ee5\u6309providerType\u672c\u8eab\u7684\u5b57\u7b26\u987a\u5e8f + model_name\u7684\u5b57\u7b26\u987a\u5e8f\u6392\u5e8f\uff1f\r\n\r\n\u8fd9\u6837\u7684\u5316\uff0c\u4e0d\u662f\u81ea\u5b9a\u4e49\u6a21\u578b\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u4e5f\u4f1a\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u987a\u5e8f\uff0c\u800c\u4e0d\u4f1a\u56e0\u4e3aObject.values\u5bfc\u81f4\u987a\u5e8f\u4e0d\u7a33\u5b9a\u3002\u6709\u7684\u65f6\u5019\u8fd9\u4e2a\u5728\u524d\u9762\uff0c\u6709\u7684\u65f6\u5019\u54ea\u4e2a\u5728\u524d\u9762\u3002",
        "pr_file_module": null
      },
      {
        "comment_id": "1703763880",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T08:49:30+00:00",
        "comment_author": "frostime",
        "comment_body": "\u597d\u7684\uff0c\u6211\u56de\u53bb\u540e\u5f04\u4e00\u4e0b\ud83d\udc4c",
        "pr_file_module": null
      },
      {
        "comment_id": "1703767557",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T08:52:03+00:00",
        "comment_author": "QAbot-zh",
        "comment_body": "\u542f\u7528 -all \u540e\u80fd\u5426\u76f4\u63a5\u6309\u7167\u81ea\u5b9a\u4e49\u6a21\u578b\u5b57\u7b26\u4e32\u7684\u987a\u5e8f\u6765",
        "pr_file_module": null
      },
      {
        "comment_id": "1703785499",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T09:02:23+00:00",
        "comment_author": "frostime",
        "comment_body": "> \u542f\u7528 -all \u540e\u80fd\u5426\u76f4\u63a5\u6309\u7167\u81ea\u5b9a\u4e49\u6a21\u578b\u5b57\u7b26\u4e32\u7684\u987a\u5e8f\u6765\r\n\r\n\u4f60\u8bf4\u7684\u6d89\u53ca\u5230\u591a\u4e2a\u6392\u5e8f\u663e\u793a\u65b9\u6848\u4e86\u3002\u8fd9\u4e2a\u9700\u8981\u6539\u52a8\u8bbe\u7f6e\u754c\u9762\uff0c\u589e\u52a0\u66f4\u591a\u9009\u9879\u3002\r\n\r\n\u8fd9\u4e2a PR \u91cc\u662f\u5199\u6b7b\u4e86\u53ea\u6709 custom first \u7684\u6392\u5e8f\u3002\u867d\u7136\u4e3a\u4e86\u903b\u8f91\u7684\u5b8c\u6574\uff0c\u5728 sort \u51fd\u6570\u91cc\u9762\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53c2\u6570 `rule` \uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u65f6\u5019\u53ea\u6709 `custom-first` \u4e00\u79cd\u65b9\u6848\u4f1a\u88ab\u4f7f\u7528\u3002\r\n\r\n\u540e\u9762\u4e5f\u8bb8\u4f1a\u518d\u63d0\u4ea4\u522b\u7684 PR \uff0c\u770b\u770b\u80fd\u5426\u652f\u6301\u66f4\u591a\u7684\u6392\u5e8f\u65b9\u6848\u3002",
        "pr_file_module": null
      },
      {
        "comment_id": "1703787592",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T09:03:34+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u53e6\u5916\u8fd8\u6709\u4e00\u70b9\uff1a\r\n\u5982\u679caIsCustom=ture\u4ee5\u53caaIsCustom\u4e5f\u4e3atrue\u7684\u65f6\u5019\uff0c\u662f\u4e0d\u662f\u4e5f\u5e94\u8be5\u6309\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\uff1f",
        "pr_file_module": null
      },
      {
        "comment_id": "1703790079",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T09:05:01+00:00",
        "comment_author": "frostime",
        "comment_body": "> \u53e6\u5916\u8fd8\u6709\u4e00\u70b9\uff1a \u5982\u679caIsCustom=ture\u4ee5\u53caaIsCustom\u4e5f\u4e3atrue\u7684\u65f6\u5019\uff0c\u662f\u4e0d\u662f\u4e5f\u5e94\u8be5\u6309\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\uff1f\r\n\r\n\u53ef\u4ee5\u7684\uff0c\u90a3\u6211\u90fd\u8003\u8651\u4e00\u4e0b\uff1b\u5c31\u6539\u6210\u4f18\u5148\u6309\u7167 custom \u4e0e\u5426\u6765\u6392\u5e8f\uff1b\u4e8c\u7ea7\u6392\u5e8f\u6309\u7167\u5b57\u6bcd\u987a\u5e8f\u6392\u5217",
        "pr_file_module": null
      },
      {
        "comment_id": "1703853292",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T09:46:38+00:00",
        "comment_author": "frostime",
        "comment_body": "@lloydzhou  \r\n\u8001\u54e5\u6211\u8fd9\u8fb9\u66f4\u65b0\u4e86\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u5bf9\u4e8e\u5b9e\u73b0\u6548\u679c\u6709\u70b9\u8fdf\u7591\uff1b\u53cd\u6b63\u4ee3\u7801\u4e5f\u4e0d\u591a\uff0c\u5148\u4e0d commit \u76f4\u63a5\u8d34\u4e0a\u6765\u7ed9\u4f60\u770b\u4e0b\u597d\u4e86\uff1a\r\n\r\n```ts\r\n/**\r\n * Sorts an array of models based on specified rules.\r\n *\r\n * @param models - The array of models to be sorted.\r\n * @param rule - The sorting rule to apply.\r\n *   - \"custom-first\": Custom models will be sorted first.\r\n *   - \"default-first\": Default models will be sorted first.\r\n *\r\n * @returns The sorted array of models.\r\n */\r\nconst sortModelTable = (\r\n  models: ReturnType<typeof collectModels>,\r\n  rule: \"custom-first\" | \"default-first\",\r\n) =>\r\n  models.sort((a, b) => {\r\n    // Determine if the models are custom\r\n    let aIsCustom = a.provider?.providerType === \"custom\";\r\n    let bIsCustom = b.provider?.providerType === \"custom\";\r\n\r\n    // If one is custom while another isn't, sort by `custom`\r\n    if (aIsCustom !== bIsCustom) {\r\n      return aIsCustom === (rule === \"custom-first\") ? -1 : 1;\r\n    }\r\n\r\n    // Sort by providerType and model_name\r\n    if (a.provider && b.provider) {\r\n      const providerTypeComparison = a.provider.providerType.localeCompare(b.provider.providerType);\r\n      if (providerTypeComparison !== 0) {\r\n        return providerTypeComparison;\r\n      }\r\n      return a.name.localeCompare(b.name);\r\n    }\r\n\r\n    // If one of the providers is undefined, sort based on the availability of the provider\r\n    if (a.provider && !b.provider) {\r\n      return -1;\r\n    }\r\n    if (!a.provider && b.provider) {\r\n      return 1;\r\n    }\r\n\r\n    // If both providers are undefined, sort by model_name\r\n    return a.name.localeCompare(b.name);\r\n  });\r\n```\r\n\r\n\u57fa\u672c\u903b\u8f91\u5c31\u662f\u4f18\u5148\u6309\u7167 custom \u6765\u6392\u5e8f\uff0c\u5982\u679c\u90fd\u4e0d\u662f custom\uff0c\u5c31\u6309\u7167providerType \u6765 model_name\u6765\u6392\u5e8f\u3002\r\n\r\n\u4e0d\u8fc7\u8fd9\u6837\u641e\uff0c\u963f\u91cc\u7684\u6a21\u578b\u5c31\u8dd1\u5230\u6700\u524d\u9762\uff0c\u53cd\u800c\u662f\u6700\u5e38\u7528\u7684 GPT \u8dd1\u5230\u540e\u9762\u4e86\u3002\ud83d\ude02\r\n\r\n![image](https://github.com/user-attachments/assets/30f1ebfc-d91e-447f-831c-e2b324839288)\r\n\r\n\u4f60\u770b\u662f\u5c31\u4fdd\u6301\u8fd9\u4e2a\u903b\u8f91\u63d0\u4ea4\uff0c\u8fd8\u662f\u6211\u989d\u5916\u589e\u52a0\u4e00\u4e9b\u914d\u7f6e\uff0c\u5f3a\u5236\u628a OpenAI \u7684\u653e\u5230\u524d\u9762\u6765\uff1f",
        "pr_file_module": null
      },
      {
        "comment_id": "1703890587",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T10:17:13+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u786e\u5b9e\u662f\u4e2a\u95ee\u9898...\u6bd5\u7adf\u5e38\u7528\u7684\u662fOpenAI...\u6709\u70b9\u6b20\u8003\u8651\u4e86...",
        "pr_file_module": null
      },
      {
        "comment_id": "1703915710",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T10:38:51+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u6216\u8bb8\u5e94\u8be5\u6362\u4e00\u79cd\u601d\u8def\uff1a\r\n1. \u5f15\u5165\u4e00\u4e2a\u65b0\u7684sorted\u5b57\u6bb5\u8fdb\u884c\u6392\u5e8f\r\n2. constant.ts\u4e2d\u5bf9\u5185\u7f6e\u7684provider\u914d\u7f6e\u6392\u5e8f\u5b57\u6bb5\r\n```\r\n// constant\r\nlet seq = 1000;  // \u5185\u7f6e\u7684\u6a21\u578b\u5e8f\u53f7\u751f\u6210\u5668\u4ece1000\u5f00\u59cb\r\nexport const DEFAULT_MODELS = [\r\n  ...openaiModels.map((name) => ({\r\n    name,\r\n    available: true,\r\n    sorted: seq++,  // \u8fd9\u91cc\u4f7f\u7528\u4e00\u4e2a\u5168\u5c40\u7684\u5e8f\u53f7\u751f\u6210\u5668\r\n    provider: {\r\n      id: \"openai\",\r\n      providerName: \"OpenAI\",\r\n      providerType: \"openai\",\r\n      sorted: 1  // \u8fd9\u91cc\u662f\u56fa\u5b9a\u7684\uff0c\u786e\u4fdd\u987a\u5e8f\u4e0e\u4e4b\u524d\u5185\u7f6e\u7684\u7248\u672c\u4e00\u81f4\r\n    },\r\n  })),\r\n  // ......\r\n] as const;\r\n```\r\n2. utils/model.ts\u4e2d\uff0c\u9488\u5bf9\u65b0\u751f\u6210\u7684\u6a21\u578b\uff0c\u4f7f\u7528\u4e00\u4e2a\u65b0\u7684\u5e8f\u53f7\u751f\u6210\u5668\uff08\u4ece-1000\u5f00\u59cb\uff09\u786e\u4fdd\u6392\u5e8f\u5728\u524d\u9762\r\n```\r\nlet customSeq = -1000 // \u8fd9\u4e2a\u662f\u81ea\u5b9a\u4e49\u7684\u6a21\u578b\u4ee5\u53ca\u81ea\u5b9a\u4e49\u7684customProvider\u4f7f\u7528\u540c\u4e00\u4e2a\u5e8f\u53f7\u751f\u6210\u5668\uff0c\u4ece-1000\u5f00\u59cb\u81ea\u589e\r\n\r\n// \u4e0b\u9762\u662f\u786e\u4fdd\u81ea\u5b9a\u4e49\u7684model\u4ee5\u53caprovider\u7684sorted\u662f\u8d1f\u6570\uff0c\u6392\u5e8f\u4f1a\u5728\u524d\u9762\r\nconst customProvider = (providerName: string) => ({\r\n  id: providerName.toLowerCase(),\r\n  providerName: providerName,\r\n  providerType: \"custom\",\r\n  sorted: customSeq++,\r\n});\r\n\r\n        modelTable[`${customModelName}@${provider?.id}`] = {\r\n            name: customModelName,\r\n            displayName: displayName || customModelName,\r\n            available,\r\n            provider, // Use optional chaining\r\n            sorted: customSeq++\r\n          };\r\n```\r\n3. \u66f4\u65b0sortModelTable\u51fd\u6570\uff0c\u5206\u522b\u4f7f\u7528\u5bf9\u5e94\u7684sorted\u5b57\u6bb5\u987a\u5e8f\u6392\u5e8f\u5373\u53ef\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "1703991306",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T11:45:30+00:00",
        "comment_author": "frostime",
        "comment_body": "> \u6216\u8bb8\u5e94\u8be5\u6362\u4e00\u79cd\u601d\u8def\uff1a\r\n> \r\n> 1. \u5f15\u5165\u4e00\u4e2a\u65b0\u7684sorted\u5b57\u6bb5\u8fdb\u884c\u6392\u5e8f\r\n> 2. constant.ts\u4e2d\u5bf9\u5185\u7f6e\u7684provider\u914d\u7f6e\u6392\u5e8f\u5b57\u6bb5\r\n> \r\n> ```\r\n> // constant\r\n> let seq = 1000;  // \u5185\u7f6e\u7684\u6a21\u578b\u5e8f\u53f7\u751f\u6210\u5668\u4ece1000\u5f00\u59cb\r\n> export const DEFAULT_MODELS = [\r\n>   ...openaiModels.map((name) => ({\r\n>     name,\r\n>     available: true,\r\n>     sorted: seq++,  // \u8fd9\u91cc\u4f7f\u7528\u4e00\u4e2a\u5168\u5c40\u7684\u5e8f\u53f7\u751f\u6210\u5668\r\n>     provider: {\r\n>       id: \"openai\",\r\n>       providerName: \"OpenAI\",\r\n>       providerType: \"openai\",\r\n>       sorted: 1  // \u8fd9\u91cc\u662f\u56fa\u5b9a\u7684\uff0c\u786e\u4fdd\u987a\u5e8f\u4e0e\u4e4b\u524d\u5185\u7f6e\u7684\u7248\u672c\u4e00\u81f4\r\n>     },\r\n>   })),\r\n>   // ......\r\n> ] as const;\r\n> ```\r\n> \r\n> 2. utils/model.ts\u4e2d\uff0c\u9488\u5bf9\u65b0\u751f\u6210\u7684\u6a21\u578b\uff0c\u4f7f\u7528\u4e00\u4e2a\u65b0\u7684\u5e8f\u53f7\u751f\u6210\u5668\uff08\u4ece-1000\u5f00\u59cb\uff09\u786e\u4fdd\u6392\u5e8f\u5728\u524d\u9762\r\n> \r\n> ```\r\n> let customSeq = -1000 // \u8fd9\u4e2a\u662f\u81ea\u5b9a\u4e49\u7684\u6a21\u578b\u4ee5\u53ca\u81ea\u5b9a\u4e49\u7684customProvider\u4f7f\u7528\u540c\u4e00\u4e2a\u5e8f\u53f7\u751f\u6210\u5668\uff0c\u4ece-1000\u5f00\u59cb\u81ea\u589e\r\n> \r\n> // \u4e0b\u9762\u662f\u786e\u4fdd\u81ea\u5b9a\u4e49\u7684model\u4ee5\u53caprovider\u7684sorted\u662f\u8d1f\u6570\uff0c\u6392\u5e8f\u4f1a\u5728\u524d\u9762\r\n> const customProvider = (providerName: string) => ({\r\n>   id: providerName.toLowerCase(),\r\n>   providerName: providerName,\r\n>   providerType: \"custom\",\r\n>   sorted: customSeq++,\r\n> });\r\n> \r\n>         modelTable[`${customModelName}@${provider?.id}`] = {\r\n>             name: customModelName,\r\n>             displayName: displayName || customModelName,\r\n>             available,\r\n>             provider, // Use optional chaining\r\n>             sorted: customSeq++\r\n>           };\r\n> ```\r\n> \r\n> 3. \u66f4\u65b0sortModelTable\u51fd\u6570\uff0c\u5206\u522b\u4f7f\u7528\u5bf9\u5e94\u7684sorted\u5b57\u6bb5\u987a\u5e8f\u6392\u5e8f\u5373\u53ef\r\n\r\n\u597d\u7684\uff0ccommit 150fc \u5b9e\u73b0\u4e86\u4f60\u8bf4\u7684\u8fd9\u4e2a\u65b9\u6848\u3002\r\n\r\n\u53e6\u5916\u4f60\u63d0\u5230\u7684 `customSeq` \u6709\u70b9\u95ee\u9898\uff0c\u7531\u4e8e model.ts \u4f1a\u53cd\u590d\u6267\u884c\uff0c\u6240\u4ee5\u8fd9\u4e2a\u53d8\u91cf\u4f1a\u4e00\u76f4\u589e\u957f\u3002\u51fa\u4e8e\u9c81\u68d2\u6027\u7684\u8003\u91cf\uff0c\u6211\u7ed9\u6539\u6210\u4e86\u57fa\u4e8e map \u7684\u65b9\u6848\u3002\u5176\u4ed6\u7684\u5b9e\u73b0\u548c\u4f60\u8bf4\u7684\u5e94\u8be5\u90fd\u662f\u4e00\u81f4\u7684\u3002\r\n\r\n\u6392\u5e8f\u7684\u65f6\u5019\uff0c\u9996\u5148\u6bd4\u8f83 provider\uff0c\u7136\u540e\u6bd4\u8f83 model\u3002",
        "pr_file_module": null
      },
      {
        "comment_id": "1703995393",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T11:49:36+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "~~customSeq\u53d8\u91cf\u5982\u679c\u5728module\u8fd9\u4e00\u5c42\u3002\u5e94\u8be5\u5c31\u4e0d\u4f1a\u65e0\u9650\u5236\u589e\u957f\u3002~~",
        "pr_file_module": null
      },
      {
        "comment_id": "1703996498",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T11:50:36+00:00",
        "comment_author": "frostime",
        "comment_body": "\u554a\u5440\uff0cworkflow \u68c0\u67e5\u6ca1\u8fc7\uff1b\u52a0\u4e86\u4e00\u4e2a sorted \u5b57\u6bb5\u4e4b\u540e\u522b\u7684\u5730\u65b9\u8fd8\u5f97\u6539\uff0c\u9ebb\u70e6\u4e86\ud83d\ude22\u3002",
        "pr_file_module": null
      },
      {
        "comment_id": "1703997741",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T11:51:42+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u4f60\u7684\u65b9\u6848\u5e94\u8be5\u662f\u6b63\u786e\u7684\uff0c\u8fd9\u91cc\u4f1a\u6301\u7eed\u8fd0\u884c\uff0c\u786e\u5b9e\u4f1a\u4e00\u76f4\u589e\u957f",
        "pr_file_module": null
      },
      {
        "comment_id": "1703998728",
        "repo_full_name": "ChatGPTNextWeb/NextChat",
        "pr_number": 5180,
        "pr_file": "app/utils/model.ts",
        "discussion_id": "1703756718",
        "commented_code": "@@ -7,6 +7,29 @@ const customProvider = (providerName: string) => ({\n   providerType: \"custom\",\n });\n \n+const sortModelTable = (\n+  models: ReturnType<typeof collectModels>,\n+  rule: \"custom-first\" | \"default-first\",\n+) =>\n+  models.sort((a, b) => {\n+    if (a.provider === undefined && b.provider === undefined) {\n+      return 0;\n+    }\n+\n+    let aIsCustom = a.provider?.providerType === \"custom\";\n+    let bIsCustom = b.provider?.providerType === \"custom\";\n+\n+    if (aIsCustom === bIsCustom) {\n+      return 0;\n+    }\n+\n+    if (aIsCustom) {\n+      return rule === \"custom-first\" ? -1 : 1;\n+    } else {\n+      return rule === \"custom-first\" ? 1 : -1;",
        "comment_created_at": "2024-08-05T11:52:35+00:00",
        "comment_author": "lloydzhou",
        "comment_body": "\u63d0\u4ea4\u4e4b\u524d\uff0c\u53ef\u4ee5\u672c\u5730\u4f7f\u7528  yarn run build \u6216\u8005 yarn run export\u68c0\u67e5\u4e00\u4e0b\u3002",
        "pr_file_module": null
      }
    ]
  }
]