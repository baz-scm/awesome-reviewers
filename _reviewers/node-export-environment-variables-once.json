[
  {
    "discussion_id": "2072697718",
    "pr_number": 57343,
    "pr_file": "tools/doc/update.sh",
    "created_at": "2025-05-04T19:53:57+00:00",
    "commented_code": "+#!/bin/sh\n+\n+CURL=$(command -v curl)\n+\n+if ! [ -x \"$CURL\" ]; then\n+    echo curl is needed to update api doc tooling\n+    exit 1\n+fi\n+\n+latest_commit=$($CURL -s -H \"Accept: application/vnd.github.VERSION.sha\" \"https://api.github.com/repos/nodejs/api-docs-tooling/commits/main\")\n+\n+rm -rf node_modules/ package-lock.json\n+\n+npm install \"git://github.com/nodejs/api-docs-tooling#$latest_commit\"",
    "repo_full_name": "nodejs/node",
    "discussion_comments": [
      {
        "comment_id": "2072697718",
        "repo_full_name": "nodejs/node",
        "pr_number": 57343,
        "pr_file": "tools/doc/update.sh",
        "discussion_id": "2072697718",
        "commented_code": "@@ -0,0 +1,14 @@\n+#!/bin/sh\n+\n+CURL=$(command -v curl)\n+\n+if ! [ -x \"$CURL\" ]; then\n+    echo curl is needed to update api doc tooling\n+    exit 1\n+fi\n+\n+latest_commit=$($CURL -s -H \"Accept: application/vnd.github.VERSION.sha\" \"https://api.github.com/repos/nodejs/api-docs-tooling/commits/main\")\n+\n+rm -rf node_modules/ package-lock.json\n+\n+npm install \"git://github.com/nodejs/api-docs-tooling#$latest_commit\"",
        "comment_created_at": "2025-05-04T19:53:57+00:00",
        "comment_author": "aduh95",
        "comment_body": "This should not rely on a globally installed `npm` and instead target the one in the tree, for an example see https://github.com/nodejs/node/blob/995ad2b05303ab75e89a58ffcd69f987c2c459d6/tools/dep_updaters/update-acorn-walk.sh#L10-L13\r\n\r\n```suggestion\r\n\"$NODE\" \"$NPM\" install \"git://github.com/nodejs/api-docs-tooling#$latest_commit\"\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "42090504",
    "pr_number": 3308,
    "pr_file": "tools/test-npm.sh",
    "created_at": "2015-10-15T07:24:27+00:00",
    "commented_code": "export npm_config_tmp=\"npm-tmp\"\n \n # install npm devDependencies and run npm's tests\n-\n-../$NODE cli.js install --ignore-scripts\n-../$NODE cli.js run-script test-legacy\n-../$NODE cli.js run-script test\n+NODEPATH=\"$(../$NODE -e 'console.log(require(\"path\").resolve(\"..\"))')\"\n+PATH=\"$NODEPATH:$PATH\" ../$NODE cli.js install --ignore-scripts\n+PATH=\"$NODEPATH:$PATH\" ../$NODE test/run.js\n+PATH=\"$NODEPATH:$PATH\" ../$NODE cli.js run-script tap -- \"test/tap/*.js\"",
    "repo_full_name": "nodejs/node",
    "discussion_comments": [
      {
        "comment_id": "42090504",
        "repo_full_name": "nodejs/node",
        "pr_number": 3308,
        "pr_file": "tools/test-npm.sh",
        "discussion_id": "42090504",
        "commented_code": "@@ -29,10 +29,10 @@ export npm_config_prefix=\"npm-prefix\"\n export npm_config_tmp=\"npm-tmp\"\n \n # install npm devDependencies and run npm's tests\n-\n-../$NODE cli.js install --ignore-scripts\n-../$NODE cli.js run-script test-legacy\n-../$NODE cli.js run-script test\n+NODEPATH=\"$(../$NODE -e 'console.log(require(\"path\").resolve(\"..\"))')\"\n+PATH=\"$NODEPATH:$PATH\" ../$NODE cli.js install --ignore-scripts\n+PATH=\"$NODEPATH:$PATH\" ../$NODE test/run.js\n+PATH=\"$NODEPATH:$PATH\" ../$NODE cli.js run-script tap -- \"test/tap/*.js\"",
        "comment_created_at": "2015-10-15T07:24:27+00:00",
        "comment_author": "Fishrock123",
        "comment_body": "I think this can just be declared as `export PATH=\"$NODEPATH:$PATH\"` above, like https://github.com/nodejs/node/pull/3308/files#diff-de5d26632ba86cba492d3f4a7e6e86a9R29. This should only be locally exported to things the script calls to my understanding.\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "42753153",
    "pr_number": 3308,
    "pr_file": "tools/test-npm.sh",
    "created_at": "2015-10-22T14:18:35+00:00",
    "commented_code": "export npm_config_tmp=\"npm-tmp\"\n \n # install npm devDependencies and run npm's tests\n-\n-../$NODE cli.js install --ignore-scripts\n-../$NODE cli.js run-script test-legacy\n-../$NODE cli.js run-script test\n+NODEPATH=\"$(../$NODE -p 'require(\"path\").resolve(\"..\")')\"",
    "repo_full_name": "nodejs/node",
    "discussion_comments": [
      {
        "comment_id": "42753153",
        "repo_full_name": "nodejs/node",
        "pr_number": 3308,
        "pr_file": "tools/test-npm.sh",
        "discussion_id": "42753153",
        "commented_code": "@@ -29,10 +29,10 @@ export npm_config_prefix=\"npm-prefix\"\n export npm_config_tmp=\"npm-tmp\"\n \n # install npm devDependencies and run npm's tests\n-\n-../$NODE cli.js install --ignore-scripts\n-../$NODE cli.js run-script test-legacy\n-../$NODE cli.js run-script test\n+NODEPATH=\"$(../$NODE -p 'require(\"path\").resolve(\"..\")')\"",
        "comment_created_at": "2015-10-22T14:18:35+00:00",
        "comment_author": "Fishrock123",
        "comment_body": "@rvagg can I get a quick LGTM on changing this line to `export PATH=\"$(../$NODE -p 'require(\"path\").resolve(\"..\")'):$PATH\"`?\n\nThat will mean we no longer require the `PATH=\"$NODEPATH:$PATH\"` on the 3 lines below.\n",
        "pr_file_module": null
      }
    ]
  }
]