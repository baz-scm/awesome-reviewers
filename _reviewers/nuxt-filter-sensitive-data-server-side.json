[
  {
    "discussion_id": "2046798938",
    "pr_number": 31804,
    "pr_file": "docs/2.guide/5.best-practices/security.md",
    "created_at": "2025-04-16T12:16:06+00:00",
    "commented_code": "+---\n+navigation.title: 'Nuxt Security'\n+title: Nuxt security\n+description: Best practices for making Nuxt apps more secure.\n+---\n+\n+Nuxt applications can be affected by the same security risks as any other web application. To protect against them, it is crucial to be aware what kind of attacks and risks are out there. This guide outlines best practices to make your Nuxt application more secure.\n+\n+## Risks\n+\n+The best source of knowledge for most popular security risks is the [OWASP Top 10](https://owasp.org/www-project-top-ten/) that is a standard awareness document for developers and web application security. Let's talk about few of them that we can handle on Nuxt.\n+\n+### Broken Access Control\n+\n+Access control ensures users can only perform actions within their permissions. Failures can lead to unauthorized data access, changes, deletion, or misuse of business functions.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to access admin page when unauthenticated or not-admin user and gets the access to\n+https://example.com/admin/sensitive-data\n+```\n+\n+To protect against such attack, you could implement a proper authorization. Check out Nuxt Authorization [below](#nuxt-authorization).\n+\n+:read-more{title=\"Broken Access Control\" to=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\"}\n+\n+### Denial of Service\n+\n+A Denial of Service (DoS) attack focuses on making a resource (such as a site, application, or server) unavailable for its intended purpose. This can be achieved through various methods, including manipulating network packets, exploiting programming or logical vulnerabilities, or mismanaging resources, among others.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to overload the application server with too many or too heavy requests to make it unable to respond and stop working properly.\n+```\n+\n+To protect against such attack, you could implement a proper rate limiting solution. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Denial of Service\" to=\"https://owasp.org/www-community/attacks/Denial_of_Service\"}\n+\n+### Injections\n+\n+An application is vulnerable when user input isn't properly validated or sanitized, dynamic queries lack parameterization or escaping, and untrusted data is used in ORM queries or concatenated into SQL, commands, or stored procedures. Some of the more common injections are SQL, NoSQL, OS command, Object Relational Mapping (ORM), LDAP, and Expression Language (EL) or Object Graph Navigation Library (OGNL) injection.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses untrusted data in the construction of the following vulnerable SQL call:\n+SELECT \\* FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"';\n+```\n+\n+To protect against such attack, you could implement a proper sanitization and escaping. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Injection\" to=\"https://owasp.org/Top10/A03_2021-Injection/\"}\n+\n+### Outdated components\n+\n+You're likely vulnerable if you lack visibility into the versions of all components (including nested dependencies), use outdated, unsupported, or vulnerable software across your stack, fail to regularly scan for vulnerabilities or track security bulletins, delay patching or upgrades due to rigid schedules, skip compatibility testing after updates, or neglect to secure component configurations.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses an outdated version of the package that contains a malicious code or is vulnerable to attacks\n+```\n+\n+To protect against such attack, you could implement a proper scanning for vulnerabilities in your project. Check out [Snyk](https://snyk.io/).\n+\n+:read-more{title=\"Vulnerable and Outdated Components\" to=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\"}\n+\n+### Authentication failures\n+\n+Authentication and session management are vital to security. Weaknesses may include allowing automated attacks (e.g., credential stuffing, brute force), using default or weak passwords, poor password recovery methods, storing passwords insecurely, lacking proper multi-factor authentication, exposing session IDs in URLs, reusing session IDs after login, and failing to invalidate sessions on logout or inactivity.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+A user uses a public computer to access an application. Instead of selecting \"logout,\" the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.\n+```\n+\n+To protect against such attack, you could implement a proper authentication method. Check out Nuxt Auth Utils [below](#nuxt-auth-utils).\n+\n+:read-more{title=\"Identification and Authentication Failures\" to=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\"}\n+\n+## Content Security Policy\n+\n+Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, clickjacking, formjacking, malicious frames, unwanted trackers, and other web client-side attacks.\n+\n+:read-more{title=\"Content Security Policy\" to=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\"}\n+\n+The CSP header can have the following structure:\n+\n+```\n+Content-Security-Policy: default-src 'self'; img-src 'self' example.com\n+```\n+\n+Currently, a proper Content Security Policy can be enabled by using the Nuxt Security module but we are working on making it part of the core framework. If you are interested in learning more about it, check out [this RFC](https://github.com/nuxt/nuxt/discussions/30404).\n+\n+Nuxt Security helps you increase the security of your site by enabling Strict CSP support for both SSR and SSG applications.\n+\n+1. For `SSR` applications, Nuxt Security implements strict CSP via nonces. A one-time cryptographically-generated random nonce is generated at runtime by the server for each request of a page. In this rendering mode, you can also use all security headers in a regular form of a response header (including headers such as Cross Origin Embeder Policy, Cross Origin Opener Policy, etc).\n+2. For `SSG` applications, Nuxt Security implements strict CSP via hashes. At static build-time, Nuxt Security computes the SHA hashes of the elements that are allowed to execute on your site. The CSP header value is then delivered as `<meta http-equiv>` tag and you can also implement Subresource Integrity that enables the browser to verify that the static assets that your application is loading have not been altered.\n+\n+:read-more{title=\"Strict Content Security Policy\" to=\"https://nuxt-security.vercel.app/advanced/strict-csp\"}\n+\n+\n+## Third-party modules\n+\n+To solve the problems mentioned in the previous section, you may use the third-party modules built by the community members.\n+\n+### Nuxt Security\n+\n+[Nuxt Security](https://nuxt-security.vercel.app/) automatically configures your app to follow OWASP security patterns and principles by using HTTP Headers and Middleware. It comes with features such as:\n+\n+* Security response headers\n+* Request Size & Rate Limiters\n+* Cross Site Scripting (XSS) Validation\n+* Cross-Origin Resource Sharing (CORS) support\n+* Allowed HTTP Methods\n+* Cross Site Request Forgery (CSRF) protection\n+\n+:video-accordion{title=\"Watch the video by Jakub Andrzejewski about Nuxt Security\" videoId=\"sJVeU0KGmv4\"}\n+\n+The module does not need any configuration but if you need to adjust the default settings you can do so like following:\n+\n+```ts\n+export default defineNuxtConfig({\n+  security: {\n+    headers: {\n+      // certain header\n+      xXSSProtection: '1',\n+    },\n+\n+    // certain middleware\n+    rateLimiter: {\n+      // options\n+    }\n+  }\n+})\n+```\n+\n+The module allows to configure the settings and disable certain ones globally and per route.\n+\n+:read-more{title=\"Nuxt Security\" to=\"https://nuxt-security.vercel.app/\"}\n+\n+### Nuxt Auth Utils\n+\n+[Nuxt Auth Utils](https://github.com/atinux/nuxt-auth-utils) allows to add Authentication to Nuxt applications with secured & sealed cookies sessions. It comes with the following features:\n+\n+* Hybrid Rendering support (SSR / CSR / SWR / Prerendering)\n+* 40+ OAuth Providers\n+* Password Hashing\n+* WebAuthn (passkey)\n+* `useUserSession()` Vue composable\n+* Tree-shakable server utils\n+* `<AuthState>` component\n+* Extendable with hooks\n+* WebSocket support\n+\n+After installing the module and providing necessary environment variables, we can start using it as following:\n+\n+```html\n+<script setup>\n+const { loggedIn, user, session, fetch, clear, openInPopup } = useUserSession()\n+</script>\n+\n+<template>\n+  <div v-if=\"loggedIn\">\n+    <h1>Welcome {{ user.login }}!</h1>\n+    <p>Logged in since {{ session.loggedInAt }}</p>\n+    <button @click=\"clear\">Logout</button>\n+  </div>\n+  <div v-else>\n+    <h1>Not logged in</h1>\n+    <a href=\"/auth/github\">Login with GitHub</a>\n+    <!-- or open the OAuth route in a popup -->\n+    <button @click=\"openInPopup('/auth/github')\">Login with GitHub</button>\n+  </div>\n+</template>\n+```\n+\n+Remember that this module only works with a Nuxt server running as it uses server API routes and it won't work with `nuxt generate`. You can anyway use Hybrid Rendering to pre-render pages of your application or disable server-side rendering completely.\n+\n+:read-more{title=\"Nuxt Auth Utils\" to=\"https://github.com/atinux/nuxt-auth-utils\"}\n+\n+### Nuxt Authorization\n+\n+[Nuxt Authorization](https://github.com/barbapapazes/nuxt-authorization) is a module offers a simple yet powerful method for managing authorization in a Nuxt application, applicable to both client and server. It is authentication system agnostic but can be seamlessly integrated with nuxt-auth-utils. It comes with the following features:\n+\n+* Works on both the client (Nuxt) and the server (Nitro)\n+* Write abilities once and use them everywhere\n+* Agnostic of the authentication layer\n+* Use components to conditionally show part of the UI\n+* Primitives are can be accessed for a full customization\n+\n+Abilities constitute the rules that embody the `authorization logic`. They take a user and one or more resources and yield a deny or an allow condition. While they can be grouped by resource, they remain independent of one another.\n+\n+```ts\n+export const editBook = defineAbility((user: User, book: Book) => {\n+  return user.id === book.authorId\n+})\n+```\n+\n+The `defineAbility` function acts as a factory that creates an ability but nothing beyond that. It needs to be used with bouncer functions. In a server endpoint, the `authorize` function can be employed to grant access to a resource based on the abilities\n+\n+```ts\n+export default defineEventHandler(async (event) => {\n+  await authorize(event, editBook)\n+\n+  const books = await db.query.books.findMany()\n+\n+  return books\n+})\n+```\n+\n+:read-more{title=\"Nuxt Authorization\" to=\"https://soubiran.dev/posts/nuxt-going-full-stack-how-to-handle-authorization\"}\n+\n+\n+## Common problems\n+\n+When building more complex Nuxt applications, you will probably encounter some of the problems listed below. Understanding these problems and fixing them will help make your website more secure.\n+\n+### Returning entities with sensitive data\n+\n+**Problem**: When fetching the data from external source (i.e. Database) and returning it in the Nuxt API endpoint, you may return the whole table entity (such as User) to the browser and handle it there. This can lead to unintentional leaking of sensitive information that may not even be needed. \n+\n+**Solution**: Utilize `pick` or use `interceptors` concepts for both `useAsyncData` and `useFetch` to sanitize what you get from the server without leaking confidential data.",
    "repo_full_name": "nuxt/nuxt",
    "discussion_comments": [
      {
        "comment_id": "2046798938",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 31804,
        "pr_file": "docs/2.guide/5.best-practices/security.md",
        "discussion_id": "2046798938",
        "commented_code": "@@ -0,0 +1,306 @@\n+---\n+navigation.title: 'Nuxt Security'\n+title: Nuxt security\n+description: Best practices for making Nuxt apps more secure.\n+---\n+\n+Nuxt applications can be affected by the same security risks as any other web application. To protect against them, it is crucial to be aware what kind of attacks and risks are out there. This guide outlines best practices to make your Nuxt application more secure.\n+\n+## Risks\n+\n+The best source of knowledge for most popular security risks is the [OWASP Top 10](https://owasp.org/www-project-top-ten/) that is a standard awareness document for developers and web application security. Let's talk about few of them that we can handle on Nuxt.\n+\n+### Broken Access Control\n+\n+Access control ensures users can only perform actions within their permissions. Failures can lead to unauthorized data access, changes, deletion, or misuse of business functions.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to access admin page when unauthenticated or not-admin user and gets the access to\n+https://example.com/admin/sensitive-data\n+```\n+\n+To protect against such attack, you could implement a proper authorization. Check out Nuxt Authorization [below](#nuxt-authorization).\n+\n+:read-more{title=\"Broken Access Control\" to=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\"}\n+\n+### Denial of Service\n+\n+A Denial of Service (DoS) attack focuses on making a resource (such as a site, application, or server) unavailable for its intended purpose. This can be achieved through various methods, including manipulating network packets, exploiting programming or logical vulnerabilities, or mismanaging resources, among others.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to overload the application server with too many or too heavy requests to make it unable to respond and stop working properly.\n+```\n+\n+To protect against such attack, you could implement a proper rate limiting solution. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Denial of Service\" to=\"https://owasp.org/www-community/attacks/Denial_of_Service\"}\n+\n+### Injections\n+\n+An application is vulnerable when user input isn't properly validated or sanitized, dynamic queries lack parameterization or escaping, and untrusted data is used in ORM queries or concatenated into SQL, commands, or stored procedures. Some of the more common injections are SQL, NoSQL, OS command, Object Relational Mapping (ORM), LDAP, and Expression Language (EL) or Object Graph Navigation Library (OGNL) injection.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses untrusted data in the construction of the following vulnerable SQL call:\n+SELECT \\* FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"';\n+```\n+\n+To protect against such attack, you could implement a proper sanitization and escaping. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Injection\" to=\"https://owasp.org/Top10/A03_2021-Injection/\"}\n+\n+### Outdated components\n+\n+You're likely vulnerable if you lack visibility into the versions of all components (including nested dependencies), use outdated, unsupported, or vulnerable software across your stack, fail to regularly scan for vulnerabilities or track security bulletins, delay patching or upgrades due to rigid schedules, skip compatibility testing after updates, or neglect to secure component configurations.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses an outdated version of the package that contains a malicious code or is vulnerable to attacks\n+```\n+\n+To protect against such attack, you could implement a proper scanning for vulnerabilities in your project. Check out [Snyk](https://snyk.io/).\n+\n+:read-more{title=\"Vulnerable and Outdated Components\" to=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\"}\n+\n+### Authentication failures\n+\n+Authentication and session management are vital to security. Weaknesses may include allowing automated attacks (e.g., credential stuffing, brute force), using default or weak passwords, poor password recovery methods, storing passwords insecurely, lacking proper multi-factor authentication, exposing session IDs in URLs, reusing session IDs after login, and failing to invalidate sessions on logout or inactivity.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+A user uses a public computer to access an application. Instead of selecting \"logout,\" the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.\n+```\n+\n+To protect against such attack, you could implement a proper authentication method. Check out Nuxt Auth Utils [below](#nuxt-auth-utils).\n+\n+:read-more{title=\"Identification and Authentication Failures\" to=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\"}\n+\n+## Content Security Policy\n+\n+Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, clickjacking, formjacking, malicious frames, unwanted trackers, and other web client-side attacks.\n+\n+:read-more{title=\"Content Security Policy\" to=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\"}\n+\n+The CSP header can have the following structure:\n+\n+```\n+Content-Security-Policy: default-src 'self'; img-src 'self' example.com\n+```\n+\n+Currently, a proper Content Security Policy can be enabled by using the Nuxt Security module but we are working on making it part of the core framework. If you are interested in learning more about it, check out [this RFC](https://github.com/nuxt/nuxt/discussions/30404).\n+\n+Nuxt Security helps you increase the security of your site by enabling Strict CSP support for both SSR and SSG applications.\n+\n+1. For `SSR` applications, Nuxt Security implements strict CSP via nonces. A one-time cryptographically-generated random nonce is generated at runtime by the server for each request of a page. In this rendering mode, you can also use all security headers in a regular form of a response header (including headers such as Cross Origin Embeder Policy, Cross Origin Opener Policy, etc).\n+2. For `SSG` applications, Nuxt Security implements strict CSP via hashes. At static build-time, Nuxt Security computes the SHA hashes of the elements that are allowed to execute on your site. The CSP header value is then delivered as `<meta http-equiv>` tag and you can also implement Subresource Integrity that enables the browser to verify that the static assets that your application is loading have not been altered.\n+\n+:read-more{title=\"Strict Content Security Policy\" to=\"https://nuxt-security.vercel.app/advanced/strict-csp\"}\n+\n+\n+## Third-party modules\n+\n+To solve the problems mentioned in the previous section, you may use the third-party modules built by the community members.\n+\n+### Nuxt Security\n+\n+[Nuxt Security](https://nuxt-security.vercel.app/) automatically configures your app to follow OWASP security patterns and principles by using HTTP Headers and Middleware. It comes with features such as:\n+\n+* Security response headers\n+* Request Size & Rate Limiters\n+* Cross Site Scripting (XSS) Validation\n+* Cross-Origin Resource Sharing (CORS) support\n+* Allowed HTTP Methods\n+* Cross Site Request Forgery (CSRF) protection\n+\n+:video-accordion{title=\"Watch the video by Jakub Andrzejewski about Nuxt Security\" videoId=\"sJVeU0KGmv4\"}\n+\n+The module does not need any configuration but if you need to adjust the default settings you can do so like following:\n+\n+```ts\n+export default defineNuxtConfig({\n+  security: {\n+    headers: {\n+      // certain header\n+      xXSSProtection: '1',\n+    },\n+\n+    // certain middleware\n+    rateLimiter: {\n+      // options\n+    }\n+  }\n+})\n+```\n+\n+The module allows to configure the settings and disable certain ones globally and per route.\n+\n+:read-more{title=\"Nuxt Security\" to=\"https://nuxt-security.vercel.app/\"}\n+\n+### Nuxt Auth Utils\n+\n+[Nuxt Auth Utils](https://github.com/atinux/nuxt-auth-utils) allows to add Authentication to Nuxt applications with secured & sealed cookies sessions. It comes with the following features:\n+\n+* Hybrid Rendering support (SSR / CSR / SWR / Prerendering)\n+* 40+ OAuth Providers\n+* Password Hashing\n+* WebAuthn (passkey)\n+* `useUserSession()` Vue composable\n+* Tree-shakable server utils\n+* `<AuthState>` component\n+* Extendable with hooks\n+* WebSocket support\n+\n+After installing the module and providing necessary environment variables, we can start using it as following:\n+\n+```html\n+<script setup>\n+const { loggedIn, user, session, fetch, clear, openInPopup } = useUserSession()\n+</script>\n+\n+<template>\n+  <div v-if=\"loggedIn\">\n+    <h1>Welcome {{ user.login }}!</h1>\n+    <p>Logged in since {{ session.loggedInAt }}</p>\n+    <button @click=\"clear\">Logout</button>\n+  </div>\n+  <div v-else>\n+    <h1>Not logged in</h1>\n+    <a href=\"/auth/github\">Login with GitHub</a>\n+    <!-- or open the OAuth route in a popup -->\n+    <button @click=\"openInPopup('/auth/github')\">Login with GitHub</button>\n+  </div>\n+</template>\n+```\n+\n+Remember that this module only works with a Nuxt server running as it uses server API routes and it won't work with `nuxt generate`. You can anyway use Hybrid Rendering to pre-render pages of your application or disable server-side rendering completely.\n+\n+:read-more{title=\"Nuxt Auth Utils\" to=\"https://github.com/atinux/nuxt-auth-utils\"}\n+\n+### Nuxt Authorization\n+\n+[Nuxt Authorization](https://github.com/barbapapazes/nuxt-authorization) is a module offers a simple yet powerful method for managing authorization in a Nuxt application, applicable to both client and server. It is authentication system agnostic but can be seamlessly integrated with nuxt-auth-utils. It comes with the following features:\n+\n+* Works on both the client (Nuxt) and the server (Nitro)\n+* Write abilities once and use them everywhere\n+* Agnostic of the authentication layer\n+* Use components to conditionally show part of the UI\n+* Primitives are can be accessed for a full customization\n+\n+Abilities constitute the rules that embody the `authorization logic`. They take a user and one or more resources and yield a deny or an allow condition. While they can be grouped by resource, they remain independent of one another.\n+\n+```ts\n+export const editBook = defineAbility((user: User, book: Book) => {\n+  return user.id === book.authorId\n+})\n+```\n+\n+The `defineAbility` function acts as a factory that creates an ability but nothing beyond that. It needs to be used with bouncer functions. In a server endpoint, the `authorize` function can be employed to grant access to a resource based on the abilities\n+\n+```ts\n+export default defineEventHandler(async (event) => {\n+  await authorize(event, editBook)\n+\n+  const books = await db.query.books.findMany()\n+\n+  return books\n+})\n+```\n+\n+:read-more{title=\"Nuxt Authorization\" to=\"https://soubiran.dev/posts/nuxt-going-full-stack-how-to-handle-authorization\"}\n+\n+\n+## Common problems\n+\n+When building more complex Nuxt applications, you will probably encounter some of the problems listed below. Understanding these problems and fixing them will help make your website more secure.\n+\n+### Returning entities with sensitive data\n+\n+**Problem**: When fetching the data from external source (i.e. Database) and returning it in the Nuxt API endpoint, you may return the whole table entity (such as User) to the browser and handle it there. This can lead to unintentional leaking of sensitive information that may not even be needed. \n+\n+**Solution**: Utilize `pick` or use `interceptors` concepts for both `useAsyncData` and `useFetch` to sanitize what you get from the server without leaking confidential data.",
        "comment_created_at": "2025-04-16T12:16:06+00:00",
        "comment_author": "huang-julien",
        "comment_body": "This isn't considered as a security improvement but more of a performance improvement. Because it allows to reduce the amount of payload in the SSR HTML\r\nSensitive data must always be filtered by the API and not by the consumer.",
        "pr_file_module": null
      },
      {
        "comment_id": "2048343242",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 31804,
        "pr_file": "docs/2.guide/5.best-practices/security.md",
        "discussion_id": "2046798938",
        "commented_code": "@@ -0,0 +1,306 @@\n+---\n+navigation.title: 'Nuxt Security'\n+title: Nuxt security\n+description: Best practices for making Nuxt apps more secure.\n+---\n+\n+Nuxt applications can be affected by the same security risks as any other web application. To protect against them, it is crucial to be aware what kind of attacks and risks are out there. This guide outlines best practices to make your Nuxt application more secure.\n+\n+## Risks\n+\n+The best source of knowledge for most popular security risks is the [OWASP Top 10](https://owasp.org/www-project-top-ten/) that is a standard awareness document for developers and web application security. Let's talk about few of them that we can handle on Nuxt.\n+\n+### Broken Access Control\n+\n+Access control ensures users can only perform actions within their permissions. Failures can lead to unauthorized data access, changes, deletion, or misuse of business functions.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to access admin page when unauthenticated or not-admin user and gets the access to\n+https://example.com/admin/sensitive-data\n+```\n+\n+To protect against such attack, you could implement a proper authorization. Check out Nuxt Authorization [below](#nuxt-authorization).\n+\n+:read-more{title=\"Broken Access Control\" to=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\"}\n+\n+### Denial of Service\n+\n+A Denial of Service (DoS) attack focuses on making a resource (such as a site, application, or server) unavailable for its intended purpose. This can be achieved through various methods, including manipulating network packets, exploiting programming or logical vulnerabilities, or mismanaging resources, among others.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to overload the application server with too many or too heavy requests to make it unable to respond and stop working properly.\n+```\n+\n+To protect against such attack, you could implement a proper rate limiting solution. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Denial of Service\" to=\"https://owasp.org/www-community/attacks/Denial_of_Service\"}\n+\n+### Injections\n+\n+An application is vulnerable when user input isn't properly validated or sanitized, dynamic queries lack parameterization or escaping, and untrusted data is used in ORM queries or concatenated into SQL, commands, or stored procedures. Some of the more common injections are SQL, NoSQL, OS command, Object Relational Mapping (ORM), LDAP, and Expression Language (EL) or Object Graph Navigation Library (OGNL) injection.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses untrusted data in the construction of the following vulnerable SQL call:\n+SELECT \\* FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"';\n+```\n+\n+To protect against such attack, you could implement a proper sanitization and escaping. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Injection\" to=\"https://owasp.org/Top10/A03_2021-Injection/\"}\n+\n+### Outdated components\n+\n+You're likely vulnerable if you lack visibility into the versions of all components (including nested dependencies), use outdated, unsupported, or vulnerable software across your stack, fail to regularly scan for vulnerabilities or track security bulletins, delay patching or upgrades due to rigid schedules, skip compatibility testing after updates, or neglect to secure component configurations.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses an outdated version of the package that contains a malicious code or is vulnerable to attacks\n+```\n+\n+To protect against such attack, you could implement a proper scanning for vulnerabilities in your project. Check out [Snyk](https://snyk.io/).\n+\n+:read-more{title=\"Vulnerable and Outdated Components\" to=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\"}\n+\n+### Authentication failures\n+\n+Authentication and session management are vital to security. Weaknesses may include allowing automated attacks (e.g., credential stuffing, brute force), using default or weak passwords, poor password recovery methods, storing passwords insecurely, lacking proper multi-factor authentication, exposing session IDs in URLs, reusing session IDs after login, and failing to invalidate sessions on logout or inactivity.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+A user uses a public computer to access an application. Instead of selecting \"logout,\" the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.\n+```\n+\n+To protect against such attack, you could implement a proper authentication method. Check out Nuxt Auth Utils [below](#nuxt-auth-utils).\n+\n+:read-more{title=\"Identification and Authentication Failures\" to=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\"}\n+\n+## Content Security Policy\n+\n+Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, clickjacking, formjacking, malicious frames, unwanted trackers, and other web client-side attacks.\n+\n+:read-more{title=\"Content Security Policy\" to=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\"}\n+\n+The CSP header can have the following structure:\n+\n+```\n+Content-Security-Policy: default-src 'self'; img-src 'self' example.com\n+```\n+\n+Currently, a proper Content Security Policy can be enabled by using the Nuxt Security module but we are working on making it part of the core framework. If you are interested in learning more about it, check out [this RFC](https://github.com/nuxt/nuxt/discussions/30404).\n+\n+Nuxt Security helps you increase the security of your site by enabling Strict CSP support for both SSR and SSG applications.\n+\n+1. For `SSR` applications, Nuxt Security implements strict CSP via nonces. A one-time cryptographically-generated random nonce is generated at runtime by the server for each request of a page. In this rendering mode, you can also use all security headers in a regular form of a response header (including headers such as Cross Origin Embeder Policy, Cross Origin Opener Policy, etc).\n+2. For `SSG` applications, Nuxt Security implements strict CSP via hashes. At static build-time, Nuxt Security computes the SHA hashes of the elements that are allowed to execute on your site. The CSP header value is then delivered as `<meta http-equiv>` tag and you can also implement Subresource Integrity that enables the browser to verify that the static assets that your application is loading have not been altered.\n+\n+:read-more{title=\"Strict Content Security Policy\" to=\"https://nuxt-security.vercel.app/advanced/strict-csp\"}\n+\n+\n+## Third-party modules\n+\n+To solve the problems mentioned in the previous section, you may use the third-party modules built by the community members.\n+\n+### Nuxt Security\n+\n+[Nuxt Security](https://nuxt-security.vercel.app/) automatically configures your app to follow OWASP security patterns and principles by using HTTP Headers and Middleware. It comes with features such as:\n+\n+* Security response headers\n+* Request Size & Rate Limiters\n+* Cross Site Scripting (XSS) Validation\n+* Cross-Origin Resource Sharing (CORS) support\n+* Allowed HTTP Methods\n+* Cross Site Request Forgery (CSRF) protection\n+\n+:video-accordion{title=\"Watch the video by Jakub Andrzejewski about Nuxt Security\" videoId=\"sJVeU0KGmv4\"}\n+\n+The module does not need any configuration but if you need to adjust the default settings you can do so like following:\n+\n+```ts\n+export default defineNuxtConfig({\n+  security: {\n+    headers: {\n+      // certain header\n+      xXSSProtection: '1',\n+    },\n+\n+    // certain middleware\n+    rateLimiter: {\n+      // options\n+    }\n+  }\n+})\n+```\n+\n+The module allows to configure the settings and disable certain ones globally and per route.\n+\n+:read-more{title=\"Nuxt Security\" to=\"https://nuxt-security.vercel.app/\"}\n+\n+### Nuxt Auth Utils\n+\n+[Nuxt Auth Utils](https://github.com/atinux/nuxt-auth-utils) allows to add Authentication to Nuxt applications with secured & sealed cookies sessions. It comes with the following features:\n+\n+* Hybrid Rendering support (SSR / CSR / SWR / Prerendering)\n+* 40+ OAuth Providers\n+* Password Hashing\n+* WebAuthn (passkey)\n+* `useUserSession()` Vue composable\n+* Tree-shakable server utils\n+* `<AuthState>` component\n+* Extendable with hooks\n+* WebSocket support\n+\n+After installing the module and providing necessary environment variables, we can start using it as following:\n+\n+```html\n+<script setup>\n+const { loggedIn, user, session, fetch, clear, openInPopup } = useUserSession()\n+</script>\n+\n+<template>\n+  <div v-if=\"loggedIn\">\n+    <h1>Welcome {{ user.login }}!</h1>\n+    <p>Logged in since {{ session.loggedInAt }}</p>\n+    <button @click=\"clear\">Logout</button>\n+  </div>\n+  <div v-else>\n+    <h1>Not logged in</h1>\n+    <a href=\"/auth/github\">Login with GitHub</a>\n+    <!-- or open the OAuth route in a popup -->\n+    <button @click=\"openInPopup('/auth/github')\">Login with GitHub</button>\n+  </div>\n+</template>\n+```\n+\n+Remember that this module only works with a Nuxt server running as it uses server API routes and it won't work with `nuxt generate`. You can anyway use Hybrid Rendering to pre-render pages of your application or disable server-side rendering completely.\n+\n+:read-more{title=\"Nuxt Auth Utils\" to=\"https://github.com/atinux/nuxt-auth-utils\"}\n+\n+### Nuxt Authorization\n+\n+[Nuxt Authorization](https://github.com/barbapapazes/nuxt-authorization) is a module offers a simple yet powerful method for managing authorization in a Nuxt application, applicable to both client and server. It is authentication system agnostic but can be seamlessly integrated with nuxt-auth-utils. It comes with the following features:\n+\n+* Works on both the client (Nuxt) and the server (Nitro)\n+* Write abilities once and use them everywhere\n+* Agnostic of the authentication layer\n+* Use components to conditionally show part of the UI\n+* Primitives are can be accessed for a full customization\n+\n+Abilities constitute the rules that embody the `authorization logic`. They take a user and one or more resources and yield a deny or an allow condition. While they can be grouped by resource, they remain independent of one another.\n+\n+```ts\n+export const editBook = defineAbility((user: User, book: Book) => {\n+  return user.id === book.authorId\n+})\n+```\n+\n+The `defineAbility` function acts as a factory that creates an ability but nothing beyond that. It needs to be used with bouncer functions. In a server endpoint, the `authorize` function can be employed to grant access to a resource based on the abilities\n+\n+```ts\n+export default defineEventHandler(async (event) => {\n+  await authorize(event, editBook)\n+\n+  const books = await db.query.books.findMany()\n+\n+  return books\n+})\n+```\n+\n+:read-more{title=\"Nuxt Authorization\" to=\"https://soubiran.dev/posts/nuxt-going-full-stack-how-to-handle-authorization\"}\n+\n+\n+## Common problems\n+\n+When building more complex Nuxt applications, you will probably encounter some of the problems listed below. Understanding these problems and fixing them will help make your website more secure.\n+\n+### Returning entities with sensitive data\n+\n+**Problem**: When fetching the data from external source (i.e. Database) and returning it in the Nuxt API endpoint, you may return the whole table entity (such as User) to the browser and handle it there. This can lead to unintentional leaking of sensitive information that may not even be needed. \n+\n+**Solution**: Utilize `pick` or use `interceptors` concepts for both `useAsyncData` and `useFetch` to sanitize what you get from the server without leaking confidential data.",
        "comment_created_at": "2025-04-17T06:46:36+00:00",
        "comment_author": "Baroshem",
        "comment_body": "Agree, better to have everything filtered in the API/backend side. But if it is not there (maybe a mistake on the API/Backend side) we can always pick just the information we need. That's what I had in mind when I was adding this point. But we can also remove it if you think that it won't bring value and cause confusion instead :)",
        "pr_file_module": null
      },
      {
        "comment_id": "2050335878",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 31804,
        "pr_file": "docs/2.guide/5.best-practices/security.md",
        "discussion_id": "2046798938",
        "commented_code": "@@ -0,0 +1,306 @@\n+---\n+navigation.title: 'Nuxt Security'\n+title: Nuxt security\n+description: Best practices for making Nuxt apps more secure.\n+---\n+\n+Nuxt applications can be affected by the same security risks as any other web application. To protect against them, it is crucial to be aware what kind of attacks and risks are out there. This guide outlines best practices to make your Nuxt application more secure.\n+\n+## Risks\n+\n+The best source of knowledge for most popular security risks is the [OWASP Top 10](https://owasp.org/www-project-top-ten/) that is a standard awareness document for developers and web application security. Let's talk about few of them that we can handle on Nuxt.\n+\n+### Broken Access Control\n+\n+Access control ensures users can only perform actions within their permissions. Failures can lead to unauthorized data access, changes, deletion, or misuse of business functions.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to access admin page when unauthenticated or not-admin user and gets the access to\n+https://example.com/admin/sensitive-data\n+```\n+\n+To protect against such attack, you could implement a proper authorization. Check out Nuxt Authorization [below](#nuxt-authorization).\n+\n+:read-more{title=\"Broken Access Control\" to=\"https://owasp.org/Top10/A01_2021-Broken_Access_Control/\"}\n+\n+### Denial of Service\n+\n+A Denial of Service (DoS) attack focuses on making a resource (such as a site, application, or server) unavailable for its intended purpose. This can be achieved through various methods, including manipulating network packets, exploiting programming or logical vulnerabilities, or mismanaging resources, among others.\n+\n+A simple example attack scenarion can be:\n+```\n+An attacker tries to overload the application server with too many or too heavy requests to make it unable to respond and stop working properly.\n+```\n+\n+To protect against such attack, you could implement a proper rate limiting solution. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Denial of Service\" to=\"https://owasp.org/www-community/attacks/Denial_of_Service\"}\n+\n+### Injections\n+\n+An application is vulnerable when user input isn't properly validated or sanitized, dynamic queries lack parameterization or escaping, and untrusted data is used in ORM queries or concatenated into SQL, commands, or stored procedures. Some of the more common injections are SQL, NoSQL, OS command, Object Relational Mapping (ORM), LDAP, and Expression Language (EL) or Object Graph Navigation Library (OGNL) injection.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses untrusted data in the construction of the following vulnerable SQL call:\n+SELECT \\* FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"';\n+```\n+\n+To protect against such attack, you could implement a proper sanitization and escaping. Check out Nuxt Security [below](#nuxt-security).\n+\n+:read-more{title=\"Injection\" to=\"https://owasp.org/Top10/A03_2021-Injection/\"}\n+\n+### Outdated components\n+\n+You're likely vulnerable if you lack visibility into the versions of all components (including nested dependencies), use outdated, unsupported, or vulnerable software across your stack, fail to regularly scan for vulnerabilities or track security bulletins, delay patching or upgrades due to rigid schedules, skip compatibility testing after updates, or neglect to secure component configurations.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+An application uses an outdated version of the package that contains a malicious code or is vulnerable to attacks\n+```\n+\n+To protect against such attack, you could implement a proper scanning for vulnerabilities in your project. Check out [Snyk](https://snyk.io/).\n+\n+:read-more{title=\"Vulnerable and Outdated Components\" to=\"https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/\"}\n+\n+### Authentication failures\n+\n+Authentication and session management are vital to security. Weaknesses may include allowing automated attacks (e.g., credential stuffing, brute force), using default or weak passwords, poor password recovery methods, storing passwords insecurely, lacking proper multi-factor authentication, exposing session IDs in URLs, reusing session IDs after login, and failing to invalidate sessions on logout or inactivity.\n+\n+A simple example attack scenarion can be:\n+\n+```\n+A user uses a public computer to access an application. Instead of selecting \"logout,\" the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.\n+```\n+\n+To protect against such attack, you could implement a proper authentication method. Check out Nuxt Auth Utils [below](#nuxt-auth-utils).\n+\n+:read-more{title=\"Identification and Authentication Failures\" to=\"https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/\"}\n+\n+## Content Security Policy\n+\n+Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, clickjacking, formjacking, malicious frames, unwanted trackers, and other web client-side attacks.\n+\n+:read-more{title=\"Content Security Policy\" to=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\"}\n+\n+The CSP header can have the following structure:\n+\n+```\n+Content-Security-Policy: default-src 'self'; img-src 'self' example.com\n+```\n+\n+Currently, a proper Content Security Policy can be enabled by using the Nuxt Security module but we are working on making it part of the core framework. If you are interested in learning more about it, check out [this RFC](https://github.com/nuxt/nuxt/discussions/30404).\n+\n+Nuxt Security helps you increase the security of your site by enabling Strict CSP support for both SSR and SSG applications.\n+\n+1. For `SSR` applications, Nuxt Security implements strict CSP via nonces. A one-time cryptographically-generated random nonce is generated at runtime by the server for each request of a page. In this rendering mode, you can also use all security headers in a regular form of a response header (including headers such as Cross Origin Embeder Policy, Cross Origin Opener Policy, etc).\n+2. For `SSG` applications, Nuxt Security implements strict CSP via hashes. At static build-time, Nuxt Security computes the SHA hashes of the elements that are allowed to execute on your site. The CSP header value is then delivered as `<meta http-equiv>` tag and you can also implement Subresource Integrity that enables the browser to verify that the static assets that your application is loading have not been altered.\n+\n+:read-more{title=\"Strict Content Security Policy\" to=\"https://nuxt-security.vercel.app/advanced/strict-csp\"}\n+\n+\n+## Third-party modules\n+\n+To solve the problems mentioned in the previous section, you may use the third-party modules built by the community members.\n+\n+### Nuxt Security\n+\n+[Nuxt Security](https://nuxt-security.vercel.app/) automatically configures your app to follow OWASP security patterns and principles by using HTTP Headers and Middleware. It comes with features such as:\n+\n+* Security response headers\n+* Request Size & Rate Limiters\n+* Cross Site Scripting (XSS) Validation\n+* Cross-Origin Resource Sharing (CORS) support\n+* Allowed HTTP Methods\n+* Cross Site Request Forgery (CSRF) protection\n+\n+:video-accordion{title=\"Watch the video by Jakub Andrzejewski about Nuxt Security\" videoId=\"sJVeU0KGmv4\"}\n+\n+The module does not need any configuration but if you need to adjust the default settings you can do so like following:\n+\n+```ts\n+export default defineNuxtConfig({\n+  security: {\n+    headers: {\n+      // certain header\n+      xXSSProtection: '1',\n+    },\n+\n+    // certain middleware\n+    rateLimiter: {\n+      // options\n+    }\n+  }\n+})\n+```\n+\n+The module allows to configure the settings and disable certain ones globally and per route.\n+\n+:read-more{title=\"Nuxt Security\" to=\"https://nuxt-security.vercel.app/\"}\n+\n+### Nuxt Auth Utils\n+\n+[Nuxt Auth Utils](https://github.com/atinux/nuxt-auth-utils) allows to add Authentication to Nuxt applications with secured & sealed cookies sessions. It comes with the following features:\n+\n+* Hybrid Rendering support (SSR / CSR / SWR / Prerendering)\n+* 40+ OAuth Providers\n+* Password Hashing\n+* WebAuthn (passkey)\n+* `useUserSession()` Vue composable\n+* Tree-shakable server utils\n+* `<AuthState>` component\n+* Extendable with hooks\n+* WebSocket support\n+\n+After installing the module and providing necessary environment variables, we can start using it as following:\n+\n+```html\n+<script setup>\n+const { loggedIn, user, session, fetch, clear, openInPopup } = useUserSession()\n+</script>\n+\n+<template>\n+  <div v-if=\"loggedIn\">\n+    <h1>Welcome {{ user.login }}!</h1>\n+    <p>Logged in since {{ session.loggedInAt }}</p>\n+    <button @click=\"clear\">Logout</button>\n+  </div>\n+  <div v-else>\n+    <h1>Not logged in</h1>\n+    <a href=\"/auth/github\">Login with GitHub</a>\n+    <!-- or open the OAuth route in a popup -->\n+    <button @click=\"openInPopup('/auth/github')\">Login with GitHub</button>\n+  </div>\n+</template>\n+```\n+\n+Remember that this module only works with a Nuxt server running as it uses server API routes and it won't work with `nuxt generate`. You can anyway use Hybrid Rendering to pre-render pages of your application or disable server-side rendering completely.\n+\n+:read-more{title=\"Nuxt Auth Utils\" to=\"https://github.com/atinux/nuxt-auth-utils\"}\n+\n+### Nuxt Authorization\n+\n+[Nuxt Authorization](https://github.com/barbapapazes/nuxt-authorization) is a module offers a simple yet powerful method for managing authorization in a Nuxt application, applicable to both client and server. It is authentication system agnostic but can be seamlessly integrated with nuxt-auth-utils. It comes with the following features:\n+\n+* Works on both the client (Nuxt) and the server (Nitro)\n+* Write abilities once and use them everywhere\n+* Agnostic of the authentication layer\n+* Use components to conditionally show part of the UI\n+* Primitives are can be accessed for a full customization\n+\n+Abilities constitute the rules that embody the `authorization logic`. They take a user and one or more resources and yield a deny or an allow condition. While they can be grouped by resource, they remain independent of one another.\n+\n+```ts\n+export const editBook = defineAbility((user: User, book: Book) => {\n+  return user.id === book.authorId\n+})\n+```\n+\n+The `defineAbility` function acts as a factory that creates an ability but nothing beyond that. It needs to be used with bouncer functions. In a server endpoint, the `authorize` function can be employed to grant access to a resource based on the abilities\n+\n+```ts\n+export default defineEventHandler(async (event) => {\n+  await authorize(event, editBook)\n+\n+  const books = await db.query.books.findMany()\n+\n+  return books\n+})\n+```\n+\n+:read-more{title=\"Nuxt Authorization\" to=\"https://soubiran.dev/posts/nuxt-going-full-stack-how-to-handle-authorization\"}\n+\n+\n+## Common problems\n+\n+When building more complex Nuxt applications, you will probably encounter some of the problems listed below. Understanding these problems and fixing them will help make your website more secure.\n+\n+### Returning entities with sensitive data\n+\n+**Problem**: When fetching the data from external source (i.e. Database) and returning it in the Nuxt API endpoint, you may return the whole table entity (such as User) to the browser and handle it there. This can lead to unintentional leaking of sensitive information that may not even be needed. \n+\n+**Solution**: Utilize `pick` or use `interceptors` concepts for both `useAsyncData` and `useFetch` to sanitize what you get from the server without leaking confidential data.",
        "comment_created_at": "2025-04-18T08:25:14+00:00",
        "comment_author": "huang-julien",
        "comment_body": ":+1: You can move it to the performance part. but it still need to rephrase/remove the next line.\r\n\r\n> This can lead to unintentional leaking of sensitive information that may not even be needed. \r\n\r\nThe API returning a whole table entity as a response is still a data leak. Even tho the Users may not see it, people with bad intentions will look at the response. An API is and should always  be considered as something public and accessible.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1191956175",
    "pr_number": 20636,
    "pr_file": "docs/2.guide/2.directory-structure/3.app-config.md",
    "created_at": "2023-05-12T06:23:46+00:00",
    "commented_code": "```\n \n ::alert{type=warning}\n-Do not put any secret values inside `app.config` file. It is exposed to the user client bundle.\n+Do not put secret values inside the `app.config` file. It is exposed to the user-client bundle.",
    "repo_full_name": "nuxt/nuxt",
    "discussion_comments": [
      {
        "comment_id": "1191956175",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 20636,
        "pr_file": "docs/2.guide/2.directory-structure/3.app-config.md",
        "discussion_id": "1191956175",
        "commented_code": "@@ -18,12 +18,12 @@ export default defineAppConfig({\n ```\n \n ::alert{type=warning}\n-Do not put any secret values inside `app.config` file. It is exposed to the user client bundle.\n+Do not put secret values inside the `app.config` file. It is exposed to the user-client bundle.",
        "comment_created_at": "2023-05-12T06:23:46+00:00",
        "comment_author": "DamianGlowala",
        "comment_body": "```suggestion\r\nDo not put secret values inside the `app.config` file. It is exposed to the client-side bundle.\r\n```",
        "pr_file_module": null
      }
    ]
  }
]