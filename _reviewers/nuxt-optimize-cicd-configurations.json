[
  {
    "discussion_id": "1646611345",
    "pr_number": 27604,
    "pr_file": ".github/workflows/release-pr.yml",
    "created_at": "2024-06-19T19:07:57+00:00",
    "commented_code": "env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n \n-      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7\n+      - name: Get PR Info\n+        id: pr\n+        env:\n+          PR_NUMBER: ${{ github.event.issue.number }}\n+          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+          GH_REPO: ${{ github.repository }}\n+          COMMENT_AT: ${{ github.event.comment.created_at }}\n+        run: |\n+          pr=\"$(gh api -H \"Accept: application/vnd.github+json\" -H \"X-GitHub-Api-Version: 2022-11-28\" /repos/${GH_REPO}/pulls/${PR_NUMBER})\"\n+          head_sha=\"$(echo \"$pr\" | jq -r .head.sha)\"\n+          updated_at=\"$(echo \"$pr\" | jq -r .updated_at)\"\n+\n+          if [[ $(date -d $updated_at) > $(date -d $COMMENT_AT) ]]; exit 1; fi\n+          \n+          echo \"head_sha=$head_sha\" >> $GITHUB_OUTPUT\n+      - uses: actions/checkout@v4\n         with:\n-          ref: ${{ github.event.issue.pull_request.head.sha }}\n-          fetch-depth: 0\n+          ref: ${{ steps.pr.outputs.head_sha }}",
    "repo_full_name": "nuxt/nuxt",
    "discussion_comments": [
      {
        "comment_id": "1646611345",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 27604,
        "pr_file": ".github/workflows/release-pr.yml",
        "discussion_id": "1646611345",
        "commented_code": "@@ -29,10 +29,24 @@ jobs:\n         env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n \n-      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7\n+      - name: Get PR Info\n+        id: pr\n+        env:\n+          PR_NUMBER: ${{ github.event.issue.number }}\n+          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+          GH_REPO: ${{ github.repository }}\n+          COMMENT_AT: ${{ github.event.comment.created_at }}\n+        run: |\n+          pr=\"$(gh api -H \"Accept: application/vnd.github+json\" -H \"X-GitHub-Api-Version: 2022-11-28\" /repos/${GH_REPO}/pulls/${PR_NUMBER})\"\n+          head_sha=\"$(echo \"$pr\" | jq -r .head.sha)\"\n+          updated_at=\"$(echo \"$pr\" | jq -r .updated_at)\"\n+\n+          if [[ $(date -d $updated_at) > $(date -d $COMMENT_AT) ]]; exit 1; fi\n+          \n+          echo \"head_sha=$head_sha\" >> $GITHUB_OUTPUT\n+      - uses: actions/checkout@v4\n         with:\n-          ref: ${{ github.event.issue.pull_request.head.sha }}\n-          fetch-depth: 0\n+          ref: ${{ steps.pr.outputs.head_sha }}",
        "comment_created_at": "2024-06-19T19:07:57+00:00",
        "comment_author": "danielroe",
        "comment_body": "```suggestion\r\n          ref: ${{ steps.pr.outputs.head_sha }}\r\n          fetch-depth: 1\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1580023166",
    "pr_number": 26937,
    "pr_file": ".github/workflows/scorecards.yml",
    "created_at": "2024-04-25T19:25:12+00:00",
    "commented_code": "id-token: write\n       contents: read\n       actions: read\n+    if: ${{github.event_name == 'push' || github.repository == 'nuxt/nuxt.js'}}",
    "repo_full_name": "nuxt/nuxt",
    "discussion_comments": [
      {
        "comment_id": "1580023166",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 26937,
        "pr_file": ".github/workflows/scorecards.yml",
        "discussion_id": "1580023166",
        "commented_code": "@@ -28,6 +28,7 @@ jobs:\n       id-token: write\n       contents: read\n       actions: read\n+    if: ${{github.event_name == 'push' || github.repository == 'nuxt/nuxt.js'}}",
        "comment_created_at": "2024-04-25T19:25:12+00:00",
        "comment_author": "danielroe",
        "comment_body": "```suggestion\n    if: ${{github.event_name == 'push' || github.repository == 'nuxt/nuxt'}}\n```\n",
        "pr_file_module": null
      }
    ]
  }
]