[
  {
    "discussion_id": "1640946146",
    "pr_number": 27604,
    "pr_file": ".github/workflows/release-pr.yml",
    "created_at": "2024-06-15T09:22:08+00:00",
    "commented_code": "env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n \n-      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7\n+      - name: Get PR Info\n+        id: pr\n+        env:\n+          PR_NUMBER: ${{ github.event.issue.number }}\n+          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+          GH_REPO: ${{ github.repository }}\n+          COMMENT_AT: ${{ github.event.comment.created_at }}\n+        run: |\n+          pr=\"$(gh api -H \"Accept: application/vnd.github+json\" -H \"X-GitHub-Api-Version: 2022-11-28\" /repos/${GH_REPO}/pulls/${PR_NUMBER})\"\n+          head_sha=\"$(echo \"$pr\" | jq -r .head.sha)\"\n+          updated_at=\"$(echo \"$pr\" | jq -r .updated_at)\"\n+\n+          if [[ $(date -d $updated_at) > $(date -d $COMMENT_AT) ]]; exit 1; fi",
    "repo_full_name": "nuxt/nuxt",
    "discussion_comments": [
      {
        "comment_id": "1640946146",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 27604,
        "pr_file": ".github/workflows/release-pr.yml",
        "discussion_id": "1640946146",
        "commented_code": "@@ -29,10 +29,24 @@ jobs:\n         env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n \n-      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7\n+      - name: Get PR Info\n+        id: pr\n+        env:\n+          PR_NUMBER: ${{ github.event.issue.number }}\n+          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+          GH_REPO: ${{ github.repository }}\n+          COMMENT_AT: ${{ github.event.comment.created_at }}\n+        run: |\n+          pr=\"$(gh api -H \"Accept: application/vnd.github+json\" -H \"X-GitHub-Api-Version: 2022-11-28\" /repos/${GH_REPO}/pulls/${PR_NUMBER})\"\n+          head_sha=\"$(echo \"$pr\" | jq -r .head.sha)\"\n+          updated_at=\"$(echo \"$pr\" | jq -r .updated_at)\"\n+\n+          if [[ $(date -d $updated_at) > $(date -d $COMMENT_AT) ]]; exit 1; fi",
        "comment_created_at": "2024-06-15T09:22:08+00:00",
        "comment_author": "danielroe",
        "comment_body": "Can this be forged? ie force push an 'older' commit?",
        "pr_file_module": null
      },
      {
        "comment_id": "1640998414",
        "repo_full_name": "nuxt/nuxt",
        "pr_number": 27604,
        "pr_file": ".github/workflows/release-pr.yml",
        "discussion_id": "1640946146",
        "commented_code": "@@ -29,10 +29,24 @@ jobs:\n         env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n \n-      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7\n+      - name: Get PR Info\n+        id: pr\n+        env:\n+          PR_NUMBER: ${{ github.event.issue.number }}\n+          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+          GH_REPO: ${{ github.repository }}\n+          COMMENT_AT: ${{ github.event.comment.created_at }}\n+        run: |\n+          pr=\"$(gh api -H \"Accept: application/vnd.github+json\" -H \"X-GitHub-Api-Version: 2022-11-28\" /repos/${GH_REPO}/pulls/${PR_NUMBER})\"\n+          head_sha=\"$(echo \"$pr\" | jq -r .head.sha)\"\n+          updated_at=\"$(echo \"$pr\" | jq -r .updated_at)\"\n+\n+          if [[ $(date -d $updated_at) > $(date -d $COMMENT_AT) ]]; exit 1; fi",
        "comment_created_at": "2024-06-15T10:31:39+00:00",
        "comment_author": "avivkeller",
        "comment_body": "No, that's the PR updated_at, so it would be the push date",
        "pr_file_module": null
      }
    ]
  }
]