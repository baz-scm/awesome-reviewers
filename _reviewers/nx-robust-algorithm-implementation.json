[
  {
    "discussion_id": "2413918226",
    "pr_number": 33013,
    "pr_file": "packages/nx/src/tasks-runner/task-env.ts",
    "created_at": "2025-10-08T13:44:51+00:00",
    "commented_code": "}\n \n function getEnvFilesForTask(task: Task): string[] {\n+  const target = task.target.target.split('--')[0];",
    "repo_full_name": "nrwl/nx",
    "discussion_comments": [
      {
        "comment_id": "2413918226",
        "repo_full_name": "nrwl/nx",
        "pr_number": 33013,
        "pr_file": "packages/nx/src/tasks-runner/task-env.ts",
        "discussion_id": "2413918226",
        "commented_code": "@@ -166,50 +166,51 @@ export function unloadDotEnvFile(\n }\n \n function getEnvFilesForTask(task: Task): string[] {\n+  const target = task.target.target.split('--')[0];",
        "comment_created_at": "2025-10-08T13:44:51+00:00",
        "comment_author": "MaxKless",
        "comment_body": "I think this would be less brittle/hacky if we passed the project graph into here and used the atomization metadata to determine the parent task vs basing it purely on the task name",
        "pr_file_module": null
      },
      {
        "comment_id": "2414001364",
        "repo_full_name": "nrwl/nx",
        "pr_number": 33013,
        "pr_file": "packages/nx/src/tasks-runner/task-env.ts",
        "discussion_id": "2413918226",
        "commented_code": "@@ -166,50 +166,51 @@ export function unloadDotEnvFile(\n }\n \n function getEnvFilesForTask(task: Task): string[] {\n+  const target = task.target.target.split('--')[0];",
        "comment_created_at": "2025-10-08T14:11:19+00:00",
        "comment_author": "meeroslav",
        "comment_body": "I agree. I wasn't sure about modifying the public caller with graph reference but i guess it's the only way to be sure.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2382601689",
    "pr_number": 32583,
    "pr_file": "packages/nx/src/command-line/release/publish.ts",
    "created_at": "2025-09-26T14:59:42+00:00",
    "commented_code": "].join('\n')}\n`\n     );\n   }\n+  const id = hashArray([...process.argv, Date.now().toString()]);",
    "repo_full_name": "nrwl/nx",
    "discussion_comments": [
      {
        "comment_id": "2382684187",
        "repo_full_name": "nrwl/nx",
        "pr_number": 32583,
        "pr_file": "packages/nx/src/command-line/release/publish.ts",
        "discussion_id": "2382601689",
        "commented_code": "@@ -272,11 +273,14 @@ async function runPublishOnProjects(\n       ].join('\\n')}\\n`\n     );\n   }\n+  const id = hashArray([...process.argv, Date.now().toString()]);",
        "comment_created_at": "2025-09-26T14:59:42+00:00",
        "comment_author": "meeroslav",
        "comment_body": "The same id value is used for both pre and post hook so they will match. We intentionally want to use different Id for different invocation of the same command, thus argv itself is not enough.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2308621684",
    "pr_number": 32565,
    "pr_file": "astro-docs/src/plugins/utils/devkit-generation.ts",
    "created_at": "2025-08-28T21:47:04+00:00",
    "commented_code": "+import { type CollectionEntry, type RenderedContent } from 'astro:content';\n+import {\n+  allowedReflections,\n+  categoryMap,\n+  setupTypeDoc,\n+} from './typedoc/setupTypeDoc';\n+import type { LoaderContext } from 'astro/loaders';\n+import { workspaceRoot } from '@nx/devkit';\n+import { join } from 'node:path';\n+import { existsSync } from 'node:fs';\n+import {\n+  Application,\n+  DeclarationReflection,\n+  PackageJsonReader,\n+  ReflectionKind,\n+  TSConfigReader,\n+  TypeDocReader,\n+  type TypeDocOptions,\n+} from 'typedoc';\n+import {\n+  formatDeclarationToMarkdown,\n+  formatComment,\n+} from './markdown-formatters';\n+import NxMarkdownTheme from './typedoc/theme';\n+\n+export async function loadDevkitPackage(\n+  context: LoaderContext\n+): Promise<CollectionEntry<'nx-reference-packages'>[]> {\n+  const { logger, renderMarkdown } = context;\n+  logger.info('Loading DevKit documentation');\n+\n+  try {\n+    const { defaultTypedocOptions, outDir, buildDir } = setupTypeDoc(logger);\n+    const entries: CollectionEntry<'nx-reference-packages'>[] = [];\n+\n+    // TODO: Caleb there seems to be a resolution error where this entrypoint will resolved types\n+    // from the node_modules/nx package and not the local workspace changes\n+    // see: DOC-188\n+    // Load main devkit\n+    const devkitEntryPoint = join(\n+      workspaceRoot,\n+      'dist',\n+      'packages',\n+      'devkit',\n+      'index.d.ts'\n+    );\n+    if (existsSync(devkitEntryPoint)) {\n+      const devkitDocs = await generateDocsForEntry(\n+        {\n+          ...defaultTypedocOptions,\n+          entryPoints: [devkitEntryPoint],\n+          tsconfig: join(buildDir, 'tsconfig.lib.json'),\n+          out: outDir,\n+          excludePrivate: true,\n+          publicPath: '/docs/reference/devkit/',\n+        },\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'devkit'\n+      );\n+\n+      entries.push(...devkitDocs);\n+\n+      const devkitOverview = await createDevkitOverview(\n+        devkitDocs,\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'devkit'\n+      );\n+      entries.push(devkitOverview);\n+    }\n+\n+    // Load ngcli adapter\n+    const ngcliEntryPoint = join(\n+      workspaceRoot,\n+      'dist',\n+      'packages',\n+      'devkit',\n+      'ngcli-adapter.d.ts'\n+    );\n+    if (existsSync(ngcliEntryPoint)) {\n+      const ngcliDocs = await generateDocsForEntry(\n+        {\n+          ...defaultTypedocOptions,\n+          entryPoints: [ngcliEntryPoint],\n+          tsconfig: join(buildDir, 'tsconfig.lib.json'),\n+          out: join(outDir, 'ngcli_adapter'),\n+          publicPath: '/docs/reference/devkit/ngcli_adapter/',\n+        },\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'ngcli_adapter'\n+      );\n+\n+      entries.push(...ngcliDocs);\n+\n+      const ngcliOverview = await createDevkitOverview(\n+        ngcliDocs,\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'ngcli_adapter'\n+      );\n+      entries.push(ngcliOverview);\n+    }\n+\n+    logger.info('DevKit documentation loaded successfully');\n+    return entries;\n+  } catch (error: any) {\n+    logger.error(`Failed to load DevKit docs: ${error.message}`);\n+    return [];\n+  }\n+}\n+\n+async function generateDocsForEntry(\n+  options: Partial<TypeDocOptions> & { [key: string]: unknown },\n+  renderMarkdown: (content: string) => Promise<RenderedContent>,\n+  packageType: 'devkit' | 'ngcli_adapter'\n+): Promise<CollectionEntry<'nx-reference-packages'>[]> {\n+  const records: CollectionEntry<'nx-reference-packages'>[] = [];\n+  const app = await Application.bootstrapWithPlugins(\n+    options as Partial<TypeDocOptions>,\n+    [new TypeDocReader(), new PackageJsonReader(), new TSConfigReader()]\n+  );\n+\n+  app.renderer.defineTheme('nx-markdown-theme', NxMarkdownTheme);\n+\n+  const project = await app.convert();\n+  if (!project) {\n+    throw new Error('Failed to convert the project');\n+  }\n+\n+  const reflections = project.getReflectionsByKind(ReflectionKind.All);\n+\n+  for (const reflection of reflections) {\n+    if (\n+      !reflection.name ||\n+      reflection.flags.isPrivate ||\n+      !allowedReflections.includes(reflection.kind)\n+    ) {\n+      continue;\n+    }\n+\n+    const childReflections = reflections.filter(\n+      (r) => r.parent && r.parent.id === reflection.id\n+    );\n+    const { content, ...metadata } = formatDeclarationToMarkdown(\n+      reflection as DeclarationReflection,\n+      childReflections as DeclarationReflection[],\n+      packageType\n+    );",
    "repo_full_name": "nrwl/nx",
    "discussion_comments": [
      {
        "comment_id": "2308621684",
        "repo_full_name": "nrwl/nx",
        "pr_number": 32565,
        "pr_file": "astro-docs/src/plugins/utils/devkit-generation.ts",
        "discussion_id": "2308621684",
        "commented_code": "@@ -0,0 +1,228 @@\n+import { type CollectionEntry, type RenderedContent } from 'astro:content';\n+import {\n+  allowedReflections,\n+  categoryMap,\n+  setupTypeDoc,\n+} from './typedoc/setupTypeDoc';\n+import type { LoaderContext } from 'astro/loaders';\n+import { workspaceRoot } from '@nx/devkit';\n+import { join } from 'node:path';\n+import { existsSync } from 'node:fs';\n+import {\n+  Application,\n+  DeclarationReflection,\n+  PackageJsonReader,\n+  ReflectionKind,\n+  TSConfigReader,\n+  TypeDocReader,\n+  type TypeDocOptions,\n+} from 'typedoc';\n+import {\n+  formatDeclarationToMarkdown,\n+  formatComment,\n+} from './markdown-formatters';\n+import NxMarkdownTheme from './typedoc/theme';\n+\n+export async function loadDevkitPackage(\n+  context: LoaderContext\n+): Promise<CollectionEntry<'nx-reference-packages'>[]> {\n+  const { logger, renderMarkdown } = context;\n+  logger.info('Loading DevKit documentation');\n+\n+  try {\n+    const { defaultTypedocOptions, outDir, buildDir } = setupTypeDoc(logger);\n+    const entries: CollectionEntry<'nx-reference-packages'>[] = [];\n+\n+    // TODO: Caleb there seems to be a resolution error where this entrypoint will resolved types\n+    // from the node_modules/nx package and not the local workspace changes\n+    // see: DOC-188\n+    // Load main devkit\n+    const devkitEntryPoint = join(\n+      workspaceRoot,\n+      'dist',\n+      'packages',\n+      'devkit',\n+      'index.d.ts'\n+    );\n+    if (existsSync(devkitEntryPoint)) {\n+      const devkitDocs = await generateDocsForEntry(\n+        {\n+          ...defaultTypedocOptions,\n+          entryPoints: [devkitEntryPoint],\n+          tsconfig: join(buildDir, 'tsconfig.lib.json'),\n+          out: outDir,\n+          excludePrivate: true,\n+          publicPath: '/docs/reference/devkit/',\n+        },\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'devkit'\n+      );\n+\n+      entries.push(...devkitDocs);\n+\n+      const devkitOverview = await createDevkitOverview(\n+        devkitDocs,\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'devkit'\n+      );\n+      entries.push(devkitOverview);\n+    }\n+\n+    // Load ngcli adapter\n+    const ngcliEntryPoint = join(\n+      workspaceRoot,\n+      'dist',\n+      'packages',\n+      'devkit',\n+      'ngcli-adapter.d.ts'\n+    );\n+    if (existsSync(ngcliEntryPoint)) {\n+      const ngcliDocs = await generateDocsForEntry(\n+        {\n+          ...defaultTypedocOptions,\n+          entryPoints: [ngcliEntryPoint],\n+          tsconfig: join(buildDir, 'tsconfig.lib.json'),\n+          out: join(outDir, 'ngcli_adapter'),\n+          publicPath: '/docs/reference/devkit/ngcli_adapter/',\n+        },\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'ngcli_adapter'\n+      );\n+\n+      entries.push(...ngcliDocs);\n+\n+      const ngcliOverview = await createDevkitOverview(\n+        ngcliDocs,\n+        // @ts-expect-error - astro types are mismatched bc of auto generated location loading, etc\n+        renderMarkdown,\n+        'ngcli_adapter'\n+      );\n+      entries.push(ngcliOverview);\n+    }\n+\n+    logger.info('DevKit documentation loaded successfully');\n+    return entries;\n+  } catch (error: any) {\n+    logger.error(`Failed to load DevKit docs: ${error.message}`);\n+    return [];\n+  }\n+}\n+\n+async function generateDocsForEntry(\n+  options: Partial<TypeDocOptions> & { [key: string]: unknown },\n+  renderMarkdown: (content: string) => Promise<RenderedContent>,\n+  packageType: 'devkit' | 'ngcli_adapter'\n+): Promise<CollectionEntry<'nx-reference-packages'>[]> {\n+  const records: CollectionEntry<'nx-reference-packages'>[] = [];\n+  const app = await Application.bootstrapWithPlugins(\n+    options as Partial<TypeDocOptions>,\n+    [new TypeDocReader(), new PackageJsonReader(), new TSConfigReader()]\n+  );\n+\n+  app.renderer.defineTheme('nx-markdown-theme', NxMarkdownTheme);\n+\n+  const project = await app.convert();\n+  if (!project) {\n+    throw new Error('Failed to convert the project');\n+  }\n+\n+  const reflections = project.getReflectionsByKind(ReflectionKind.All);\n+\n+  for (const reflection of reflections) {\n+    if (\n+      !reflection.name ||\n+      reflection.flags.isPrivate ||\n+      !allowedReflections.includes(reflection.kind)\n+    ) {\n+      continue;\n+    }\n+\n+    const childReflections = reflections.filter(\n+      (r) => r.parent && r.parent.id === reflection.id\n+    );\n+    const { content, ...metadata } = formatDeclarationToMarkdown(\n+      reflection as DeclarationReflection,\n+      childReflections as DeclarationReflection[],\n+      packageType\n+    );",
        "comment_created_at": "2025-08-28T21:47:04+00:00",
        "comment_author": "barbados-clemens",
        "comment_body": "apparently `reflection.children` does not contain all the children. so we manually filter for them and pass them through. this is why some of the devkit pages were empty. ",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2114266298",
    "pr_number": 31043,
    "pr_file": "packages/eslint/src/generators/convert-to-flat-config/converters/json-converter.ts",
    "created_at": "2025-05-29T15:59:16+00:00",
    "commented_code": "if (tree.exists(ignorePath)) {\n       const patterns = tree\n         .read(ignorePath, 'utf-8')\n-        .split('\n')\n+        .split(EOL)",
    "repo_full_name": "nrwl/nx",
    "discussion_comments": [
      {
        "comment_id": "2114266298",
        "repo_full_name": "nrwl/nx",
        "pr_number": 31043,
        "pr_file": "packages/eslint/src/generators/convert-to-flat-config/converters/json-converter.ts",
        "discussion_id": "2114266298",
        "commented_code": "@@ -185,7 +186,7 @@ export function convertEslintJsonToFlatConfig(\n     if (tree.exists(ignorePath)) {\n       const patterns = tree\n         .read(ignorePath, 'utf-8')\n-        .split('\\n')\n+        .split(EOL)",
        "comment_created_at": "2025-05-29T15:59:16+00:00",
        "comment_author": "leosvelperez",
        "comment_body": "Files can have any line endings regardless of the OS in which they are read. They can even have different line endings on the same file. Instead, we should try to match the most common line endings:\r\n```suggestion\r\n        .split(/\\r\\n|\\r|\\n/)\r\n```\r\nThat Regex would match:\r\n- `\\r\\n` (CRLF - Windows)\r\n- `\\r` (CR - Classic Mac)\r\n- `\\n` (LF - Unix/Linux/modern macOS)",
        "pr_file_module": null
      },
      {
        "comment_id": "2115063854",
        "repo_full_name": "nrwl/nx",
        "pr_number": 31043,
        "pr_file": "packages/eslint/src/generators/convert-to-flat-config/converters/json-converter.ts",
        "discussion_id": "2114266298",
        "commented_code": "@@ -185,7 +186,7 @@ export function convertEslintJsonToFlatConfig(\n     if (tree.exists(ignorePath)) {\n       const patterns = tree\n         .read(ignorePath, 'utf-8')\n-        .split('\\n')\n+        .split(EOL)",
        "comment_created_at": "2025-05-30T03:05:35+00:00",
        "comment_author": "Teamop",
        "comment_body": "thanks, please review again.",
        "pr_file_module": null
      }
    ]
  }
]