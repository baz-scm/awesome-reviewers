[
  {
    "discussion_id": "2275332487",
    "pr_number": 1629,
    "pr_file": "packages/opencode/src/cli/cmd/github.ts",
    "created_at": "2025-08-14T04:28:36+00:00",
    "commented_code": "s.stop(\"Installed GitHub app\")\n \n         async function getInstallation() {\n-          return await fetch(`https://api.opencode.ai/get_github_app_installation?owner=${app.owner}&repo=${app.repo}`)\n-            .then((res) => res.json())\n-            .then((data) => data.installation)\n+          const tries = [\n+            app.repo, // First try with the original repo name\n+            app.repo.replace(/\\.git$/, \"\"), // If that fails, try without .git suffix",
    "repo_full_name": "sst/opencode",
    "discussion_comments": [
      {
        "comment_id": "2275332487",
        "repo_full_name": "sst/opencode",
        "pr_number": 1629,
        "pr_file": "packages/opencode/src/cli/cmd/github.ts",
        "discussion_id": "2275332487",
        "commented_code": "@@ -294,9 +294,20 @@ export const GithubInstallCommand = cmd({\n         s.stop(\"Installed GitHub app\")\n \n         async function getInstallation() {\n-          return await fetch(`https://api.opencode.ai/get_github_app_installation?owner=${app.owner}&repo=${app.repo}`)\n-            .then((res) => res.json())\n-            .then((data) => data.installation)\n+          const tries = [\n+            app.repo, // First try with the original repo name\n+            app.repo.replace(/\\.git$/, \"\"), // If that fails, try without .git suffix",
        "comment_created_at": "2025-08-14T04:28:36+00:00",
        "comment_author": "fwang",
        "comment_body": "is this required? the regex on line 192 should not include `.git` in repo?",
        "pr_file_module": null
      },
      {
        "comment_id": "2277994196",
        "repo_full_name": "sst/opencode",
        "pr_number": 1629,
        "pr_file": "packages/opencode/src/cli/cmd/github.ts",
        "discussion_id": "2275332487",
        "commented_code": "@@ -294,9 +294,20 @@ export const GithubInstallCommand = cmd({\n         s.stop(\"Installed GitHub app\")\n \n         async function getInstallation() {\n-          return await fetch(`https://api.opencode.ai/get_github_app_installation?owner=${app.owner}&repo=${app.repo}`)\n-            .then((res) => res.json())\n-            .then((data) => data.installation)\n+          const tries = [\n+            app.repo, // First try with the original repo name\n+            app.repo.replace(/\\.git$/, \"\"), // If that fails, try without .git suffix",
        "comment_created_at": "2025-08-15T00:23:19+00:00",
        "comment_author": "matheuslanduci",
        "comment_body": "I've removed the required .git in line 192 actually because you can clone without the .git in the end of the repo name\r\n<img width=\"940\" height=\"237\" alt=\"image\" src=\"https://github.com/user-attachments/assets/e7cdb42c-ffef-4bd5-8d83-0b8c6e655706\" />\r\n\r\nAnd this line (297-299) is because when you install the opencode app in GitHub (manually) it goes without .git in the end too\r\n\r\n<img width=\"1153\" height=\"172\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2af0c94b-4f81-4f7b-8c7c-e70d9df2fb74\" />\r\n\r\n",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2280455815",
    "pr_number": 1994,
    "pr_file": "packages/opencode/src/lsp/index.ts",
    "created_at": "2025-08-16T14:40:51+00:00",
    "commented_code": "\"lsp\",\n     async () => {\n       const clients: LSPClient.Info[] = []\n-      const servers: Record<string, LSPServer.Info> = LSPServer",
    "repo_full_name": "sst/opencode",
    "discussion_comments": [
      {
        "comment_id": "2280455815",
        "repo_full_name": "sst/opencode",
        "pr_number": 1994,
        "pr_file": "packages/opencode/src/lsp/index.ts",
        "discussion_id": "2280455815",
        "commented_code": "@@ -57,11 +57,15 @@ export namespace LSP {\n     \"lsp\",\n     async () => {\n       const clients: LSPClient.Info[] = []\n-      const servers: Record<string, LSPServer.Info> = LSPServer",
        "comment_created_at": "2025-08-16T14:40:51+00:00",
        "comment_author": "rekram1-node",
        "comment_body": "this was the primary culprit, it also behaves counter to the documentation: https://opencode.ai/docs/lsp/#disabling-lsp-servers\r\n\r\nInstead of the server being \"typescript\" it was titled \"Typescript\" as per the export, figured it would be better to change to server ids instead for consitency w/ docs",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2162270580",
    "pr_number": 313,
    "pr_file": "packages/opencode/src/app/app.ts",
    "created_at": "2025-06-23T18:27:10+00:00",
    "commented_code": ")\n   }\n }\n+\n+function projectDirectoryName(path: string): string {\n+  // Prefix prevents collision with \"global\" and with magic file names like \"NIL\" on Windows.\n+  // TODO: Hash the path to prevent collisions.\n+  return \"_\" + path.replace(/[^A-Za-z0-9_]/g, \"-\")",
    "repo_full_name": "sst/opencode",
    "discussion_comments": [
      {
        "comment_id": "2162270580",
        "repo_full_name": "sst/opencode",
        "pr_number": 313,
        "pr_file": "packages/opencode/src/app/app.ts",
        "discussion_id": "2162270580",
        "commented_code": "@@ -134,3 +134,9 @@ export namespace App {\n     )\n   }\n }\n+\n+function projectDirectoryName(path: string): string {\n+  // Prefix prevents collision with \"global\" and with magic file names like \"NIL\" on Windows.\n+  // TODO: Hash the path to prevent collisions.\n+  return \"_\" + path.replace(/[^A-Za-z0-9_]/g, \"-\")",
        "comment_created_at": "2025-06-23T18:27:10+00:00",
        "comment_author": "thdxr",
        "comment_body": "can you explain a bit more here the issue on windows? we don't want to add a `_` to all platforms\r\n\r\nthere's also a separate bug where it shouldn't start with `-` ",
        "pr_file_module": null
      },
      {
        "comment_id": "2162694013",
        "repo_full_name": "sst/opencode",
        "pr_number": 313,
        "pr_file": "packages/opencode/src/app/app.ts",
        "discussion_id": "2162270580",
        "commented_code": "@@ -134,3 +134,9 @@ export namespace App {\n     )\n   }\n }\n+\n+function projectDirectoryName(path: string): string {\n+  // Prefix prevents collision with \"global\" and with magic file names like \"NIL\" on Windows.\n+  // TODO: Hash the path to prevent collisions.\n+  return \"_\" + path.replace(/[^A-Za-z0-9_]/g, \"-\")",
        "comment_created_at": "2025-06-23T23:43:13+00:00",
        "comment_author": "thdxr",
        "comment_body": "we fixed that seperate bug so there's a conflict now. but basically the folders will look like `home-thdxr-projects-foo`\r\n\r\nwe also don't want to do a hash so they're somewhat human readable - lmk",
        "pr_file_module": null
      },
      {
        "comment_id": "2162928752",
        "repo_full_name": "sst/opencode",
        "pr_number": 313,
        "pr_file": "packages/opencode/src/app/app.ts",
        "discussion_id": "2162270580",
        "commented_code": "@@ -134,3 +134,9 @@ export namespace App {\n     )\n   }\n }\n+\n+function projectDirectoryName(path: string): string {\n+  // Prefix prevents collision with \"global\" and with magic file names like \"NIL\" on Windows.\n+  // TODO: Hash the path to prevent collisions.\n+  return \"_\" + path.replace(/[^A-Za-z0-9_]/g, \"-\")",
        "comment_created_at": "2025-06-24T04:21:36+00:00",
        "comment_author": "strager",
        "comment_body": "> can you explain a bit more here the issue on windows? we don't want to add a `_` to all platforms\r\n\r\n`:` is not valid in ~~path~~ file/directory names, but `path` is `\"C:\\foo\\bar\\baz\"`. Instead of playing whackamole with bad characters (`\\`, `/`, `:`), I decided to implement a whitelist.\r\n\r\n> we also don't want to do a hash so they're somewhat human readable - lmk\r\n\r\nI wasn't thinking of replacing the whole path with a hash, but rather appending a hash to disambiguate. But it's just a comment for a future feature; I can drop it.",
        "pr_file_module": null
      },
      {
        "comment_id": "2163820318",
        "repo_full_name": "sst/opencode",
        "pr_number": 313,
        "pr_file": "packages/opencode/src/app/app.ts",
        "discussion_id": "2162270580",
        "commented_code": "@@ -134,3 +134,9 @@ export namespace App {\n     )\n   }\n }\n+\n+function projectDirectoryName(path: string): string {\n+  // Prefix prevents collision with \"global\" and with magic file names like \"NIL\" on Windows.\n+  // TODO: Hash the path to prevent collisions.\n+  return \"_\" + path.replace(/[^A-Za-z0-9_]/g, \"-\")",
        "comment_created_at": "2025-06-24T12:15:38+00:00",
        "comment_author": "thdxr",
        "comment_body": "ah i see. ok will merge today",
        "pr_file_module": null
      }
    ]
  }
]