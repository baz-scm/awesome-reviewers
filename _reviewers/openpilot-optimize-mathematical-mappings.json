[
  {
    "discussion_id": "2246278195",
    "pr_number": 35858,
    "pr_file": "selfdrive/pandad/pandad.cc",
    "created_at": "2025-07-31T20:06:17+00:00",
    "commented_code": "if (ir_pwr != prev_ir_pwr || sm.frame % 100 == 0 || ir_pwr >= 50.0) {\n       panda->set_ir_pwr(ir_pwr);\n-      Hardware::set_ir_power(ir_pwr);\n+      int ir_percent = util::map_val(static_cast<int>(ir_pwr), 0, static_cast<int>(100*MAX_IR_POWER), 0, 100);",
    "repo_full_name": "commaai/openpilot",
    "discussion_comments": [
      {
        "comment_id": "2246278195",
        "repo_full_name": "commaai/openpilot",
        "pr_number": 35858,
        "pr_file": "selfdrive/pandad/pandad.cc",
        "discussion_id": "2246278195",
        "commented_code": "@@ -410,7 +410,8 @@ void process_peripheral_state(Panda *panda, PubMaster *pm, bool no_fan_control)\n \n     if (ir_pwr != prev_ir_pwr || sm.frame % 100 == 0 || ir_pwr >= 50.0) {\n       panda->set_ir_pwr(ir_pwr);\n-      Hardware::set_ir_power(ir_pwr);\n+      int ir_percent = util::map_val(static_cast<int>(ir_pwr), 0, static_cast<int>(100*MAX_IR_POWER), 0, 100); ",
        "comment_created_at": "2025-07-31T20:06:17+00:00",
        "comment_author": "adeebshihadeh",
        "comment_body": "probably makes sense to rewrite all the math to use percent, then remap for the other one?",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1893241290",
    "pr_number": 34293,
    "pr_file": "system/hardware/tici/hardware.h",
    "created_at": "2024-12-19T23:03:48+00:00",
    "commented_code": "return;\n     }\n \n-    percent = std::clamp(percent, 0, 100);\n+    int value = util::map_val(std::clamp(percent, 0, 100), 0, 100, 0, 255)",
    "repo_full_name": "commaai/openpilot",
    "discussion_comments": [
      {
        "comment_id": "1893241290",
        "repo_full_name": "commaai/openpilot",
        "pr_number": 34293,
        "pr_file": "system/hardware/tici/hardware.h",
        "discussion_id": "1893241290",
        "commented_code": "@@ -82,17 +82,17 @@ class HardwareTici : public HardwareNone {\n       return;\n     }\n \n-    percent = std::clamp(percent, 0, 100);\n+    int value = util::map_val(std::clamp(percent, 0, 100), 0, 100, 0, 255)",
        "comment_created_at": "2024-12-19T23:03:48+00:00",
        "comment_author": "adeebshihadeh",
        "comment_body": "```suggestion\r\n    int value = util::map_val(std::clamp(percent, 0, 100), 0, 100, 0, 255);\r\n```",
        "pr_file_module": null
      }
    ]
  }
]