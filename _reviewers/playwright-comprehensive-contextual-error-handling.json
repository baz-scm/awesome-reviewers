[
  {
    "discussion_id": "2157338406",
    "pr_number": 36358,
    "pr_file": "packages/playwright-core/bin/webkit-wsl-pipe-wrapper.mjs",
    "created_at": "2025-06-19T16:05:15+00:00",
    "commented_code": "+import net from 'net';\n+import { spawn } from 'child_process';\n+\n+const socketAddress = process.env.SOCKET_ADDRESS;\n+\n+if (!socketAddress)\n+    throw new Error('SOCKET_ADDRESS is not set');\n+\n+const socket = net.createConnection(socketAddress, '127.0.0.1');\n+socket.on('error', (error) => console.log('socket error from wrapper', error));\n+\n+await new Promise((resolve, reject) => {\n+    socket.on('connect', resolve);\n+    socket.on('error', reject);\n+});\n+\n+const [executable, ...args] = process.argv.slice(2);",
    "repo_full_name": "microsoft/playwright",
    "discussion_comments": [
      {
        "comment_id": "2157338406",
        "repo_full_name": "microsoft/playwright",
        "pr_number": 36358,
        "pr_file": "packages/playwright-core/bin/webkit-wsl-pipe-wrapper.mjs",
        "discussion_id": "2157338406",
        "commented_code": "@@ -0,0 +1,40 @@\n+import net from 'net';\n+import { spawn } from 'child_process';\n+\n+const socketAddress = process.env.SOCKET_ADDRESS;\n+\n+if (!socketAddress)\n+    throw new Error('SOCKET_ADDRESS is not set');\n+\n+const socket = net.createConnection(socketAddress, '127.0.0.1');\n+socket.on('error', (error) => console.log('socket error from wrapper', error));\n+\n+await new Promise((resolve, reject) => {\n+    socket.on('connect', resolve);\n+    socket.on('error', reject);\n+});\n+\n+const [executable, ...args] = process.argv.slice(2);",
        "comment_created_at": "2025-06-19T16:05:15+00:00",
        "comment_author": "agg23",
        "comment_body": "Even though this is run by us, this should have proper error handling.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2281891813",
    "pr_number": 36358,
    "pr_file": "packages/playwright-core/bin/webkit-wsl-transport-client.mjs",
    "created_at": "2025-08-18T09:49:38+00:00",
    "commented_code": "+// @ts-check\n+import net from 'net';\n+import fs from 'fs';\n+import { spawn, spawnSync } from 'child_process';\n+\n+const socketPort = process.env.PW_WKWSL_PORT;\n+delete process.env.PW_WKWSL_PORT;\n+if (!socketPort)\n+    throw new Error('PW_WKWSL_PORT env var is not set');\n+\n+const [executable, ...args] = process.argv.slice(2);\n+\n+if (!(await fs.promises.stat(executable)).isFile())\n+    throw new Error(`Executable does not exist. Did you update Playwright recently? Make sure to run npx playwright install webkit-wsl`);",
    "repo_full_name": "microsoft/playwright",
    "discussion_comments": [
      {
        "comment_id": "2281891813",
        "repo_full_name": "microsoft/playwright",
        "pr_number": 36358,
        "pr_file": "packages/playwright-core/bin/webkit-wsl-transport-client.mjs",
        "discussion_id": "2281891813",
        "commented_code": "@@ -0,0 +1,59 @@\n+// @ts-check\n+import net from 'net';\n+import fs from 'fs';\n+import { spawn, spawnSync } from 'child_process';\n+\n+const socketPort = process.env.PW_WKWSL_PORT;\n+delete process.env.PW_WKWSL_PORT;\n+if (!socketPort)\n+    throw new Error('PW_WKWSL_PORT env var is not set');\n+\n+const [executable, ...args] = process.argv.slice(2);\n+\n+if (!(await fs.promises.stat(executable)).isFile())\n+    throw new Error(`Executable does not exist. Did you update Playwright recently? Make sure to run npx playwright install webkit-wsl`);",
        "comment_created_at": "2025-08-18T09:49:38+00:00",
        "comment_author": "Skn0tt",
        "comment_body": "Hmm, can we throw the exact error somewhere in a parent? We try to detect the package manager, so `npx` isn't necessarily accurate.",
        "pr_file_module": null
      }
    ]
  }
]