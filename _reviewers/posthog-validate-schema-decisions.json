[
  {
    "discussion_id": "2231080506",
    "pr_number": 35636,
    "pr_file": "plugin-server/cassandra/migrations/003_person_event_occurrences.cql",
    "created_at": "2025-07-25T13:25:28+00:00",
    "commented_code": "+-- Migration: Create person event occurrences table\n+-- Created: 2025-07-25\n+-- Description: Table to track whether a person has performed a specific event\n+-- Optimized for occurrence tracking (set semantics) with efficient queries by person_id and event_name\n+\n+-- Create the person event occurrences table\n+-- This table stores occurrences with the pattern:\n+-- team_id:person_id:event_name\n+-- If a record exists, the event occurred\n+CREATE TABLE IF NOT EXISTS person_event_occurrences (\n+    team_id INT,",
    "repo_full_name": "PostHog/posthog",
    "discussion_comments": [
      {
        "comment_id": "2231080506",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 35636,
        "pr_file": "plugin-server/cassandra/migrations/003_person_event_occurrences.cql",
        "discussion_id": "2231080506",
        "commented_code": "@@ -0,0 +1,24 @@\n+-- Migration: Create person event occurrences table\n+-- Created: 2025-07-25\n+-- Description: Table to track whether a person has performed a specific event\n+-- Optimized for occurrence tracking (set semantics) with efficient queries by person_id and event_name\n+\n+-- Create the person event occurrences table\n+-- This table stores occurrences with the pattern:\n+-- team_id:person_id:event_name\n+-- If a record exists, the event occurred\n+CREATE TABLE IF NOT EXISTS person_event_occurrences (\n+    team_id INT,",
        "comment_created_at": "2025-07-25T13:25:28+00:00",
        "comment_author": "meikelmosby",
        "comment_body": "question here is if personId and eventName is enough or do we _want_ to also have the teamId? ",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2254181438",
    "pr_number": 36191,
    "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
    "created_at": "2025-08-05T12:21:45+00:00",
    "commented_code": "\"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
    "repo_full_name": "PostHog/posthog",
    "discussion_comments": [
      {
        "comment_id": "2254181438",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 36191,
        "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
        "discussion_id": "2254181438",
        "commented_code": "@@ -11030,7 +11030,7 @@ exports[`segment templates template segment-actions-hyperengage matches expected\n           \"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
        "comment_created_at": "2025-08-05T12:21:45+00:00",
        "comment_author": "benjackwhite",
        "comment_body": "Are you sure thats the right property? Groups aren't specified that way...",
        "pr_file_module": null
      },
      {
        "comment_id": "2254256348",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 36191,
        "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
        "discussion_id": "2254181438",
        "commented_code": "@@ -11030,7 +11030,7 @@ exports[`segment templates template segment-actions-hyperengage matches expected\n           \"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
        "comment_created_at": "2025-08-05T12:53:00+00:00",
        "comment_author": "MarconLP",
        "comment_body": "I assume you are referring to `event.context.group_id`. Adding a step to filter that property out entirely.",
        "pr_file_module": null
      },
      {
        "comment_id": "2254278237",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 36191,
        "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
        "discussion_id": "2254181438",
        "commented_code": "@@ -11030,7 +11030,7 @@ exports[`segment templates template segment-actions-hyperengage matches expected\n           \"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
        "comment_created_at": "2025-08-05T13:01:45+00:00",
        "comment_author": "benjackwhite",
        "comment_body": "No I mean that groups are done like `$groups: { key: value }` in events i thought?",
        "pr_file_module": null
      },
      {
        "comment_id": "2254299070",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 36191,
        "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
        "discussion_id": "2254181438",
        "commented_code": "@@ -11030,7 +11030,7 @@ exports[`segment templates template segment-actions-hyperengage matches expected\n           \"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
        "comment_created_at": "2025-08-05T13:09:30+00:00",
        "comment_author": "MarconLP",
        "comment_body": "We do both, but you don't need to know the group key to use `$group_0`\r\n<img width=\"1125\" height=\"375\" alt=\"2025-08-05 at 15 07 28\" src=\"https://github.com/user-attachments/assets/72f3e304-9d64-431d-9fd3-65516395c368\" />\r\n\r\nhttps://us.posthog.com/project/35787/events/01986539-81fc-72be-b42d-e3763c76a220/2025-08-01T12%3A42%3A04.795000%2B02%3A00\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "2254382617",
        "repo_full_name": "PostHog/posthog",
        "pr_number": 36191,
        "pr_file": "plugin-server/src/cdp/segment/__snapshots__/segment-templates.test.ts.snap",
        "discussion_id": "2254181438",
        "commented_code": "@@ -11030,7 +11030,7 @@ exports[`segment templates template segment-actions-hyperengage matches expected\n           \"type\": \"string\",\n         },\n         {\n-          \"default\": \"{event.context.group_id ?? event.groupId}\",\n+          \"default\": \"{event.context.group_id ?? event.properties.$group_0}\",",
        "comment_created_at": "2025-08-05T13:39:39+00:00",
        "comment_author": "benjackwhite",
        "comment_body": "But now the user needs to know the group number right? It just feels like a weird. I think I get why its this way because we dont know the group key upfront but its more confusing for user inputting values \ud83e\udd14 ",
        "pr_file_module": null
      }
    ]
  }
]