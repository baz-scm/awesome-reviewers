[
  {
    "discussion_id": "1943450153",
    "pr_number": 6195,
    "pr_file": "docs/tutorials/microsoft365/authentication.md",
    "created_at": "2025-02-05T18:18:35+00:00",
    "commented_code": "+# Microsoft365 authentication\n+\n+By default Prowler uses MsGraph Python SDK identity package authentication methods using the class `ClientSecretCredential`.\n+This allows Prowler to authenticate against microsoft365 using the service principal authentication by environment variables (Enterprise Application)\n+\n+To launch the tool first you need to set up the environment variables and then use:\n+\n+```console\n+prowler microsoft365\n+```\n+",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "1943450153",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 6195,
        "pr_file": "docs/tutorials/microsoft365/authentication.md",
        "discussion_id": "1943450153",
        "commented_code": "@@ -0,0 +1,12 @@\n+# Microsoft365 authentication\n+\n+By default Prowler uses MsGraph Python SDK identity package authentication methods using the class `ClientSecretCredential`.\n+This allows Prowler to authenticate against microsoft365 using the service principal authentication by environment variables (Enterprise Application)\n+\n+To launch the tool first you need to set up the environment variables and then use:\n+\n+```console\n+prowler microsoft365\n+```\n+",
        "comment_created_at": "2025-02-05T18:18:35+00:00",
        "comment_author": "danibarranqueroo",
        "comment_body": "```suggestion\r\nThis allows Prowler to authenticate against microsoft365 using the following methods:\r\n\r\n- Service principal authentication by environment variables (Enterprise Application)\r\n- Current CLI credentials stored\r\n- Interactive browser authentication\r\n\r\nTo launch the tool first you need to specify which method is used through the following flags:\r\n\r\n```console\r\n# To use service principal authentication\r\nprowler microsoft365 --sp-env-auth\r\n\r\n# To use cli authentication\r\nprowler microsoft365 --az-cli-auth\r\n\r\n# To use browser authentication\r\nprowler microsoft365 --browser-auth --tenant-id \"XXXXXXXX\"\r\n```\r\n\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2068268982",
    "pr_number": 7622,
    "pr_file": "docs/getting-started/requirements.md",
    "created_at": "2025-04-30T09:27:04+00:00",
    "commented_code": "export M365_ENCRYPTED_PASSWORD=\"6500780061006d0070006c006500700061007300730077006f0072006400\" # replace this to yours\n ```\n \n-These two new environment variables are required to execute the PowerShell modules needed to retrieve information from M365 services. Prowler will use service principal authentication to log into MS Graph and user credentials to authenticate to Microsoft PowerShell modules.\n+These two new environment variables are **required** to execute the PowerShell modules needed to retrieve information from M365 services. Prowler uses Service Principal authentication to access Microsoft Graph and user credentials to authenticate to Microsoft PowerShell modules.\n+\n+- `M365_USER` should be your Microsoft account email using the default domain. This means it must look like `example@YourCompany.onmicrosoft.com`.\n+\n+    To ensure that you are using the default domain you can see how to verify it [here](../tutorials/microsoft365/getting-started-m365.md#step-1-obtain-your-domain).\n+\n+    If you don't have a user created with that domain, Prowler will not work (because the default domain cannot be deleted, guaranteeing availability). To proceed, you can either create a new user with that domain or modify the domain of an existing user.\n+\n+    ![User Domains](../tutorials/microsoft365/img/user-domains.png)\n+\n+- `M365_ENCRYPTED_PASSWORD` must be an encrypted SecureString. To convert your password into a valid encrypted string, you need to use PowerShell.\n+\n+    ???+ warning\n+        Passwords encrypted using ConvertTo-SecureString can only be decrypted on the same OS/user context. If you generate an encrypted password on macOS or Linux (both UNIX), it may fail on Windows and vice versa. As Prowler Cloud runs on UNIX if you generate your password using Windows it won't work so you'll need to generate a new password using any UNIX distro (example above)\n+\n+    If you are working from Windows and you will use your encrypted password in a different system (like for example executing Prowler in macOS or adding your password to Prowler Cloud), you will need to generate a \"UNIX compatible\" version of your encrypted password, this can be done using WSL which is so easy to install on Windows.\n+\n+    === \"UNIX\"\n+\n+        Open a PowerShell cmd with a [supported version](requirements.md#supported-powershell-versions) and then run the following command:\n+\n+        ```console\n+        $securePassword = ConvertTo-SecureString \"examplepassword\" -AsPlainText -Force\n+        $encryptedPassword = $securePassword | ConvertFrom-SecureString\n+        Write-Output $encryptedPassword\n+        6500780061006d0070006c006500700061007300730077006f0072006400\n+        ```\n+\n+        If everything is done correctly, you will see the encrypted string that you need to set as the `M365_ENCRYPTED_PASSWORD` environment variable.\n+\n+    === \"Windows\"\n \n-The `M365_USER` should be your Microsoft account email, and `M365_ENCRYPTED_PASSWORD` must be an encrypted SecureString.\n-To convert your password into a valid encrypted string, run the following commands in PowerShell:\n+\n+        How to install WSL and PowerShell on it to generate that password (you can use a different distro but this one will work for sure):\n+\n+        ```console\n+        wsl --install -d Ubuntu-22.04\n+        ```\n+\n+        Then, open the Ubuntu terminal and run the following commands:\n+\n+        ```console\n+        sudo apt update && sudo apt install -y wget apt-transport-https software-properties-common\n+        wget -q \"https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb\"\n+        sudo dpkg -i packages-microsoft-prod.deb\n+        sudo apt update\n+        sudo apt install -y powershell\n+        pwsh\n+        ```\n+\n+        With this done you will see now that a prompt running PowerShell with the latest version is open so here you will be able to generate your encrypted password:\n+\n+        ```console\n+        $securePassword = ConvertTo-SecureString \"examplepassword\" -AsPlainText -Force\n+        $encryptedPassword = $securePassword | ConvertFrom-SecureString\n+        Write-Output $encryptedPassword\n+        6500780061006d0070006c006500700061007300730077006f0072006400\n+        ```\n+\n+        If everything is done correctly, you will see the encrypted string that you need to set as the `M365_ENCRYPTED_PASSWORD` environment variable.\n+\n+\n+\n+### Interactive Browser authentication\n+\n+Authentication flag: `--browser-auth`\n+\n+This authentication method requires the user to authenticate against Azure using the default browser to start the scan, also `--tenant-id` flag is required.\n+\n+With this credentials you will only be able to run the checks that work through MS Graph, this means that you won't run all the provider. If you want to scan all the checks from M365 you will need to use the recommended authentication method.",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2068268982",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7622,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2068268982",
        "commented_code": "@@ -161,26 +163,304 @@ export M365_USER=\"your_email@example.com\"\n export M365_ENCRYPTED_PASSWORD=\"6500780061006d0070006c006500700061007300730077006f0072006400\" # replace this to yours\n ```\n \n-These two new environment variables are required to execute the PowerShell modules needed to retrieve information from M365 services. Prowler will use service principal authentication to log into MS Graph and user credentials to authenticate to Microsoft PowerShell modules.\n+These two new environment variables are **required** to execute the PowerShell modules needed to retrieve information from M365 services. Prowler uses Service Principal authentication to access Microsoft Graph and user credentials to authenticate to Microsoft PowerShell modules.\n+\n+- `M365_USER` should be your Microsoft account email using the default domain. This means it must look like `example@YourCompany.onmicrosoft.com`.\n+\n+    To ensure that you are using the default domain you can see how to verify it [here](../tutorials/microsoft365/getting-started-m365.md#step-1-obtain-your-domain).\n+\n+    If you don't have a user created with that domain, Prowler will not work (because the default domain cannot be deleted, guaranteeing availability). To proceed, you can either create a new user with that domain or modify the domain of an existing user.\n+\n+    ![User Domains](../tutorials/microsoft365/img/user-domains.png)\n+\n+- `M365_ENCRYPTED_PASSWORD` must be an encrypted SecureString. To convert your password into a valid encrypted string, you need to use PowerShell.\n+\n+    ???+ warning\n+        Passwords encrypted using ConvertTo-SecureString can only be decrypted on the same OS/user context. If you generate an encrypted password on macOS or Linux (both UNIX), it may fail on Windows and vice versa. As Prowler Cloud runs on UNIX if you generate your password using Windows it won't work so you'll need to generate a new password using any UNIX distro (example above)\n+\n+    If you are working from Windows and you will use your encrypted password in a different system (like for example executing Prowler in macOS or adding your password to Prowler Cloud), you will need to generate a \"UNIX compatible\" version of your encrypted password, this can be done using WSL which is so easy to install on Windows.\n+\n+    === \"UNIX\"\n+\n+        Open a PowerShell cmd with a [supported version](requirements.md#supported-powershell-versions) and then run the following command:\n+\n+        ```console\n+        $securePassword = ConvertTo-SecureString \"examplepassword\" -AsPlainText -Force\n+        $encryptedPassword = $securePassword | ConvertFrom-SecureString\n+        Write-Output $encryptedPassword\n+        6500780061006d0070006c006500700061007300730077006f0072006400\n+        ```\n+\n+        If everything is done correctly, you will see the encrypted string that you need to set as the `M365_ENCRYPTED_PASSWORD` environment variable.\n+\n+    === \"Windows\"\n \n-The `M365_USER` should be your Microsoft account email, and `M365_ENCRYPTED_PASSWORD` must be an encrypted SecureString.\n-To convert your password into a valid encrypted string, run the following commands in PowerShell:\n+\n+        How to install WSL and PowerShell on it to generate that password (you can use a different distro but this one will work for sure):\n+\n+        ```console\n+        wsl --install -d Ubuntu-22.04\n+        ```\n+\n+        Then, open the Ubuntu terminal and run the following commands:\n+\n+        ```console\n+        sudo apt update && sudo apt install -y wget apt-transport-https software-properties-common\n+        wget -q \"https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb\"\n+        sudo dpkg -i packages-microsoft-prod.deb\n+        sudo apt update\n+        sudo apt install -y powershell\n+        pwsh\n+        ```\n+\n+        With this done you will see now that a prompt running PowerShell with the latest version is open so here you will be able to generate your encrypted password:\n+\n+        ```console\n+        $securePassword = ConvertTo-SecureString \"examplepassword\" -AsPlainText -Force\n+        $encryptedPassword = $securePassword | ConvertFrom-SecureString\n+        Write-Output $encryptedPassword\n+        6500780061006d0070006c006500700061007300730077006f0072006400\n+        ```\n+\n+        If everything is done correctly, you will see the encrypted string that you need to set as the `M365_ENCRYPTED_PASSWORD` environment variable.\n+\n+\n+\n+### Interactive Browser authentication\n+\n+Authentication flag: `--browser-auth`\n+\n+This authentication method requires the user to authenticate against Azure using the default browser to start the scan, also `--tenant-id` flag is required.\n+\n+With this credentials you will only be able to run the checks that work through MS Graph, this means that you won't run all the provider. If you want to scan all the checks from M365 you will need to use the recommended authentication method.",
        "comment_created_at": "2025-04-30T09:27:04+00:00",
        "comment_author": "HugoPBrito",
        "comment_body": "```suggestion\r\nWith this credentials you will only be able to run the checks that work through MS Graph, this means that you won't run all the provider. If you want to scan all the checks from M365 you will need to use the recommended authentication method.\r\n\r\nSince this is a delegated permission authentication method, necessary permissions should be given to the user, not the app.\r\n```",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2042469192",
    "pr_number": 7488,
    "pr_file": "docs/getting-started/requirements.md",
    "created_at": "2025-04-14T16:09:28+00:00",
    "commented_code": "2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2042469192",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-14T16:09:28+00:00",
        "comment_author": "MrCloudSec",
        "comment_body": "Is not this API enabled by default when you use the IAM service for the first time in the console?",
        "pr_file_module": null
      },
      {
        "comment_id": "2042489018",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-14T16:22:39+00:00",
        "comment_author": "bgdanix",
        "comment_body": "No, it's not. You can still grant IAM as it uses the [Resource Manager API](https://cloud.google.com/resource-manager/reference/rest/v1beta1/projects/setIamPolicy).",
        "pr_file_module": null
      },
      {
        "comment_id": "2042948975",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-14T21:15:31+00:00",
        "comment_author": "MrCloudSec",
        "comment_body": "I meant if you use the service as a project owner for the first time.",
        "pr_file_module": null
      },
      {
        "comment_id": "2043816716",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-15T07:12:30+00:00",
        "comment_author": "bgdanix",
        "comment_body": "No, not even in this case (I've checked on a new Google Account and project and also on a new project as part of an org). Furthermore, most of the times you're not granted such highly permissive role for doing a security review across the org.",
        "pr_file_module": null
      },
      {
        "comment_id": "2044576576",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-15T13:42:04+00:00",
        "comment_author": "MrCloudSec",
        "comment_body": "I am not talking about the role but about the IAM API in the project level settings.",
        "pr_file_module": null
      },
      {
        "comment_id": "2044590511",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469192",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the",
        "comment_created_at": "2025-04-15T13:48:42+00:00",
        "comment_author": "bgdanix",
        "comment_body": "Yes, I got that. If you go to the [IAM API](https://console.cloud.google.com/apis/library/iam.googleapis.com) on a new project you'll see it's not enabled.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2042469514",
    "pr_number": 7488,
    "pr_file": "docs/getting-started/requirements.md",
    "created_at": "2025-04-14T16:09:41+00:00",
    "commented_code": "2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the\n+    [Google Cloud API UI](https://console.cloud.google.com/apis/api/iam.googleapis.com/metrics) or\n+    by using the gcloud CLI `gcloud services enable iam.googleapis.com --project <your-project-id>` command\n+    - Service Usage Consumer (`roles/serviceusage.serviceUsageConsumer`) IAM role\n+    - Set the quota project to be this project by either running `gcloud auth application-default set-quota-project <project-id>` or by setting an environment variable:",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2042469514",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469514",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the\n+    [Google Cloud API UI](https://console.cloud.google.com/apis/api/iam.googleapis.com/metrics) or\n+    by using the gcloud CLI `gcloud services enable iam.googleapis.com --project <your-project-id>` command\n+    - Service Usage Consumer (`roles/serviceusage.serviceUsageConsumer`) IAM role\n+    - Set the quota project to be this project by either running `gcloud auth application-default set-quota-project <project-id>` or by setting an environment variable:",
        "comment_created_at": "2025-04-14T16:09:41+00:00",
        "comment_author": "MrCloudSec",
        "comment_body": "Why is the quota project needed?",
        "pr_file_module": null
      },
      {
        "comment_id": "2042494715",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7488,
        "pr_file": "docs/getting-started/requirements.md",
        "discussion_id": "2042469514",
        "commented_code": "@@ -98,7 +98,23 @@ Prowler will follow the same credentials search as [Google authentication librar\n 2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)\n 3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)\n \n-Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the `Viewer` role to the member associated with the credentials.\n+### Needed permissions\n+\n+Prowler for Google Cloud needs the following permissions to be set:\n+\n+- **Viewer (`roles/viewer`) IAM role**: granted at the project / folder / org level in order to scan the target projects\n+\n+- **Project level settings**: you need to have at least one project with the below settings:\n+    - Identity and Access Management (IAM) API (`iam.googleapis.com`) enabled by either using the\n+    [Google Cloud API UI](https://console.cloud.google.com/apis/api/iam.googleapis.com/metrics) or\n+    by using the gcloud CLI `gcloud services enable iam.googleapis.com --project <your-project-id>` command\n+    - Service Usage Consumer (`roles/serviceusage.serviceUsageConsumer`) IAM role\n+    - Set the quota project to be this project by either running `gcloud auth application-default set-quota-project <project-id>` or by setting an environment variable:",
        "comment_created_at": "2025-04-14T16:26:41+00:00",
        "comment_author": "bgdanix",
        "comment_body": "Quota project is needed in order for the Google to bill against for all the API calls made (through Prowler in this case). You can test both comments you had by targeting a scan on a completely new project with an identity (better a new temp account) which only has viewer access and running prowler CLI in debug mode.",
        "pr_file_module": null
      }
    ]
  }
]