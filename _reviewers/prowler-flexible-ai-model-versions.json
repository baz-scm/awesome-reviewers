[
  {
    "discussion_id": "2120790136",
    "pr_number": 7848,
    "pr_file": "api/src/backend/api/models.py",
    "created_at": "2025-06-02T10:53:38+00:00",
    "commented_code": "statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2120790136",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120790136",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
        "comment_created_at": "2025-06-02T10:53:38+00:00",
        "comment_author": "vicferpoy",
        "comment_body": "This requires its own Postgres enum. Check `db_utils.py` for reference.",
        "pr_file_module": null
      },
      {
        "comment_id": "2120913217",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120790136",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
        "comment_created_at": "2025-06-02T11:49:42+00:00",
        "comment_author": "AdriiiPRodri",
        "comment_body": "Hmm, I’m not sure, postgres enums aren’t easy to modify, and OpenAI keeps releasing new models, so if we hardcode this in the code or in Postgres, we’ll need to deploy a new version every time a new model comes out. I think this should go in the `.env` file instead",
        "pr_file_module": null
      },
      {
        "comment_id": "2120929651",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120790136",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
        "comment_created_at": "2025-06-02T11:56:02+00:00",
        "comment_author": "vicferpoy",
        "comment_body": "Okay, fair. But in any case, this should be used for a ChoicesField, not a Char.",
        "pr_file_module": null
      },
      {
        "comment_id": "2120959214",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120790136",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
        "comment_created_at": "2025-06-02T12:10:35+00:00",
        "comment_author": "Chan9390",
        "comment_body": "We wont support all the models from OpenAI. Rather allow user to select from a list of models that we have vetted beforehand and recommend. While there is one model we highly recommend (gpt-4o in this case) there can be other models added here for experimental or cost reduction purposes.\r\n\r\n@AdriiiPRodri Let's say we have a new model that we test and will integrate to future version, say 5.10, we can be confident that new LLM model will work with 5.10 only. We cant backport and test every supported Prowler version with new LLM model. So, what do we do? Hardcode (as own Postgres enum) or move it to .env file?",
        "pr_file_module": null
      },
      {
        "comment_id": "2128629426",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120790136",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]",
        "comment_created_at": "2025-06-05T11:37:03+00:00",
        "comment_author": "Chan9390",
        "comment_body": "Moved this to Django enum (not Postgres).",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2120791559",
    "pr_number": 7848,
    "pr_file": "api/src/backend/api/models.py",
    "created_at": "2025-06-02T10:54:08+00:00",
    "commented_code": "statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]\n+\n+    id = models.UUIDField(primary_key=True, default=uuid4, editable=False)\n+    inserted_at = models.DateTimeField(auto_now_add=True, editable=False)\n+    updated_at = models.DateTimeField(auto_now=True, editable=False)\n+\n+    name = models.CharField(\n+        max_length=100,\n+        validators=[MinLengthValidator(3)],\n+        blank=False,\n+        null=False,\n+        help_text=\"Name of the configuration\",\n+    )\n+    api_key = models.BinaryField(\n+        blank=False, null=False, help_text=\"Encrypted API key for the LLM service\"\n+    )\n+    model = models.CharField(\n+        max_length=50,\n+        blank=False,\n+        null=False,\n+        help_text=\"Must be one of the supported model names\",\n+    )",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2120791559",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120791559",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]\n+\n+    id = models.UUIDField(primary_key=True, default=uuid4, editable=False)\n+    inserted_at = models.DateTimeField(auto_now_add=True, editable=False)\n+    updated_at = models.DateTimeField(auto_now=True, editable=False)\n+\n+    name = models.CharField(\n+        max_length=100,\n+        validators=[MinLengthValidator(3)],\n+        blank=False,\n+        null=False,\n+        help_text=\"Name of the configuration\",\n+    )\n+    api_key = models.BinaryField(\n+        blank=False, null=False, help_text=\"Encrypted API key for the LLM service\"\n+    )\n+    model = models.CharField(\n+        max_length=50,\n+        blank=False,\n+        null=False,\n+        help_text=\"Must be one of the supported model names\",\n+    )",
        "comment_created_at": "2025-06-02T10:54:08+00:00",
        "comment_author": "vicferpoy",
        "comment_body": "Change it to use the enum after you create it. It should be a choice.",
        "pr_file_module": null
      },
      {
        "comment_id": "2120930710",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120791559",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]\n+\n+    id = models.UUIDField(primary_key=True, default=uuid4, editable=False)\n+    inserted_at = models.DateTimeField(auto_now_add=True, editable=False)\n+    updated_at = models.DateTimeField(auto_now=True, editable=False)\n+\n+    name = models.CharField(\n+        max_length=100,\n+        validators=[MinLengthValidator(3)],\n+        blank=False,\n+        null=False,\n+        help_text=\"Name of the configuration\",\n+    )\n+    api_key = models.BinaryField(\n+        blank=False, null=False, help_text=\"Encrypted API key for the LLM service\"\n+    )\n+    model = models.CharField(\n+        max_length=50,\n+        blank=False,\n+        null=False,\n+        help_text=\"Must be one of the supported model names\",\n+    )",
        "comment_created_at": "2025-06-02T11:56:31+00:00",
        "comment_author": "vicferpoy",
        "comment_body": "Updated related comment: https://github.com/prowler-cloud/prowler/pull/7848#discussion_r2120913217",
        "pr_file_module": null
      },
      {
        "comment_id": "2128645023",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120791559",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]\n+\n+    id = models.UUIDField(primary_key=True, default=uuid4, editable=False)\n+    inserted_at = models.DateTimeField(auto_now_add=True, editable=False)\n+    updated_at = models.DateTimeField(auto_now=True, editable=False)\n+\n+    name = models.CharField(\n+        max_length=100,\n+        validators=[MinLengthValidator(3)],\n+        blank=False,\n+        null=False,\n+        help_text=\"Name of the configuration\",\n+    )\n+    api_key = models.BinaryField(\n+        blank=False, null=False, help_text=\"Encrypted API key for the LLM service\"\n+    )\n+    model = models.CharField(\n+        max_length=50,\n+        blank=False,\n+        null=False,\n+        help_text=\"Must be one of the supported model names\",\n+    )",
        "comment_created_at": "2025-06-05T11:43:44+00:00",
        "comment_author": "Chan9390",
        "comment_body": "As we're using django enums and not postgres, can this be left as it is?",
        "pr_file_module": null
      },
      {
        "comment_id": "2137399825",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 7848,
        "pr_file": "api/src/backend/api/models.py",
        "discussion_id": "2120791559",
        "commented_code": "@@ -1332,3 +1335,160 @@ class Meta:\n                 statements=[\"SELECT\", \"INSERT\", \"UPDATE\", \"DELETE\"],\n             ),\n         ]\n+\n+\n+class LighthouseConfig(RowLevelSecurityProtectedModel):\n+    \"\"\"\n+    Stores configuration and API keys for LLM services.\n+    \"\"\"\n+\n+    MODEL_CHOICES = [\n+        \"gpt-4o-2024-11-20\",\n+        \"gpt-4o-2024-08-06\",\n+        \"gpt-4o-2024-05-13\",\n+        \"gpt-4o\",\n+        \"gpt-4o-mini-2024-07-18\",\n+        \"gpt-4o-mini\",\n+    ]\n+\n+    id = models.UUIDField(primary_key=True, default=uuid4, editable=False)\n+    inserted_at = models.DateTimeField(auto_now_add=True, editable=False)\n+    updated_at = models.DateTimeField(auto_now=True, editable=False)\n+\n+    name = models.CharField(\n+        max_length=100,\n+        validators=[MinLengthValidator(3)],\n+        blank=False,\n+        null=False,\n+        help_text=\"Name of the configuration\",\n+    )\n+    api_key = models.BinaryField(\n+        blank=False, null=False, help_text=\"Encrypted API key for the LLM service\"\n+    )\n+    model = models.CharField(\n+        max_length=50,\n+        blank=False,\n+        null=False,\n+        help_text=\"Must be one of the supported model names\",\n+    )",
        "comment_created_at": "2025-06-10T09:41:07+00:00",
        "comment_author": "AdriiiPRodri",
        "comment_body": "In my opinion, in this case I would leave it as you have it, since this allows us to add new models as they become available without having to release a new version of Prowler, just by updating the .env. What do you think, @vicferpoy? I believe making this field a choice would force us to release a new version or even add migrations every time new models become available",
        "pr_file_module": null
      }
    ]
  }
]