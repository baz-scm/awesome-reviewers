[
  {
    "discussion_id": "2158506828",
    "pr_number": 8070,
    "pr_file": "ui/next.config.js",
    "created_at": "2025-06-20T09:41:28+00:00",
    "commented_code": "// HTTP Security Headers\n // 'unsafe-eval' is configured under `script-src` because it is required by NextJS for development mode\n const cspHeader = `\n-    img-src 'self';\n-    font-src 'self';\n-    style-src 'self' 'unsafe-inline';\n-    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com;\n-    connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com;\n-    frame-src 'self' https://js.stripe.com/;\n-    frame-ancestors 'none';\n-    default-src 'self'\n-`\n+  default-src 'self';\n+  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://www.googletagmanager.com;\n+  connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com https://www.googletagmanager.com;\n+  img-src 'self' https://www.google-analytics.com https://www.googletagmanager.com;",
    "repo_full_name": "prowler-cloud/prowler",
    "discussion_comments": [
      {
        "comment_id": "2158506828",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 8070,
        "pr_file": "ui/next.config.js",
        "discussion_id": "2158506828",
        "commented_code": "@@ -3,38 +3,38 @@\n // HTTP Security Headers\n // 'unsafe-eval' is configured under `script-src` because it is required by NextJS for development mode\n const cspHeader = `\n-    img-src 'self';\n-    font-src 'self';\n-    style-src 'self' 'unsafe-inline';\n-    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com;\n-    connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com;\n-    frame-src 'self' https://js.stripe.com/;\n-    frame-ancestors 'none';\n-    default-src 'self'\n-`\n+  default-src 'self';\n+  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://www.googletagmanager.com;\n+  connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com https://www.googletagmanager.com;\n+  img-src 'self' https://www.google-analytics.com https://www.googletagmanager.com;",
        "comment_created_at": "2025-06-20T09:41:28+00:00",
        "comment_author": "jfagoagas",
        "comment_body": "Do you need to add all of this to support GTM?",
        "pr_file_module": null
      },
      {
        "comment_id": "2158519589",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 8070,
        "pr_file": "ui/next.config.js",
        "discussion_id": "2158506828",
        "commented_code": "@@ -3,38 +3,38 @@\n // HTTP Security Headers\n // 'unsafe-eval' is configured under `script-src` because it is required by NextJS for development mode\n const cspHeader = `\n-    img-src 'self';\n-    font-src 'self';\n-    style-src 'self' 'unsafe-inline';\n-    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com;\n-    connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com;\n-    frame-src 'self' https://js.stripe.com/;\n-    frame-ancestors 'none';\n-    default-src 'self'\n-`\n+  default-src 'self';\n+  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://www.googletagmanager.com;\n+  connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com https://www.googletagmanager.com;\n+  img-src 'self' https://www.google-analytics.com https://www.googletagmanager.com;",
        "comment_created_at": "2025-06-20T09:47:23+00:00",
        "comment_author": "paabloLC",
        "comment_body": "Yes, I added both domains to img-src because GTM can load tracking pixels from google-analytics and [GTM](https://tagmanager.google.com/?#/home). Even if we're not explicitly using images ourselves, GTM (and GA if enabled later) may inject 1x1 pixel images for tracking or conversion purposes. It's a safe default to avoid unexpected CSP violations in the future. ",
        "pr_file_module": null
      },
      {
        "comment_id": "2158546725",
        "repo_full_name": "prowler-cloud/prowler",
        "pr_number": 8070,
        "pr_file": "ui/next.config.js",
        "discussion_id": "2158506828",
        "commented_code": "@@ -3,38 +3,38 @@\n // HTTP Security Headers\n // 'unsafe-eval' is configured under `script-src` because it is required by NextJS for development mode\n const cspHeader = `\n-    img-src 'self';\n-    font-src 'self';\n-    style-src 'self' 'unsafe-inline';\n-    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com;\n-    connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com;\n-    frame-src 'self' https://js.stripe.com/;\n-    frame-ancestors 'none';\n-    default-src 'self'\n-`\n+  default-src 'self';\n+  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://www.googletagmanager.com;\n+  connect-src 'self' https://api.iconify.design https://api.simplesvg.com https://api.unisvg.com https://js.stripe.com https://www.googletagmanager.com;\n+  img-src 'self' https://www.google-analytics.com https://www.googletagmanager.com;",
        "comment_created_at": "2025-06-20T10:00:17+00:00",
        "comment_author": "jfagoagas",
        "comment_body": "Thanks for the clarification \ud83d\udc4f ",
        "pr_file_module": null
      }
    ]
  }
]