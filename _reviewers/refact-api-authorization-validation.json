[
  {
    "discussion_id": "1481681615",
    "pr_number": 291,
    "pr_file": "self_hosting_machinery/webgui/selfhost_statistics.py",
    "created_at": "2024-02-07T15:41:02+00:00",
    "commented_code": "},\n             media_type='application/json',\n             status_code=500)\n+        self.add_api_route('/rh-stats', self._rh_stats, methods=[\"GET\"])\n         self.add_api_route(\"/telemetry-basic\", self._telemetry_basic, methods=[\"POST\"])\n         self.add_api_route(\"/telemetry-snippets\", self._telemetry_snippets, methods=[\"POST\"])\n         self.add_api_route('/dash-prime', self._dash_prime_get, methods=['GET'])\n         self.add_api_route('/dash-teams', self._dash_teams_get, methods=['GET'])\n         self.add_api_route('/dash-teams', self._dash_teams_post, methods=['POST'])\n \n+    async def _rh_stats(self, account: str = \"user\"):\n+        if not self._stats_service.is_ready:",
    "repo_full_name": "smallcloudai/refact",
    "discussion_comments": [
      {
        "comment_id": "1481681615",
        "repo_full_name": "smallcloudai/refact",
        "pr_number": 291,
        "pr_file": "self_hosting_machinery/webgui/selfhost_statistics.py",
        "discussion_id": "1481681615",
        "commented_code": "@@ -56,12 +58,29 @@ def __init__(\n             },\n             media_type='application/json',\n             status_code=500)\n+        self.add_api_route('/rh-stats', self._rh_stats, methods=[\"GET\"])\n         self.add_api_route(\"/telemetry-basic\", self._telemetry_basic, methods=[\"POST\"])\n         self.add_api_route(\"/telemetry-snippets\", self._telemetry_snippets, methods=[\"POST\"])\n         self.add_api_route('/dash-prime', self._dash_prime_get, methods=['GET'])\n         self.add_api_route('/dash-teams', self._dash_teams_get, methods=['GET'])\n         self.add_api_route('/dash-teams', self._dash_teams_post, methods=['POST'])\n \n+    async def _rh_stats(self, account: str = \"user\"):\n+        if not self._stats_service.is_ready:",
        "comment_created_at": "2024-02-07T15:41:02+00:00",
        "comment_author": "mitya52",
        "comment_body": "we now have optional ADMIN_TOKEN for OSS so we should check authorization for this case\r\ntake a look in CompletionsRouter",
        "pr_file_module": null
      }
    ]
  }
]