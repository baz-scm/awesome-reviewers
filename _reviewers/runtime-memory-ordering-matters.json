[
  {
    "discussion_id": "2092090898",
    "pr_number": 110472,
    "pr_file": "src/coreclr/nativeaot/Runtime/thread.cpp",
    "created_at": "2025-05-15T23:20:47+00:00",
    "commented_code": "#endif\n\n        *ppvRetAddrLocation = (void*)pfnHijackFunction;\n#if defined(TARGET_ARM64)\n        *ppvRetAddrLocation = PacSignPtr(*ppvRetAddrLocation);\n#endif // TARGET_ARM64",
    "repo_full_name": "dotnet/runtime",
    "discussion_comments": [
      {
        "comment_id": "2092090898",
        "repo_full_name": "dotnet/runtime",
        "pr_number": 110472,
        "pr_file": "src/coreclr/nativeaot/Runtime/thread.cpp",
        "discussion_id": "2092090898",
        "commented_code": "@@ -817,6 +826,9 @@ void Thread::HijackReturnAddressWorker(StackFrameIterator* frameIterator, Hijack\n #endif\n \n         *ppvRetAddrLocation = (void*)pfnHijackFunction;\n+#if defined(TARGET_ARM64)\n+        *ppvRetAddrLocation = PacSignPtr(*ppvRetAddrLocation);\n+#endif // TARGET_ARM64",
        "comment_created_at": "2025-05-15T23:20:47+00:00",
        "comment_author": "jkotas",
        "comment_body": "```suggestion\r\n        void* pvHIjackAddr = (void*)pfnHijackFunction;\r\n#if defined(TARGET_ARM64)\r\n        pvHIjackAddr = PacSignPtr(pvHIjackAddr);\r\n#endif // TARGET_ARM64\r\n        *ppvRetAddrLocation = pvHIjackAddr;\r\n```\r\nWe should avoid writing the wrong value first, and then overwriting it with the correct value. It can cause interesting race conditions.",
        "pr_file_module": null
      },
      {
        "comment_id": "2093116465",
        "repo_full_name": "dotnet/runtime",
        "pr_number": 110472,
        "pr_file": "src/coreclr/nativeaot/Runtime/thread.cpp",
        "discussion_id": "2092090898",
        "commented_code": "@@ -817,6 +826,9 @@ void Thread::HijackReturnAddressWorker(StackFrameIterator* frameIterator, Hijack\n #endif\n \n         *ppvRetAddrLocation = (void*)pfnHijackFunction;\n+#if defined(TARGET_ARM64)\n+        *ppvRetAddrLocation = PacSignPtr(*ppvRetAddrLocation);\n+#endif // TARGET_ARM64",
        "comment_created_at": "2025-05-16T14:02:19+00:00",
        "comment_author": "SwapnilGaikwad",
        "comment_body": "Done",
        "pr_file_module": null
      }
    ]
  }
]