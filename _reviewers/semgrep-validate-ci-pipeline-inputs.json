[
  {
    "discussion_id": "1539251223",
    "pr_number": 10006,
    "pr_file": "cli/src/semgrep/run_scan.py",
    "created_at": "2024-03-26T13:38:35+00:00",
    "commented_code": "baseline_target_strings = target_strings\n                     baseline_target_mode_config = target_mode_config\n                     if target_mode_config.is_pro_diff_scan:\n+                        scanned = [",
    "repo_full_name": "semgrep/semgrep",
    "discussion_comments": [
      {
        "comment_id": "1539251223",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 10006,
        "pr_file": "cli/src/semgrep/run_scan.py",
        "discussion_id": "1539251223",
        "commented_code": "@@ -633,13 +633,14 @@ def run_scan(\n                     baseline_target_strings = target_strings\n                     baseline_target_mode_config = target_mode_config\n                     if target_mode_config.is_pro_diff_scan:\n+                        scanned = [",
        "comment_created_at": "2024-03-26T13:38:35+00:00",
        "comment_author": "IagoAbal",
        "comment_body": "Can we just pass the `scanned` list to the baseline scan? There may be files in there that do not exist in the baseline version. What happens if a file gets renamed, should we scan the same file under the old name?",
        "pr_file_module": null
      },
      {
        "comment_id": "1554394115",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 10006,
        "pr_file": "cli/src/semgrep/run_scan.py",
        "discussion_id": "1539251223",
        "commented_code": "@@ -633,13 +633,14 @@ def run_scan(\n                     baseline_target_strings = target_strings\n                     baseline_target_mode_config = target_mode_config\n                     if target_mode_config.is_pro_diff_scan:\n+                        scanned = [",
        "comment_created_at": "2024-04-05T22:52:31+00:00",
        "comment_author": "ihji",
        "comment_body": "Added a renamed set of files to the target list. Deleted files are checked and removed by `t.exists()` below. A test for removing duplicated findings in renamed files has also been added to the Pro engine PR.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1493386879",
    "pr_number": 9786,
    "pr_file": "cli/src/semgrep/commands/ci.py",
    "created_at": "2024-02-17T18:50:59+00:00",
    "commented_code": ")\n \n         logger.info(\n-            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings\"\n+            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings?&repo={scan_handler.deployment_name}/{metadata.repo_display_name}\"",
    "repo_full_name": "semgrep/semgrep",
    "discussion_comments": [
      {
        "comment_id": "1493386879",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 9786,
        "pr_file": "cli/src/semgrep/commands/ci.py",
        "discussion_id": "1493386879",
        "commented_code": "@@ -616,7 +616,7 @@ def ci(\n             )\n \n         logger.info(\n-            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings\"\n+            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings?&repo={scan_handler.deployment_name}/{metadata.repo_display_name}\"",
        "comment_created_at": "2024-02-17T18:50:59+00:00",
        "comment_author": "chmccreery",
        "comment_body": "Oh, actually, the repo_name by default in CI usually includes the deployment_name so I think this might generate broken links like https://semgrep.dev/orgs/semgrep/findings?repo=semgrep/semgrep/semgrep. I think we should use just the `repo_display_name` here (remove the deployment_name).\r\n\r\nAnother complication is that the name potentially could have spaces in it. We usually \"slug-ify\" user input that goes into a URL but that is complicated here since we are letting folks set it themselves through an env variable. This might be another argument for avoiding env variables long-term and setting these values in the app where we can sanitize the input or reject names with spaces in them. ",
        "pr_file_module": null
      },
      {
        "comment_id": "1496321308",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 9786,
        "pr_file": "cli/src/semgrep/commands/ci.py",
        "discussion_id": "1493386879",
        "commented_code": "@@ -616,7 +616,7 @@ def ci(\n             )\n \n         logger.info(\n-            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings\"\n+            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings?&repo={scan_handler.deployment_name}/{metadata.repo_display_name}\"",
        "comment_created_at": "2024-02-20T18:35:19+00:00",
        "comment_author": "chmccreery",
        "comment_body": "There was also a request to include ref filtering by whichever branch was scanned, i.e. https://semgrep.dev/orgs/-/findings?repo=semgrep/semgrep-app&ref=refs/pull/12441/merge",
        "pr_file_module": null
      },
      {
        "comment_id": "1496561242",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 9786,
        "pr_file": "cli/src/semgrep/commands/ci.py",
        "discussion_id": "1493386879",
        "commented_code": "@@ -616,7 +616,7 @@ def ci(\n             )\n \n         logger.info(\n-            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings\"\n+            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings?&repo={scan_handler.deployment_name}/{metadata.repo_display_name}\"",
        "comment_created_at": "2024-02-20T21:42:44+00:00",
        "comment_author": "emjin",
        "comment_body": "If there's a ticket for the ref filtering ask can you send me? Just want to make sure I get the details right.",
        "pr_file_module": null
      },
      {
        "comment_id": "1496572733",
        "repo_full_name": "semgrep/semgrep",
        "pr_number": 9786,
        "pr_file": "cli/src/semgrep/commands/ci.py",
        "discussion_id": "1493386879",
        "commented_code": "@@ -616,7 +616,7 @@ def ci(\n             )\n \n         logger.info(\n-            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings\"\n+            f\"    https://semgrep.dev/orgs/{scan_handler.deployment_name}/findings?&repo={scan_handler.deployment_name}/{metadata.repo_display_name}\"",
        "comment_created_at": "2024-02-20T21:51:48+00:00",
        "comment_author": "chmccreery",
        "comment_body": "There isn't another ticket, but I just updated the Linear ticket for updating the URL to include that ask as well. It's non-blocking as far as I'm concerned, but would certainly delight LSEG and hopefully should be easy to tack on.",
        "pr_file_module": null
      }
    ]
  }
]