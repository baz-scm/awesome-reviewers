[
  {
    "discussion_id": "2142167322",
    "pr_number": 1860,
    "pr_file": "phpunit.xml.dist",
    "created_at": "2025-06-12T09:25:29+00:00",
    "commented_code": "<testsuites>\n         <testsuite name=\"unit\">\n             <directory>tests</directory>\n+            <directory phpVersion=\"8.1\">tests/Php81</directory>",
    "repo_full_name": "getsentry/sentry-php",
    "discussion_comments": [
      {
        "comment_id": "2142167322",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 1860,
        "pr_file": "phpunit.xml.dist",
        "discussion_id": "2142167322",
        "commented_code": "@@ -14,6 +14,7 @@\n     <testsuites>\n         <testsuite name=\"unit\">\n             <directory>tests</directory>\n+            <directory phpVersion=\"8.1\">tests/Php81</directory>",
        "comment_created_at": "2025-06-12T09:25:29+00:00",
        "comment_author": "Jean85",
        "comment_body": "You shouldn't configure a separate test suite for this, you can use the `@requires` annotation: https://docs.phpunit.de/en/9.6/incomplete-and-skipped-tests.html#incomplete-and-skipped-tests-requires-tables-api",
        "pr_file_module": null
      },
      {
        "comment_id": "2142244407",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 1860,
        "pr_file": "phpunit.xml.dist",
        "discussion_id": "2142167322",
        "commented_code": "@@ -14,6 +14,7 @@\n     <testsuites>\n         <testsuite name=\"unit\">\n             <directory>tests</directory>\n+            <directory phpVersion=\"8.1\">tests/Php81</directory>",
        "comment_created_at": "2025-06-12T09:58:19+00:00",
        "comment_author": "blackwolf12333",
        "comment_body": "`@requires` doesn't actually work in this case because the file can't be parsed at all in 7.2. I think I have a working version now, this also doesn't define a new test suite afaik, just that those files shouldn't be included in the test suite if the php version isn't 8.1 or greater.",
        "pr_file_module": null
      },
      {
        "comment_id": "2142260770",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 1860,
        "pr_file": "phpunit.xml.dist",
        "discussion_id": "2142167322",
        "commented_code": "@@ -14,6 +14,7 @@\n     <testsuites>\n         <testsuite name=\"unit\">\n             <directory>tests</directory>\n+            <directory phpVersion=\"8.1\">tests/Php81</directory>",
        "comment_created_at": "2025-06-12T10:06:26+00:00",
        "comment_author": "Jean85",
        "comment_body": "That's the case only because you put the enum inside the same file as the test. If you put the enum in a separate file, that will be required (and parsed) only if the test gets executed, hence solving the issue.",
        "pr_file_module": null
      },
      {
        "comment_id": "2142646735",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 1860,
        "pr_file": "phpunit.xml.dist",
        "discussion_id": "2142167322",
        "commented_code": "@@ -14,6 +14,7 @@\n     <testsuites>\n         <testsuite name=\"unit\">\n             <directory>tests</directory>\n+            <directory phpVersion=\"8.1\">tests/Php81</directory>",
        "comment_created_at": "2025-06-12T12:44:43+00:00",
        "comment_author": "blackwolf12333",
        "comment_body": "Updated it with the enum in a separate file now.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "254296232",
    "pr_number": 762,
    "pr_file": "tests/phpt/error_handler_refuses_negative_value.phpt",
    "created_at": "2019-02-06T14:39:47+00:00",
    "commented_code": "+--TEST--\n+Test that the error handler is called regardless of the current `error_reporting` setting",
    "repo_full_name": "getsentry/sentry-php",
    "discussion_comments": [
      {
        "comment_id": "254296232",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 762,
        "pr_file": "tests/phpt/error_handler_refuses_negative_value.phpt",
        "discussion_id": "254296232",
        "commented_code": "@@ -0,0 +1,27 @@\n+--TEST--\n+Test that the error handler is called regardless of the current `error_reporting` setting",
        "comment_created_at": "2019-02-06T14:39:47+00:00",
        "comment_author": "ste93cry",
        "comment_body": "This test description is wrong and doesn't respect what the code does. Also to just check that the handler isn't instantiated if the parameter is wrong isn't a normal PHPUnit test with `expectException` enough?",
        "pr_file_module": null
      },
      {
        "comment_id": "254593036",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 762,
        "pr_file": "tests/phpt/error_handler_refuses_negative_value.phpt",
        "discussion_id": "254296232",
        "commented_code": "@@ -0,0 +1,27 @@\n+--TEST--\n+Test that the error handler is called regardless of the current `error_reporting` setting",
        "comment_created_at": "2019-02-07T09:03:21+00:00",
        "comment_author": "Jean85",
        "comment_body": "It's not, since the handler is a singleton, so it would be already registered by previous tests. The PHPT is run in isolation so there no such issue.",
        "pr_file_module": null
      },
      {
        "comment_id": "254599305",
        "repo_full_name": "getsentry/sentry-php",
        "pr_number": 762,
        "pr_file": "tests/phpt/error_handler_refuses_negative_value.phpt",
        "discussion_id": "254296232",
        "commented_code": "@@ -0,0 +1,27 @@\n+--TEST--\n+Test that the error handler is called regardless of the current `error_reporting` setting",
        "comment_created_at": "2019-02-07T09:22:47+00:00",
        "comment_author": "ste93cry",
        "comment_body": "Then I believe that every single test of the error handler that we have in PHPUnit should be moved to PHPT or we should somehow (e.g. with reflection) unset the singleton variable or we will leak state between multiple tests and this is not good. Since we made the handler singleton here it's the correct PR to do it, regardless of the solution we choose",
        "pr_file_module": null
      }
    ]
  }
]