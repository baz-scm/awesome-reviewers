[
  {
    "discussion_id": "2227775976",
    "pr_number": 51547,
    "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
    "created_at": "2025-07-24T08:08:00+00:00",
    "commented_code": "SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.\n+SELECT time_trunc('HOUR', time'12:34:56');\n+SELECT time_trunc('MINUTE', time'12:34:56');\n+SELECT time_trunc('SECOND', time'12:34:56');\n+SELECT time_trunc('MILLISECOND', time'12:34:56');\n+SELECT time_trunc('MICROSECOND', time'12:34:56');\n+SELECT time_trunc('HOUR', time'12:34:56.123456');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456');\n+SELECT time_trunc('SECOND', time'12:34:56.123456');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456');\n+SELECT time_trunc('HOUR', time'12:34:56.123456789');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456789');\n+SELECT time_trunc('SECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456789');\n+\n+-- SPARK-51554: time truncation with zero time.\n+SELECT time_trunc('HOUR', time'00:00:00');\n+SELECT time_trunc('MINUTE', time'00:00:00');\n+SELECT time_trunc('SECOND', time'00:00:00');\n+SELECT time_trunc('MILLISECOND', time'00:00:00');\n+SELECT time_trunc('MICROSECOND', time'00:00:00');\n+-- SPARK-51554: time truncation with small time.\n+SELECT time_trunc('HOUR', time'00:00:00.000000001');\n+SELECT time_trunc('MINUTE', time'00:00:00.000000001');\n+SELECT time_trunc('SECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MILLISECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.000000001');\n+-- SPARK-51554: time truncation with max time.\n+SELECT time_trunc('HOUR', time'23:59:59.999999999');\n+SELECT time_trunc('MINUTE', time'23:59:59.999999999');\n+SELECT time_trunc('SECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MILLISECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MICROSECOND', time'23:59:59.999999999');\n+\n+-- SPARK-51554: time truncation with invalid unit.\n+SELECT time_trunc('', time'12:34:56');\n+SELECT time_trunc(' ', time'12:34:56');\n+SELECT time_trunc('MS', time'12:34:56');\n+SELECT time_trunc('DAY', time'12:34:56');\n+SELECT time_trunc('WEEK', time'12:34:56');\n+SELECT time_trunc('ABCD', time'12:34:56');\n+SELECT time_trunc('QUARTER', time'12:34:56');\n+SELECT time_trunc('INVALID', time'12:34:56');\n+SELECT time_trunc('INVALID_UNIT', time'12:34:56');\n+\n+-- SPARK-51554: time truncation with invalid time.\n+SELECT time_trunc('HOUR', time'24:00:00');\n+SELECT time_trunc('MINUTE', time'23:78:00');\n+SELECT time_trunc('SECOND', time'12:00:97');\n+SELECT time_trunc('MILLISECOND', time'24:00:00.1');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.1234567890');",
    "repo_full_name": "apache/spark",
    "discussion_comments": [
      {
        "comment_id": "2227775976",
        "repo_full_name": "apache/spark",
        "pr_number": 51547,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
        "discussion_id": "2227775976",
        "commented_code": "@@ -79,6 +81,70 @@ SELECT cast(cast('12:00' as time(0)) as time(2));\n SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.\n+SELECT time_trunc('HOUR', time'12:34:56');\n+SELECT time_trunc('MINUTE', time'12:34:56');\n+SELECT time_trunc('SECOND', time'12:34:56');\n+SELECT time_trunc('MILLISECOND', time'12:34:56');\n+SELECT time_trunc('MICROSECOND', time'12:34:56');\n+SELECT time_trunc('HOUR', time'12:34:56.123456');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456');\n+SELECT time_trunc('SECOND', time'12:34:56.123456');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456');\n+SELECT time_trunc('HOUR', time'12:34:56.123456789');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456789');\n+SELECT time_trunc('SECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456789');\n+\n+-- SPARK-51554: time truncation with zero time.\n+SELECT time_trunc('HOUR', time'00:00:00');\n+SELECT time_trunc('MINUTE', time'00:00:00');\n+SELECT time_trunc('SECOND', time'00:00:00');\n+SELECT time_trunc('MILLISECOND', time'00:00:00');\n+SELECT time_trunc('MICROSECOND', time'00:00:00');\n+-- SPARK-51554: time truncation with small time.\n+SELECT time_trunc('HOUR', time'00:00:00.000000001');\n+SELECT time_trunc('MINUTE', time'00:00:00.000000001');\n+SELECT time_trunc('SECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MILLISECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.000000001');\n+-- SPARK-51554: time truncation with max time.\n+SELECT time_trunc('HOUR', time'23:59:59.999999999');\n+SELECT time_trunc('MINUTE', time'23:59:59.999999999');\n+SELECT time_trunc('SECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MILLISECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MICROSECOND', time'23:59:59.999999999');\n+\n+-- SPARK-51554: time truncation with invalid unit.\n+SELECT time_trunc('', time'12:34:56');\n+SELECT time_trunc(' ', time'12:34:56');\n+SELECT time_trunc('MS', time'12:34:56');\n+SELECT time_trunc('DAY', time'12:34:56');\n+SELECT time_trunc('WEEK', time'12:34:56');\n+SELECT time_trunc('ABCD', time'12:34:56');\n+SELECT time_trunc('QUARTER', time'12:34:56');\n+SELECT time_trunc('INVALID', time'12:34:56');\n+SELECT time_trunc('INVALID_UNIT', time'12:34:56');\n+\n+-- SPARK-51554: time truncation with invalid time.\n+SELECT time_trunc('HOUR', time'24:00:00');\n+SELECT time_trunc('MINUTE', time'23:78:00');\n+SELECT time_trunc('SECOND', time'12:00:97');\n+SELECT time_trunc('MILLISECOND', time'24:00:00.1');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.1234567890');",
        "comment_created_at": "2025-07-24T08:08:00+00:00",
        "comment_author": "MaxGekk",
        "comment_body": "Those SELECTs don't test the `time_trunc` function but only time literals, correct? Let's remove them.",
        "pr_file_module": null
      },
      {
        "comment_id": "2227914423",
        "repo_full_name": "apache/spark",
        "pr_number": 51547,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
        "discussion_id": "2227775976",
        "commented_code": "@@ -79,6 +81,70 @@ SELECT cast(cast('12:00' as time(0)) as time(2));\n SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.\n+SELECT time_trunc('HOUR', time'12:34:56');\n+SELECT time_trunc('MINUTE', time'12:34:56');\n+SELECT time_trunc('SECOND', time'12:34:56');\n+SELECT time_trunc('MILLISECOND', time'12:34:56');\n+SELECT time_trunc('MICROSECOND', time'12:34:56');\n+SELECT time_trunc('HOUR', time'12:34:56.123456');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456');\n+SELECT time_trunc('SECOND', time'12:34:56.123456');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456');\n+SELECT time_trunc('HOUR', time'12:34:56.123456789');\n+SELECT time_trunc('MINUTE', time'12:34:56.123456789');\n+SELECT time_trunc('SECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MILLISECOND', time'12:34:56.123456789');\n+SELECT time_trunc('MICROSECOND', time'12:34:56.123456789');\n+\n+-- SPARK-51554: time truncation with zero time.\n+SELECT time_trunc('HOUR', time'00:00:00');\n+SELECT time_trunc('MINUTE', time'00:00:00');\n+SELECT time_trunc('SECOND', time'00:00:00');\n+SELECT time_trunc('MILLISECOND', time'00:00:00');\n+SELECT time_trunc('MICROSECOND', time'00:00:00');\n+-- SPARK-51554: time truncation with small time.\n+SELECT time_trunc('HOUR', time'00:00:00.000000001');\n+SELECT time_trunc('MINUTE', time'00:00:00.000000001');\n+SELECT time_trunc('SECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MILLISECOND', time'00:00:00.000000001');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.000000001');\n+-- SPARK-51554: time truncation with max time.\n+SELECT time_trunc('HOUR', time'23:59:59.999999999');\n+SELECT time_trunc('MINUTE', time'23:59:59.999999999');\n+SELECT time_trunc('SECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MILLISECOND', time'23:59:59.999999999');\n+SELECT time_trunc('MICROSECOND', time'23:59:59.999999999');\n+\n+-- SPARK-51554: time truncation with invalid unit.\n+SELECT time_trunc('', time'12:34:56');\n+SELECT time_trunc(' ', time'12:34:56');\n+SELECT time_trunc('MS', time'12:34:56');\n+SELECT time_trunc('DAY', time'12:34:56');\n+SELECT time_trunc('WEEK', time'12:34:56');\n+SELECT time_trunc('ABCD', time'12:34:56');\n+SELECT time_trunc('QUARTER', time'12:34:56');\n+SELECT time_trunc('INVALID', time'12:34:56');\n+SELECT time_trunc('INVALID_UNIT', time'12:34:56');\n+\n+-- SPARK-51554: time truncation with invalid time.\n+SELECT time_trunc('HOUR', time'24:00:00');\n+SELECT time_trunc('MINUTE', time'23:78:00');\n+SELECT time_trunc('SECOND', time'12:00:97');\n+SELECT time_trunc('MILLISECOND', time'24:00:00.1');\n+SELECT time_trunc('MICROSECOND', time'00:00:00.1234567890');",
        "comment_created_at": "2025-07-24T09:04:17+00:00",
        "comment_author": "uros-db",
        "comment_body": "They are here for completeness. But it makes sense, so I'm removing them now.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2227781050",
    "pr_number": 51547,
    "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
    "created_at": "2025-07-24T08:10:13+00:00",
    "commented_code": "SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.",
    "repo_full_name": "apache/spark",
    "discussion_comments": [
      {
        "comment_id": "2227781050",
        "repo_full_name": "apache/spark",
        "pr_number": 51547,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
        "discussion_id": "2227781050",
        "commented_code": "@@ -79,6 +81,70 @@ SELECT cast(cast('12:00' as time(0)) as time(2));\n SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.",
        "comment_created_at": "2025-07-24T08:10:13+00:00",
        "comment_author": "MaxGekk",
        "comment_body": "Are there any checks for units in lower case and different time precisions?",
        "pr_file_module": null
      },
      {
        "comment_id": "2227916702",
        "repo_full_name": "apache/spark",
        "pr_number": 51547,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/time.sql",
        "discussion_id": "2227781050",
        "commented_code": "@@ -79,6 +81,70 @@ SELECT cast(cast('12:00' as time(0)) as time(2));\n SELECT cast(('23:59:59.001001' :: time(6)) as time(4));\n SELECT cast(time'11:59:59.999999' as time without time zone);\n \n+-- SPARK-51554: time truncation.",
        "comment_created_at": "2025-07-24T09:05:14+00:00",
        "comment_author": "uros-db",
        "comment_body": "There are already tests with different time precisions. However, I'm adding more.\r\n\r\nAlso, adding tests with units in lowercase / mixed case.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1804624747",
    "pr_number": 48470,
    "pr_file": "sql/core/src/test/resources/sql-tests/inputs/string-functions.sql",
    "created_at": "2024-10-17T11:52:28+00:00",
    "commented_code": "SELECT split('aa1cc2ee3', '[1-9]+');\n SELECT split('aa1cc2ee3', '[1-9]+', 2);\n SELECT split('hello', '');\n+SELECT split('hello', '', 1);\n+SELECT split('hello', '', 3);\n SELECT split('', '');",
    "repo_full_name": "apache/spark",
    "discussion_comments": [
      {
        "comment_id": "1804624747",
        "repo_full_name": "apache/spark",
        "pr_number": 48470,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/string-functions.sql",
        "discussion_id": "1804624747",
        "commented_code": "@@ -27,6 +27,8 @@ select right(\"abcd\", -2), right(\"abcd\", 0), right(\"abcd\", 'a');\n SELECT split('aa1cc2ee3', '[1-9]+');\n SELECT split('aa1cc2ee3', '[1-9]+', 2);\n SELECT split('hello', '');\n+SELECT split('hello', '', 1);\n+SELECT split('hello', '', 3);\n SELECT split('', '');",
        "comment_created_at": "2024-10-17T11:52:28+00:00",
        "comment_author": "uros-db",
        "comment_body": "I would also prefer to see:\r\n```\r\nSELECT split('', '', -1);\r\nSELECT split('', '', 0);\r\nSELECT split('', '', 1);\r\n```\r\nhere, for more complete testing",
        "pr_file_module": null
      },
      {
        "comment_id": "1804732967",
        "repo_full_name": "apache/spark",
        "pr_number": 48470,
        "pr_file": "sql/core/src/test/resources/sql-tests/inputs/string-functions.sql",
        "discussion_id": "1804624747",
        "commented_code": "@@ -27,6 +27,8 @@ select right(\"abcd\", -2), right(\"abcd\", 0), right(\"abcd\", 'a');\n SELECT split('aa1cc2ee3', '[1-9]+');\n SELECT split('aa1cc2ee3', '[1-9]+', 2);\n SELECT split('hello', '');\n+SELECT split('hello', '', 1);\n+SELECT split('hello', '', 3);\n SELECT split('', '');",
        "comment_created_at": "2024-10-17T12:53:39+00:00",
        "comment_author": "DenineLu",
        "comment_body": "Thanks, already added.",
        "pr_file_module": null
      }
    ]
  }
]