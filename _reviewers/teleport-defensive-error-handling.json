[
  {
    "discussion_id": "2324530616",
    "pr_number": 58575,
    "pr_file": "web/packages/teleterm/src/mainProcess/windowsManager.ts",
    "created_at": "2025-09-05T09:03:30+00:00",
    "commented_code": null,
    "repo_full_name": "gravitational/teleport",
    "discussion_comments": [
      {
        "comment_id": "2324530616",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58575,
        "pr_file": "web/packages/teleterm/src/mainProcess/windowsManager.ts",
        "discussion_id": "2324530616",
        "commented_code": null,
        "comment_created_at": "2025-09-05T09:03:30+00:00",
        "comment_author": "ravicious",
        "comment_body": "`pnpm start-term -w` seems to be broken by this PR. When I close the window to enter the background mode and then make a change in `web/packages/teleterm/src/mainProcess/mainProcess.ts` to trigger a restart, I see this in the logs:\r\n\r\n```\r\n  waiting for electron to exit...\r\n\r\nrestart electron app...\r\nTSHD 2025-09-05T11:00:36.556+02:00 INFO  Captured signal, stopping service signal:terminated teleterm/teleterm.go:131\r\nTSHD 2025-09-05T11:00:36.556+02:00 INFO [DAEMON]    Stopping daemon/daemon.go:962\r\nTSHD 2025-09-05T11:00:36.556+02:00 INFO [CONN:STOR] Gateway has closed cluster:/clusters/teleport-local.dev resource:/clusters/teleport-local.dev/dbs/postgres gateway:/gateways/e027c287-28a4-4f69-9960-b9327b51edc3 gateway/base.go:120\r\nTSHD 2025-09-05T11:00:36.557+02:00 INFO [CONN:STOR] Gateway has closed cluster:/clusters/teleport-local.dev resource:/clusters/teleport-local.dev/apps/dumper gateway:/gateways/eeea83de-8481-447b-94c0-c4b22490caa7 gateway/base.go:120\r\nTSHD 2025-09-05T11:00:36.557+02:00 INFO [LOCALPROX] HTTP access proxy stopped alpnproxy/local_proxy.go:403\r\nTSHD 2025-09-05T11:00:36.557+02:00 INFO [CONN:STOR] Gateway has closed cluster:/clusters/teleport-local.dev resource:/clusters/teleport-local.dev/kubes/minikube gateway:/gateways/1301e8c3-e882-45ce-a923-139bc8d3f935 gateway/base.go:118\r\nTSHD 2025-09-05T11:00:36.557+02:00 DEBU [DAEMON]    Context closed with error, ending headless watch loop cluster:/clusters/teleport-local.dev error:[context canceled] daemon/daemon_headless.go:253\r\nTSHD 2025-09-05T11:00:36.562+02:00 DEBU [USAGE-REP] enqueued batch of usage events during graceful stop batch_size:3 usagereporter/usagereporter.go:288\r\nSHARED [Process] info: Received terminate message, exiting\r\nMAIN [Main] info: shared process exited with code 0\r\nMAIN [Main] error: Uncaught exception uncaughtException TypeError: Object has been destroyed\r\n    at WindowsManager.showWindow (/Users/rav/src/teleport/web/packages/teleterm/build/app/main/index.js:55264:21)\r\n    at WindowsManager.focusWindow (/Users/rav/src/teleport/web/packages/teleterm/build/app/main/index.js:55304:10)\r\n    at App.<anonymous> (/Users/rav/src/teleport/web/packages/teleterm/build/app/main/index.js:55576:20)\r\n    at App.emit (node:events:518:28)\r\nTSHD 2025-09-05T11:00:37.795+02:00 DEBU [USAGE-REP] successfully submitted batch of usage events batch_size:3 usagereporter/usagereporter.go:195\r\nMAIN [Main] info: tshd exited with code 0\r\nMAIN [Main] info: Starting Electron version 1.0.0-dev\r\nhi\r\nMAIN [Main] info: Starting tsh daemon from /Users/rav/src/teleport/build/tsh\r\nTSHD {CONNECT_GRPC_PORT: 1}\r\nTSHD 2025-09-05T11:00:45.283+02:00 DEBU [USAGE-REP] usage reporter is ready usagereporter/usagereporter.go:262\r\nTSHD 2025-09-05T11:00:45.283+02:00 INFO  tsh daemon listener created listen_addr:unix:///Users/rav/Library/Application Support/Electron/tsh.socket apiserver/apiserver.go:135\r\nSHARED {CONNECT_GRPC_PORT: 1}\r\n```\r\n\r\nfollowed by this later\r\n\r\n```\r\n(node:62413) UnhandledPromiseRejectionWarning: Error: Window was closed before frontend app got initialized\r\n    at BrowserWindow.<anonymous> (/Users/rav/src/teleport/web/packages/teleterm/build/app/main/index.js:55198:11)\r\n    at BrowserWindow.emit (node:events:530:35)\r\n(Use `Electron --trace-warnings ...` to show where the warning was created)\r\n(node:62413) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 1)\r\n```",
        "pr_file_module": null
      },
      {
        "comment_id": "2324969903",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58575,
        "pr_file": "web/packages/teleterm/src/mainProcess/windowsManager.ts",
        "discussion_id": "2324530616",
        "commented_code": null,
        "comment_created_at": "2025-09-05T12:31:33+00:00",
        "comment_author": "gzdunek",
        "comment_body": "I have only managed to see this once (not sure why), so I don't know which exactly call crashes.\r\n\r\nBut it looks like the solution is to check if the window is not destroyed before making operations on it.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2304196388",
    "pr_number": 58348,
    "pr_file": "web/packages/teleterm/src/services/appUpdater/errors.ts",
    "created_at": "2025-08-27T14:48:53+00:00",
    "commented_code": "+/**\n+ * Teleport\n+ * Copyright (C) 2025 Gravitational, Inc.\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+/**\n+ * Thrown when the app cannot be updated to unsupported version.\n+ *\n+ * Kept in a separate file to allow importing in the renderer process.\n+ */\n+export class UnsupportedVersionError extends Error {\n+  constructor(minVersion: string) {\n+    super(\n+      `Teleport Connect cannot update to this version. Managed updates are supported in version ${minVersion} and later.`",
    "repo_full_name": "gravitational/teleport",
    "discussion_comments": [
      {
        "comment_id": "2304196388",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58348,
        "pr_file": "web/packages/teleterm/src/services/appUpdater/errors.ts",
        "discussion_id": "2304196388",
        "commented_code": "@@ -0,0 +1,31 @@\n+/**\n+ * Teleport\n+ * Copyright (C) 2025 Gravitational, Inc.\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+/**\n+ * Thrown when the app cannot be updated to unsupported version.\n+ *\n+ * Kept in a separate file to allow importing in the renderer process.\n+ */\n+export class UnsupportedVersionError extends Error {\n+  constructor(minVersion: string) {\n+    super(\n+      `Teleport Connect cannot update to this version. Managed updates are supported in version ${minVersion} and later.`",
        "comment_created_at": "2025-08-27T14:48:53+00:00",
        "comment_author": "ravicious",
        "comment_body": "It could be useful to make the constructor accept the actual version so that we can replace \"this version\" with the exact version that was causing problems.",
        "pr_file_module": null
      }
    ]
  }
]