[
  {
    "discussion_id": "2319146437",
    "pr_number": 58641,
    "pr_file": "lib/web/databases.go",
    "created_at": "2025-09-03T14:20:47+00:00",
    "commented_code": "}\n \n func (h *Handler) dbConnect(\n-\tw http.ResponseWriter,\n+\t_ http.ResponseWriter,\n \tr *http.Request,\n-\tp httprouter.Params,\n+\t_ httprouter.Params,\n \tsctx *SessionContext,\n \tcluster reversetunnelclient.Cluster,\n \tws *websocket.Conn,\n ) (any, error) {\n+\tq := r.URL.Query()\n+\tparams := q.Get(\"params\")\n+\tif params == \"\" {\n+\t\treturn nil, trace.BadParameter(\"missing params\")\n+\t}",
    "repo_full_name": "gravitational/teleport",
    "discussion_comments": [
      {
        "comment_id": "2319146437",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58641,
        "pr_file": "lib/web/databases.go",
        "discussion_id": "2319146437",
        "commented_code": "@@ -407,13 +407,23 @@ func (h *Handler) sqlServerConfigureADScriptHandle(w http.ResponseWriter, r *htt\n }\n \n func (h *Handler) dbConnect(\n-\tw http.ResponseWriter,\n+\t_ http.ResponseWriter,\n \tr *http.Request,\n-\tp httprouter.Params,\n+\t_ httprouter.Params,\n \tsctx *SessionContext,\n \tcluster reversetunnelclient.Cluster,\n \tws *websocket.Conn,\n ) (any, error) {\n+\tq := r.URL.Query()\n+\tparams := q.Get(\"params\")\n+\tif params == \"\" {\n+\t\treturn nil, trace.BadParameter(\"missing params\")\n+\t}",
        "comment_created_at": "2025-09-03T14:20:47+00:00",
        "comment_author": "greedy52",
        "comment_body": "what if the older web ui not sending the params?",
        "pr_file_module": null
      },
      {
        "comment_id": "2319723459",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58641,
        "pr_file": "lib/web/databases.go",
        "discussion_id": "2319146437",
        "commented_code": "@@ -407,13 +407,23 @@ func (h *Handler) sqlServerConfigureADScriptHandle(w http.ResponseWriter, r *htt\n }\n \n func (h *Handler) dbConnect(\n-\tw http.ResponseWriter,\n+\t_ http.ResponseWriter,\n \tr *http.Request,\n-\tp httprouter.Params,\n+\t_ httprouter.Params,\n \tsctx *SessionContext,\n \tcluster reversetunnelclient.Cluster,\n \tws *websocket.Conn,\n ) (any, error) {\n+\tq := r.URL.Query()\n+\tparams := q.Get(\"params\")\n+\tif params == \"\" {\n+\t\treturn nil, trace.BadParameter(\"missing params\")\n+\t}",
        "comment_created_at": "2025-09-03T17:40:44+00:00",
        "comment_author": "GavinFrazar",
        "comment_body": "i'll ask our frontend people about this",
        "pr_file_module": null
      },
      {
        "comment_id": "2323509187",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58641,
        "pr_file": "lib/web/databases.go",
        "discussion_id": "2319146437",
        "commented_code": "@@ -407,13 +407,23 @@ func (h *Handler) sqlServerConfigureADScriptHandle(w http.ResponseWriter, r *htt\n }\n \n func (h *Handler) dbConnect(\n-\tw http.ResponseWriter,\n+\t_ http.ResponseWriter,\n \tr *http.Request,\n-\tp httprouter.Params,\n+\t_ httprouter.Params,\n \tsctx *SessionContext,\n \tcluster reversetunnelclient.Cluster,\n \tws *websocket.Conn,\n ) (any, error) {\n+\tq := r.URL.Query()\n+\tparams := q.Get(\"params\")\n+\tif params == \"\" {\n+\t\treturn nil, trace.BadParameter(\"missing params\")\n+\t}",
        "comment_created_at": "2025-09-04T20:43:03+00:00",
        "comment_author": "GavinFrazar",
        "comment_body": "I made it optional",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2293204223",
    "pr_number": 58114,
    "pr_file": "lib/services/parser.go",
    "created_at": "2025-08-22T09:26:44+00:00",
    "commented_code": "}\n }\n \n+func (ctx *Context) GetRole() (types.Role, error) {\n+\tif ctx.role == nil {\n+\t\treturn nil, trace.NotFound(\"role is not set in the context\")\n+\t}\n+\treturn ctx.role, nil\n+}\n+\n+func (ctx *Context) SetRole(role types.Role) {\n+\tctx.role = role\n+}\n+",
    "repo_full_name": "gravitational/teleport",
    "discussion_comments": [
      {
        "comment_id": "2293204223",
        "repo_full_name": "gravitational/teleport",
        "pr_number": 58114,
        "pr_file": "lib/services/parser.go",
        "discussion_id": "2293204223",
        "commented_code": "@@ -354,6 +434,17 @@ func (ctx *Context) GetResource() (types.Resource, error) {\n \t}\n }\n \n+func (ctx *Context) GetRole() (types.Role, error) {\n+\tif ctx.role == nil {\n+\t\treturn nil, trace.NotFound(\"role is not set in the context\")\n+\t}\n+\treturn ctx.role, nil\n+}\n+\n+func (ctx *Context) SetRole(role types.Role) {\n+\tctx.role = role\n+}\n+",
        "comment_created_at": "2025-08-22T09:26:44+00:00",
        "comment_author": "Tener",
        "comment_body": "It might be worth to repeat the warning from above if nothing else.\n\nI wonder if a more useful/safer function would return a copy of current context, but with the role set?",
        "pr_file_module": null
      }
    ]
  }
]