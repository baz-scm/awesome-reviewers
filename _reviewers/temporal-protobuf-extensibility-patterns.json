[
  {
    "discussion_id": "2032092499",
    "pr_number": 7585,
    "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
    "created_at": "2025-04-07T22:25:19+00:00",
    "commented_code": "StateMachineTaskInfo state_machine_info = 8;\n }\n \n+message ChasmTransferTaskInfo {",
    "repo_full_name": "temporalio/temporal",
    "discussion_comments": [
      {
        "comment_id": "2032092499",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2032092499",
        "commented_code": "@@ -450,6 +450,19 @@ message OutboundTaskInfo {\n     StateMachineTaskInfo state_machine_info = 8;\n }\n \n+message ChasmTransferTaskInfo {",
        "comment_created_at": "2025-04-07T22:25:19+00:00",
        "comment_author": "lina-temporal",
        "comment_body": "I also considered adding `chasm_info` as a field off of `TransferTask` (or `OutboundTask`), but this seemed a bit cleaner. For CHASM pure tasks, since we only need the entity key and not any component's path, I think we can just reuse the TimerTaskInfo message. ",
        "pr_file_module": null
      },
      {
        "comment_id": "2032187372",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2032092499",
        "commented_code": "@@ -450,6 +450,19 @@ message OutboundTaskInfo {\n     StateMachineTaskInfo state_machine_info = 8;\n }\n \n+message ChasmTransferTaskInfo {",
        "comment_created_at": "2025-04-08T00:29:32+00:00",
        "comment_author": "yycptt",
        "comment_body": "hmmm if we have a separate definition. How do we know which proto message to decode into after getting a blob from transfer queue?",
        "pr_file_module": null
      },
      {
        "comment_id": "2033985441",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2032092499",
        "commented_code": "@@ -450,6 +450,19 @@ message OutboundTaskInfo {\n     StateMachineTaskInfo state_machine_info = 8;\n }\n \n+message ChasmTransferTaskInfo {",
        "comment_created_at": "2025-04-08T20:39:05+00:00",
        "comment_author": "lina-temporal",
        "comment_body": "Yeah, I'm realizing this as I'm doing the deserialization. How about adding a new entry to TransferTaskInfo's `oneof task_details` for `ChasmTaskInfo`, instead? Then I can use the task type to construct the `ChasmTransferTask`. ",
        "pr_file_module": null
      },
      {
        "comment_id": "2034033940",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2032092499",
        "commented_code": "@@ -450,6 +450,19 @@ message OutboundTaskInfo {\n     StateMachineTaskInfo state_machine_info = 8;\n }\n \n+message ChasmTransferTaskInfo {",
        "comment_created_at": "2025-04-08T21:06:24+00:00",
        "comment_author": "yycptt",
        "comment_body": "yeah that could work. Note that we will need the same info in Timer/OutboundTaskInfo as well, so ideally all three should look similar and follow the same pattern.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2035795686",
    "pr_number": 7585,
    "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
    "created_at": "2025-04-09T17:11:01+00:00",
    "commented_code": "// Destination of this task (e.g. protocol+host+port for callbacks).\n     // Outbound tasks are grouped by this field (and the namespace ID) when scheduling.\n     string destination = 7;\n-    // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n-    StateMachineTaskInfo state_machine_info = 8;\n+\n+    oneof task_details {\n+        // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n+        StateMachineTaskInfo state_machine_info = 8;",
    "repo_full_name": "temporalio/temporal",
    "discussion_comments": [
      {
        "comment_id": "2035795686",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2035795686",
        "commented_code": "@@ -446,8 +455,14 @@ message OutboundTaskInfo {\n     // Destination of this task (e.g. protocol+host+port for callbacks).\n     // Outbound tasks are grouped by this field (and the namespace ID) when scheduling.\n     string destination = 7;\n-    // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n-    StateMachineTaskInfo state_machine_info = 8;\n+\n+    oneof task_details {\n+        // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n+        StateMachineTaskInfo state_machine_info = 8;",
        "comment_created_at": "2025-04-09T17:11:01+00:00",
        "comment_author": "yycptt",
        "comment_body": "is this a breaking change?",
        "pr_file_module": null
      },
      {
        "comment_id": "2035843470",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2035795686",
        "commented_code": "@@ -446,8 +455,14 @@ message OutboundTaskInfo {\n     // Destination of this task (e.g. protocol+host+port for callbacks).\n     // Outbound tasks are grouped by this field (and the namespace ID) when scheduling.\n     string destination = 7;\n-    // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n-    StateMachineTaskInfo state_machine_info = 8;\n+\n+    oneof task_details {\n+        // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n+        StateMachineTaskInfo state_machine_info = 8;",
        "comment_created_at": "2025-04-09T17:44:26+00:00",
        "comment_author": "lina-temporal",
        "comment_body": "Not at the proto level (only for generated Go code, which I've updated):\r\n\r\n> Changing a single optional field or extension into a member of a new oneof is binary compatible, however for some languages (notably, Go) the generated code\u2019s API will change in incompatible ways.\r\n\r\nand\r\n\r\n> implicit: (not recommended) An implicit field has no explicit cardinality label and behaves as follows:\r\n>   * if the field is a message type, it behaves just like an optional field.\r\n\r\n Source:\r\nhttps://protobuf.dev/programming-guides/proto3/#updating",
        "pr_file_module": null
      },
      {
        "comment_id": "2036087545",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7585,
        "pr_file": "proto/internal/temporal/server/api/persistence/v1/executions.proto",
        "discussion_id": "2035795686",
        "commented_code": "@@ -446,8 +455,14 @@ message OutboundTaskInfo {\n     // Destination of this task (e.g. protocol+host+port for callbacks).\n     // Outbound tasks are grouped by this field (and the namespace ID) when scheduling.\n     string destination = 7;\n-    // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n-    StateMachineTaskInfo state_machine_info = 8;\n+\n+    oneof task_details {\n+        // If task addresses a sub-statemachine (e.g. callback), this field will be set.\n+        StateMachineTaskInfo state_machine_info = 8;",
        "comment_created_at": "2025-04-09T20:20:15+00:00",
        "comment_author": "lina-temporal",
        "comment_body": "`buf` doesn't like the change, ~~but I think it's because we have our rules set to FILE compatibility~~ (was reading the wrong buf.yaml, ours is on `WIRE`). I'm going to temporarily ignore via buf.yaml to merge. This is apparently a documented issue:\r\n\r\nhttps://github.com/bufbuild/buf/issues/1906",
        "pr_file_module": null
      }
    ]
  }
]