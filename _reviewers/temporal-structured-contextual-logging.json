[
  {
    "discussion_id": "2159559096",
    "pr_number": 7943,
    "pr_file": "service/matching/matching_engine.go",
    "created_at": "2025-06-20T19:28:54+00:00",
    "commented_code": "TaskReachability: reachability,\n \t\t\t}\n \t\t}\n+\n+\t\te.logger.Debug(\"ShowTaskQueueConfig : \" + strconv.FormatBool(req.ShowTaskQueueConfig))",
    "repo_full_name": "temporalio/temporal",
    "discussion_comments": [
      {
        "comment_id": "2159559096",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7943,
        "pr_file": "service/matching/matching_engine.go",
        "discussion_id": "2159559096",
        "commented_code": "@@ -1270,6 +1271,18 @@ func (e *matchingEngineImpl) DescribeTaskQueue(\n \t\t\t\tTaskReachability: reachability,\n \t\t\t}\n \t\t}\n+\n+\t\te.logger.Debug(\"ShowTaskQueueConfig : \" + strconv.FormatBool(req.ShowTaskQueueConfig))",
        "comment_created_at": "2025-06-20T19:28:54+00:00",
        "comment_author": "dnr",
        "comment_body": "use log tags, not string manipulation. or just remove this before merging",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1878807554",
    "pr_number": 6944,
    "pr_file": "common/persistence/visibility/visiblity_manager_metrics.go",
    "created_at": "2024-12-10T20:30:13+00:00",
    "commented_code": ") (*manager.ListWorkflowExecutionsResponse, error) {\n \thandler, startTime := m.tagScope(metrics.VisibilityPersistenceListWorkflowExecutionsScope)\n \tresponse, err := m.delegate.ListWorkflowExecutions(ctx, request)\n-\tmetrics.VisibilityPersistenceLatency.With(handler).Record(time.Since(startTime))\n+\telapsed := time.Since(startTime)\n+\tif elapsed > m.slowQueryThreshold() {\n+\t\tm.logger.Info(\"List query exceeded threshold\",\n+\t\t\ttag.NewDurationTag(\"duration\", elapsed),\n+\t\t\ttag.NewStringTag(\"visibility-query\", request.Query),\n+\t\t)",
    "repo_full_name": "temporalio/temporal",
    "discussion_comments": [
      {
        "comment_id": "1878807554",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 6944,
        "pr_file": "common/persistence/visibility/visiblity_manager_metrics.go",
        "discussion_id": "1878807554",
        "commented_code": "@@ -137,7 +141,14 @@ func (m *visibilityManagerMetrics) ListWorkflowExecutions(\n ) (*manager.ListWorkflowExecutionsResponse, error) {\n \thandler, startTime := m.tagScope(metrics.VisibilityPersistenceListWorkflowExecutionsScope)\n \tresponse, err := m.delegate.ListWorkflowExecutions(ctx, request)\n-\tmetrics.VisibilityPersistenceLatency.With(handler).Record(time.Since(startTime))\n+\telapsed := time.Since(startTime)\n+\tif elapsed > m.slowQueryThreshold() {\n+\t\tm.logger.Info(\"List query exceeded threshold\",\n+\t\t\ttag.NewDurationTag(\"duration\", elapsed),\n+\t\t\ttag.NewStringTag(\"visibility-query\", request.Query),\n+\t\t)",
        "comment_created_at": "2024-12-10T20:30:13+00:00",
        "comment_author": "rodrigozhou",
        "comment_body": "Can we do warn level instead of info?\r\nAlso, can we tag namespace?",
        "pr_file_module": null
      },
      {
        "comment_id": "1878823852",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 6944,
        "pr_file": "common/persistence/visibility/visiblity_manager_metrics.go",
        "discussion_id": "1878807554",
        "commented_code": "@@ -137,7 +141,14 @@ func (m *visibilityManagerMetrics) ListWorkflowExecutions(\n ) (*manager.ListWorkflowExecutionsResponse, error) {\n \thandler, startTime := m.tagScope(metrics.VisibilityPersistenceListWorkflowExecutionsScope)\n \tresponse, err := m.delegate.ListWorkflowExecutions(ctx, request)\n-\tmetrics.VisibilityPersistenceLatency.With(handler).Record(time.Since(startTime))\n+\telapsed := time.Since(startTime)\n+\tif elapsed > m.slowQueryThreshold() {\n+\t\tm.logger.Info(\"List query exceeded threshold\",\n+\t\t\ttag.NewDurationTag(\"duration\", elapsed),\n+\t\t\ttag.NewStringTag(\"visibility-query\", request.Query),\n+\t\t)",
        "comment_created_at": "2024-12-10T20:41:10+00:00",
        "comment_author": "jmbarzee",
        "comment_body": "Yes. Let me see how available namespace is.",
        "pr_file_module": null
      },
      {
        "comment_id": "1878848949",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 6944,
        "pr_file": "common/persistence/visibility/visiblity_manager_metrics.go",
        "discussion_id": "1878807554",
        "commented_code": "@@ -137,7 +141,14 @@ func (m *visibilityManagerMetrics) ListWorkflowExecutions(\n ) (*manager.ListWorkflowExecutionsResponse, error) {\n \thandler, startTime := m.tagScope(metrics.VisibilityPersistenceListWorkflowExecutionsScope)\n \tresponse, err := m.delegate.ListWorkflowExecutions(ctx, request)\n-\tmetrics.VisibilityPersistenceLatency.With(handler).Record(time.Since(startTime))\n+\telapsed := time.Since(startTime)\n+\tif elapsed > m.slowQueryThreshold() {\n+\t\tm.logger.Info(\"List query exceeded threshold\",\n+\t\t\ttag.NewDurationTag(\"duration\", elapsed),\n+\t\t\ttag.NewStringTag(\"visibility-query\", request.Query),\n+\t\t)",
        "comment_created_at": "2024-12-10T20:59:51+00:00",
        "comment_author": "jmbarzee",
        "comment_body": "Added both suggestions.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2091766446",
    "pr_number": 7767,
    "pr_file": "service/frontend/namespace_handler.go",
    "created_at": "2025-05-15T18:37:27+00:00",
    "commented_code": "}\n \n \tif found {\n-\t\td.logger.Info(fmt.Sprintf(\"Removed expired workflow rule %s\", oldestKey))\n+\t\td.logger.Info(\"Removed expired workflow rule\", tag.WorkflowRuleID(oldestKey))",
    "repo_full_name": "temporalio/temporal",
    "discussion_comments": [
      {
        "comment_id": "2091766446",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7767,
        "pr_file": "service/frontend/namespace_handler.go",
        "discussion_id": "2091766446",
        "commented_code": "@@ -748,7 +748,7 @@ func (d *namespaceHandler) removeOldestExpiredWorkflowRule(rules map[string]*rul\n \t}\n \n \tif found {\n-\t\td.logger.Info(fmt.Sprintf(\"Removed expired workflow rule %s\", oldestKey))\n+\t\td.logger.Info(\"Removed expired workflow rule\", tag.WorkflowRuleID(oldestKey))",
        "comment_created_at": "2025-05-15T18:37:27+00:00",
        "comment_author": "dnr",
        "comment_body": "this one seems like it needs namespace [and/or id] tags to be helpful",
        "pr_file_module": null
      },
      {
        "comment_id": "2121993705",
        "repo_full_name": "temporalio/temporal",
        "pr_number": 7767,
        "pr_file": "service/frontend/namespace_handler.go",
        "discussion_id": "2091766446",
        "commented_code": "@@ -748,7 +748,7 @@ func (d *namespaceHandler) removeOldestExpiredWorkflowRule(rules map[string]*rul\n \t}\n \n \tif found {\n-\t\td.logger.Info(fmt.Sprintf(\"Removed expired workflow rule %s\", oldestKey))\n+\t\td.logger.Info(\"Removed expired workflow rule\", tag.WorkflowRuleID(oldestKey))",
        "comment_created_at": "2025-06-02T19:31:19+00:00",
        "comment_author": "lina-temporal",
        "comment_body": "Added namespace to tag.",
        "pr_file_module": null
      }
    ]
  }
]