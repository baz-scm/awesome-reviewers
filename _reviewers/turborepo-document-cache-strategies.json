[
  {
    "discussion_id": "1961268351",
    "pr_number": 9996,
    "pr_file": "docs/repo-docs/guides/ci-vendors/github-actions.mdx",
    "created_at": "2025-02-19T09:14:10+00:00",
    "commented_code": "uses: actions/cache@v4 // [!code highlight]\n           with: // [!code highlight]\n             path: .turbo // [!code highlight]\n-            key: ${{ runner.os }}-turbo-${{ github.sha }} // [!code highlight]\n+            key: ${{ runner.os }}-turbo-${{ github.ref_name }} // [!code highlight]\n             restore-keys: | // [!code highlight]\n               ${{ runner.os }}-turbo- // [!code highlight]",
    "repo_full_name": "vercel/turborepo",
    "discussion_comments": [
      {
        "comment_id": "1961268351",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9996,
        "pr_file": "docs/repo-docs/guides/ci-vendors/github-actions.mdx",
        "discussion_id": "1961268351",
        "commented_code": "@@ -290,7 +290,7 @@ Example `ci` yaml with `.turbo` as chosen cache folder:\n           uses: actions/cache@v4 // [!code highlight]\n           with: // [!code highlight]\n             path: .turbo // [!code highlight]\n-            key: ${{ runner.os }}-turbo-${{ github.sha }} // [!code highlight]\n+            key: ${{ runner.os }}-turbo-${{ github.ref_name }} // [!code highlight]\n             restore-keys: | // [!code highlight]\n               ${{ runner.os }}-turbo- // [!code highlight]",
        "comment_created_at": "2025-02-19T09:14:10+00:00",
        "comment_author": "asapo",
        "comment_body": "My understanding is that once a cache is created, it cannot be updated.\r\nhttps://github.com/actions/cache/blob/main/tips-and-workarounds.md#update-a-cache\r\n\r\nIf we use `ref_name`, the default branch (eg. `main`, `master`) would be the most inefficient.\r\n\r\nAdittionally, I'd like to discuss about the isolation.\r\nCaches are already isolated by branches.\r\n\r\nhttps://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/caching-dependencies-to-speed-up-workflows#restrictions-for-accessing-a-cache\r\n\r\nIn addition to this behavior, a cache from the default branch will be used by feature branches.\r\n\r\n> Workflow runs can restore caches created in either the current branch or the default branch (usually main).\r\n\r\nTherefore, my current understanding is,\r\n\r\n- Create a cache with the default branch (cache-hash_main)\r\n- Create a feature branch (`feature-a`) and run CI\r\n  - `cache-hash_main` will be used\r\n  - `cache-hash_feature-a_1` will be created\r\n- Push a commit to `feature-a` and run CI\r\n  - `cache-hash_feature-a_1` will be used\r\n  - `cache-hash_feature-a_2` will be created\r\n\r\nI'm not sure the better way. But using `ref_name` might not be the better way.",
        "pr_file_module": null
      },
      {
        "comment_id": "1961670615",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9996,
        "pr_file": "docs/repo-docs/guides/ci-vendors/github-actions.mdx",
        "discussion_id": "1961268351",
        "commented_code": "@@ -290,7 +290,7 @@ Example `ci` yaml with `.turbo` as chosen cache folder:\n           uses: actions/cache@v4 // [!code highlight]\n           with: // [!code highlight]\n             path: .turbo // [!code highlight]\n-            key: ${{ runner.os }}-turbo-${{ github.sha }} // [!code highlight]\n+            key: ${{ runner.os }}-turbo-${{ github.ref_name }} // [!code highlight]\n             restore-keys: | // [!code highlight]\n               ${{ runner.os }}-turbo- // [!code highlight]",
        "comment_created_at": "2025-02-19T13:20:56+00:00",
        "comment_author": "apetta",
        "comment_body": "You're absolutely right, thanks for the additional context.\r\n\r\nSHA seems to be the optimal approach given the restrictions. Each run will be a cache miss by default due to changing SHA, but the `restore-keys` should facilitate a cache hit agains the most recent cache on a branch - which is desirable behaviour. Additionally, re-runs of previous actions will have a direct cache-hit (if within cache life window).\r\n\r\nClosing PR.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1838693792",
    "pr_number": 9427,
    "pr_file": "docs/repo-docs/reference/run.mdx",
    "created_at": "2024-11-12T19:56:52+00:00",
    "commented_code": "changed.\n </Callout>\n \n+### `--cache <options>`\n+\n+Default: `local:rw,remote:rw`\n+\n+Specify caching sources for the run. Accepts a comma-separated list of options:\n+\n+- `local`: Use the local filesystem cache\n+- `remote`: Use the Remote Cache\n+\n+When an option is omitted, it is neither read nor written to.\n+\n+Each option must be followed by one of:\n+\n+- `rw`: Read and write\n+- `r`: Read only\n+- `w`: Write only\n+\n+```bash title=\"Terminal\"\n+# Read and write to local cache, read only to Remote Cache\n+turbo run build --cache=local:rw,remote:r\n+\n+# Read-only to local cache, read write to Remote Cache\n+turbo run build --cache=local:r,remote:rw\n+\n+# Read and write to local cache, no Remote Cache activity",
    "repo_full_name": "vercel/turborepo",
    "discussion_comments": [
      {
        "comment_id": "1838693792",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9427,
        "pr_file": "docs/repo-docs/reference/run.mdx",
        "discussion_id": "1838693792",
        "commented_code": "@@ -58,6 +58,34 @@ TURBO_SCM_HEAD=your-branch turbo run build --affected\n   changed.\n </Callout>\n \n+### `--cache <options>`\n+\n+Default: `local:rw,remote:rw`\n+\n+Specify caching sources for the run. Accepts a comma-separated list of options:\n+\n+- `local`: Use the local filesystem cache\n+- `remote`: Use the Remote Cache\n+\n+When an option is omitted, it is neither read nor written to.\n+\n+Each option must be followed by one of:\n+\n+- `rw`: Read and write\n+- `r`: Read only\n+- `w`: Write only\n+\n+```bash title=\"Terminal\"\n+# Read and write to local cache, read only to Remote Cache\n+turbo run build --cache=local:rw,remote:r\n+\n+# Read-only to local cache, read write to Remote Cache\n+turbo run build --cache=local:r,remote:rw\n+\n+# Read and write to local cache, no Remote Cache activity",
        "comment_created_at": "2024-11-12T19:56:52+00:00",
        "comment_author": "anthonyshew",
        "comment_body": "I wasn't sure if `no Remote Cache activity` is correct. Can someone confirm?",
        "pr_file_module": null
      },
      {
        "comment_id": "1839002087",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9427,
        "pr_file": "docs/repo-docs/reference/run.mdx",
        "discussion_id": "1838693792",
        "commented_code": "@@ -58,6 +58,34 @@ TURBO_SCM_HEAD=your-branch turbo run build --affected\n   changed.\n </Callout>\n \n+### `--cache <options>`\n+\n+Default: `local:rw,remote:rw`\n+\n+Specify caching sources for the run. Accepts a comma-separated list of options:\n+\n+- `local`: Use the local filesystem cache\n+- `remote`: Use the Remote Cache\n+\n+When an option is omitted, it is neither read nor written to.\n+\n+Each option must be followed by one of:\n+\n+- `rw`: Read and write\n+- `r`: Read only\n+- `w`: Write only\n+\n+```bash title=\"Terminal\"\n+# Read and write to local cache, read only to Remote Cache\n+turbo run build --cache=local:rw,remote:r\n+\n+# Read-only to local cache, read write to Remote Cache\n+turbo run build --cache=local:r,remote:rw\n+\n+# Read and write to local cache, no Remote Cache activity",
        "comment_created_at": "2024-11-12T23:41:49+00:00",
        "comment_author": "chris-olszewski",
        "comment_body": "Are you referring to the `Remote caching enabled` line in the run prelude? If so I can confirm that it becomes `Remote caching disabled` with `--cache=local:rw`.",
        "pr_file_module": null
      },
      {
        "comment_id": "1840577975",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9427,
        "pr_file": "docs/repo-docs/reference/run.mdx",
        "discussion_id": "1838693792",
        "commented_code": "@@ -58,6 +58,34 @@ TURBO_SCM_HEAD=your-branch turbo run build --affected\n   changed.\n </Callout>\n \n+### `--cache <options>`\n+\n+Default: `local:rw,remote:rw`\n+\n+Specify caching sources for the run. Accepts a comma-separated list of options:\n+\n+- `local`: Use the local filesystem cache\n+- `remote`: Use the Remote Cache\n+\n+When an option is omitted, it is neither read nor written to.\n+\n+Each option must be followed by one of:\n+\n+- `rw`: Read and write\n+- `r`: Read only\n+- `w`: Write only\n+\n+```bash title=\"Terminal\"\n+# Read and write to local cache, read only to Remote Cache\n+turbo run build --cache=local:rw,remote:r\n+\n+# Read-only to local cache, read write to Remote Cache\n+turbo run build --cache=local:r,remote:rw\n+\n+# Read and write to local cache, no Remote Cache activity",
        "comment_created_at": "2024-11-13T15:22:57+00:00",
        "comment_author": "anthonyshew",
        "comment_body": "We talked about this to make sure and it is correct!",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1776334543",
    "pr_number": 9185,
    "pr_file": "docs/repo-docs/crafting-your-repository/configuring-tasks.mdx",
    "created_at": "2024-09-26T04:24:08+00:00",
    "commented_code": "tasks are properly configured first.\n </Callout>\n \n-The `outputs` key tells Turborepo **files and directories** it should cache when the task has successfully completed. **Without this key defined, Turborepo will not cache any files. Hitting cache on subsequent runs will not restore any file outputs.**\n+The `outputs` key tells Turborepo **files and directories** it should cache when the task has successfully completed.",
    "repo_full_name": "vercel/turborepo",
    "discussion_comments": [
      {
        "comment_id": "1776334543",
        "repo_full_name": "vercel/turborepo",
        "pr_number": 9185,
        "pr_file": "docs/repo-docs/crafting-your-repository/configuring-tasks.mdx",
        "discussion_id": "1776334543",
        "commented_code": "@@ -172,7 +172,7 @@ Some tasks may not have any dependencies. For example, a task for finding typos\n   tasks are properly configured first.\n </Callout>\n \n-The `outputs` key tells Turborepo **files and directories** it should cache when the task has successfully completed. **Without this key defined, Turborepo will not cache any files. Hitting cache on subsequent runs will not restore any file outputs.**\n+The `outputs` key tells Turborepo **files and directories** it should cache when the task has successfully completed.",
        "comment_created_at": "2024-09-26T04:24:08+00:00",
        "comment_author": "anthonyshew",
        "comment_body": "We need to keep this information. It's important that folks know that no artifacts will be cached.",
        "pr_file_module": null
      }
    ]
  }
]