[
  {
    "discussion_id": "2152786800",
    "pr_number": 61861,
    "pr_file": "tests/baselines/reference/tscWatch/moduleResolution/watches-for-changes-to-package-json-main-fields.js",
    "created_at": "2025-06-17T17:20:00+00:00",
    "commented_code": "}\r\n \r\n \r\n-Timeout callback:: count: 1\r\n-1: timerToInvalidateFailedLookupResolutions *new*\r\n+Before running Timeout callback:: count: 0\r\n \r\n-Before running Timeout callback:: count: 1\r\n-1: timerToInvalidateFailedLookupResolutions\r\n-\r\n-Host is moving to new time\r\n-After running Timeout callback:: count: 1\r\n-\r\n-Timeout callback:: count: 1\r\n-2: timerToUpdateProgram *new*\r\n-\r\n-Before running Timeout callback:: count: 1\r\n-2: timerToUpdateProgram\r\n-\r\n-Host is moving to new time\r\n After running Timeout callback:: count: 0\r\n-Output::\r\n->> Screen clear\r\n-[\u001b[90mHH:MM:SS AM\u001b[0m] File change detected. Starting incremental compilation...\n-\n-======== Resolving module 'pkg2' from '/user/username/projects/myproject/packages/pkg1/index.ts'. ========\n-Module resolution kind is not specified, using 'Node10'.\n-Loading module 'pkg2' from 'node_modules' folder, target file types: TypeScript, Declaration.\n-Searching all ancestor node_modules directories for preferred extensions: TypeScript, Declaration.\n-Directory '/user/username/projects/myproject/packages/pkg1/node_modules' does not exist, skipping all lookups in it.\n-Directory '/user/username/projects/myproject/packages/node_modules' does not exist, skipping all lookups in it.\n-Found 'package.json' at '/user/username/projects/myproject/node_modules/pkg2/package.json'.\n-File '/user/username/projects/myproject/node_modules/pkg2.ts' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2.tsx' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2.d.ts' does not exist.\n-'package.json' does not have a 'typesVersions' field.\n-'package.json' does not have a 'typings' field.\n-'package.json' does not have a 'types' field.\n-'package.json' has 'main' field 'build/other.js' that references '/user/username/projects/myproject/node_modules/pkg2/build/other.js'.\n-File name '/user/username/projects/myproject/node_modules/pkg2/build/other.js' has a '.js' extension - stripping it.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.ts' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.tsx' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.d.ts' exists - use it as a name resolution result.\n-'package.json' does not have a 'peerDependencies' field.\n-Resolving real path for '/user/username/projects/myproject/node_modules/pkg2/build/other.d.ts', result '/user/username/projects/myproject/packages/pkg2/build/other.d.ts'.\n-======== Module name 'pkg2' was successfully resolved to '/user/username/projects/myproject/packages/pkg2/build/other.d.ts' with Package ID 'pkg2/build/other.d.ts@1.0.0'. ========\n-\u001b[96mpackages/pkg1/index.ts\u001b[0m:\u001b[93m1\u001b[0m:\u001b[93m15\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS2305: \u001b[0mModule '\"pkg2\"' has no exported member 'TheNum'.",
    "repo_full_name": "microsoft/TypeScript",
    "discussion_comments": [
      {
        "comment_id": "2152786800",
        "repo_full_name": "microsoft/TypeScript",
        "pr_number": 61861,
        "pr_file": "tests/baselines/reference/tscWatch/moduleResolution/watches-for-changes-to-package-json-main-fields.js",
        "discussion_id": "2152786800",
        "commented_code": "@@ -178,127 +166,14 @@ Input::\n }\r\n \r\n \r\n-Timeout callback:: count: 1\r\n-1: timerToInvalidateFailedLookupResolutions *new*\r\n+Before running Timeout callback:: count: 0\r\n \r\n-Before running Timeout callback:: count: 1\r\n-1: timerToInvalidateFailedLookupResolutions\r\n-\r\n-Host is moving to new time\r\n-After running Timeout callback:: count: 1\r\n-\r\n-Timeout callback:: count: 1\r\n-2: timerToUpdateProgram *new*\r\n-\r\n-Before running Timeout callback:: count: 1\r\n-2: timerToUpdateProgram\r\n-\r\n-Host is moving to new time\r\n After running Timeout callback:: count: 0\r\n-Output::\r\n->> Screen clear\r\n-[\u001b[90mHH:MM:SS AM\u001b[0m] File change detected. Starting incremental compilation...\n-\n-======== Resolving module 'pkg2' from '/user/username/projects/myproject/packages/pkg1/index.ts'. ========\n-Module resolution kind is not specified, using 'Node10'.\n-Loading module 'pkg2' from 'node_modules' folder, target file types: TypeScript, Declaration.\n-Searching all ancestor node_modules directories for preferred extensions: TypeScript, Declaration.\n-Directory '/user/username/projects/myproject/packages/pkg1/node_modules' does not exist, skipping all lookups in it.\n-Directory '/user/username/projects/myproject/packages/node_modules' does not exist, skipping all lookups in it.\n-Found 'package.json' at '/user/username/projects/myproject/node_modules/pkg2/package.json'.\n-File '/user/username/projects/myproject/node_modules/pkg2.ts' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2.tsx' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2.d.ts' does not exist.\n-'package.json' does not have a 'typesVersions' field.\n-'package.json' does not have a 'typings' field.\n-'package.json' does not have a 'types' field.\n-'package.json' has 'main' field 'build/other.js' that references '/user/username/projects/myproject/node_modules/pkg2/build/other.js'.\n-File name '/user/username/projects/myproject/node_modules/pkg2/build/other.js' has a '.js' extension - stripping it.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.ts' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.tsx' does not exist.\n-File '/user/username/projects/myproject/node_modules/pkg2/build/other.d.ts' exists - use it as a name resolution result.\n-'package.json' does not have a 'peerDependencies' field.\n-Resolving real path for '/user/username/projects/myproject/node_modules/pkg2/build/other.d.ts', result '/user/username/projects/myproject/packages/pkg2/build/other.d.ts'.\n-======== Module name 'pkg2' was successfully resolved to '/user/username/projects/myproject/packages/pkg2/build/other.d.ts' with Package ID 'pkg2/build/other.d.ts@1.0.0'. ========\n-\u001b[96mpackages/pkg1/index.ts\u001b[0m:\u001b[93m1\u001b[0m:\u001b[93m15\u001b[0m - \u001b[91merror\u001b[0m\u001b[90m TS2305: \u001b[0mModule '\"pkg2\"' has no exported member 'TheNum'.",
        "comment_created_at": "2025-06-17T17:20:00+00:00",
        "comment_author": "sheetalkamat",
        "comment_body": "Package.json was watched in two scenarios before this change - \r\n1.  if package json was used to determine file's metadata - in node16 etc \r\n2.  if this affected already resolved module resolution\r\n\r\nBecause we arent doing 2 watch any more and node10 isnt using package.json - this discrepency is shown in the test which uses node10",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1772309025",
    "pr_number": 60039,
    "pr_file": "tests/baselines/reference/tscWatch/projectsWithReferences/on-sample-project-with-nodenext.js",
    "created_at": "2024-09-23T22:41:51+00:00",
    "commented_code": "Loading module as file / folder, candidate module location '/user/username/projects/sample1/core/anotherModule', target file types: TypeScript, JavaScript, Declaration.\n File '/user/username/projects/sample1/core/anotherModule.ts' exists - use it as a name resolution result.\n ======== Module name '../core/anotherModule' was successfully resolved to '/user/username/projects/sample1/core/anotherModule.ts'. ========\n-File '/user/username/projects/sample1/core/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/sample1/logic/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.",
    "repo_full_name": "microsoft/TypeScript",
    "discussion_comments": [
      {
        "comment_id": "1772309025",
        "repo_full_name": "microsoft/TypeScript",
        "pr_number": 60039,
        "pr_file": "tests/baselines/reference/tscWatch/projectsWithReferences/on-sample-project-with-nodenext.js",
        "discussion_id": "1772309025",
        "commented_code": "@@ -513,28 +513,10 @@ Resolving in CJS mode with conditions 'require', 'types', 'node'.\n Loading module as file / folder, candidate module location '/user/username/projects/sample1/core/anotherModule', target file types: TypeScript, JavaScript, Declaration.\n File '/user/username/projects/sample1/core/anotherModule.ts' exists - use it as a name resolution result.\n ======== Module name '../core/anotherModule' was successfully resolved to '/user/username/projects/sample1/core/anotherModule.ts'. ========\n-File '/user/username/projects/sample1/core/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/sample1/logic/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.",
        "comment_created_at": "2024-09-23T22:41:51+00:00",
        "comment_author": "andrewbranch",
        "comment_body": "I haven\u2019t been able to figure out why these lookups disappeared. It looks like all projects in the graph use `moduleResolution: nodenext`, so I'm not sure why any existing lookups would go away. Also debugged this test and never hit a breakpoint with `!shouldLookupFromPackageJson` in `getImpliedNodeFormatForFileWorker` \ud83e\udd14 ",
        "pr_file_module": null
      },
      {
        "comment_id": "1772321781",
        "repo_full_name": "microsoft/TypeScript",
        "pr_number": 60039,
        "pr_file": "tests/baselines/reference/tscWatch/projectsWithReferences/on-sample-project-with-nodenext.js",
        "discussion_id": "1772309025",
        "commented_code": "@@ -513,28 +513,10 @@ Resolving in CJS mode with conditions 'require', 'types', 'node'.\n Loading module as file / folder, candidate module location '/user/username/projects/sample1/core/anotherModule', target file types: TypeScript, JavaScript, Declaration.\n File '/user/username/projects/sample1/core/anotherModule.ts' exists - use it as a name resolution result.\n ======== Module name '../core/anotherModule' was successfully resolved to '/user/username/projects/sample1/core/anotherModule.ts'. ========\n-File '/user/username/projects/sample1/core/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/sample1/logic/package.json' does not exist.\n-File '/user/username/projects/sample1/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/projects/package.json' does not exist according to earlier cached lookups.\n-File '/user/username/package.json' does not exist according to earlier cached lookups.\n-File '/user/package.json' does not exist according to earlier cached lookups.\n-File '/package.json' does not exist according to earlier cached lookups.",
        "comment_created_at": "2024-09-23T23:02:41+00:00",
        "comment_author": "andrewbranch",
        "comment_body": "Figured it out\u2014the lookups didn\u2019t go away; they were just silenced because the referenced project whose options we\u2019re using to do the package.json lookups doesn\u2019t have `traceResolution` set, while the downstream project does. I can fix that.",
        "pr_file_module": null
      }
    ]
  }
]