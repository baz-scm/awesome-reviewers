[
  {
    "discussion_id": "1198303459",
    "pr_number": 11456,
    "pr_file": "go/flags/endtoend/vttablet.txt",
    "created_at": "2023-05-18T21:04:59+00:00",
    "commented_code": "--ceph_backup_storage_config string                                Path to JSON config file for ceph backup storage. (default \"ceph_backup_config.json\")\n       --compression-engine-name string                                   compressor engine used for compression. (default \"pargzip\")\n       --compression-level int                                            what level to pass to the compressor. (default 1)\n+      --config-file string                                               Full path of the config file (with extension) to use. If set, --config-path, --config-type, and --config-name are ignored.",
    "repo_full_name": "vitessio/vitess",
    "discussion_comments": [
      {
        "comment_id": "1198303459",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 11456,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1198303459",
        "commented_code": "@@ -34,6 +34,12 @@ Usage of vttablet:\n       --ceph_backup_storage_config string                                Path to JSON config file for ceph backup storage. (default \"ceph_backup_config.json\")\n       --compression-engine-name string                                   compressor engine used for compression. (default \"pargzip\")\n       --compression-level int                                            what level to pass to the compressor. (default 1)\n+      --config-file string                                               Full path of the config file (with extension) to use. If set, --config-path, --config-type, and --config-name are ignored.",
        "comment_created_at": "2023-05-18T21:04:59+00:00",
        "comment_author": "deepthi",
        "comment_body": "Time to deprecate `--tablet_config`?\r\nhttps://github.com/vitessio/vitess/pull/6070#issue-600485280",
        "pr_file_module": null
      },
      {
        "comment_id": "1198944553",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 11456,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1198303459",
        "commented_code": "@@ -34,6 +34,12 @@ Usage of vttablet:\n       --ceph_backup_storage_config string                                Path to JSON config file for ceph backup storage. (default \"ceph_backup_config.json\")\n       --compression-engine-name string                                   compressor engine used for compression. (default \"pargzip\")\n       --compression-level int                                            what level to pass to the compressor. (default 1)\n+      --config-file string                                               Full path of the config file (with extension) to use. If set, --config-path, --config-type, and --config-name are ignored.",
        "comment_created_at": "2023-05-19T13:13:30+00:00",
        "comment_author": "ajm188",
        "comment_body": "sure; worth noting here that due to the order of operations (which isn't really avoidable, i think), the old `--tablet_config` gets applied _after_ the viper config loading, so any values in there take precedence.\r\n\r\ni'd strongly advise (and will do so in the deprecation, which i think should be a separate change also in v17) that people use one or the other but never both.",
        "pr_file_module": null
      },
      {
        "comment_id": "1200742255",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 11456,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1198303459",
        "commented_code": "@@ -34,6 +34,12 @@ Usage of vttablet:\n       --ceph_backup_storage_config string                                Path to JSON config file for ceph backup storage. (default \"ceph_backup_config.json\")\n       --compression-engine-name string                                   compressor engine used for compression. (default \"pargzip\")\n       --compression-level int                                            what level to pass to the compressor. (default 1)\n+      --config-file string                                               Full path of the config file (with extension) to use. If set, --config-path, --config-type, and --config-name are ignored.",
        "comment_created_at": "2023-05-22T16:19:41+00:00",
        "comment_author": "mattlord",
        "comment_body": "TiL. As long as we mark `--tablet_config` as deprecated I think it's fine.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "1911977455",
    "pr_number": 17470,
    "pr_file": "go/flags/endtoend/vttablet.txt",
    "created_at": "2025-01-11T11:51:14+00:00",
    "commented_code": "--srv_topo_cache_refresh duration                                  how frequently to refresh the topology for cached entries (default 1s)\n       --srv_topo_cache_ttl duration                                      how long to use cached entries for topology (default 1s)\n       --srv_topo_timeout duration                                        topo server timeout (default 5s)\n+      --stalled-disk-write-dir string                                    if provided, tablet will attempt to write a file to this directory to check if the disk is stalled",
    "repo_full_name": "vitessio/vitess",
    "discussion_comments": [
      {
        "comment_id": "1911977455",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 17470,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1911977455",
        "commented_code": "@@ -328,6 +328,9 @@ Flags:\n       --srv_topo_cache_refresh duration                                  how frequently to refresh the topology for cached entries (default 1s)\n       --srv_topo_cache_ttl duration                                      how long to use cached entries for topology (default 1s)\n       --srv_topo_timeout duration                                        topo server timeout (default 5s)\n+      --stalled-disk-write-dir string                                    if provided, tablet will attempt to write a file to this directory to check if the disk is stalled",
        "comment_created_at": "2025-01-11T11:51:14+00:00",
        "comment_author": "timvaillancourt",
        "comment_body": "@GuptaManan100 this flag got me thinking \"what directories do we really care about?\". I think the answer is ultimately whatever `mysqld` is using for it's [`datadir`](https://dev.mysql.com/doc/refman/8.4/en/server-system-variables.html#sysvar_datadir) and [`tmpdir`](https://dev.mysql.com/doc/refman/8.4/en/server-system-variables.html#sysvar_tmpdir)\r\n\r\nIt's not impossible that the `datadir` and `tmpdir` are on different disks/mounts. I seem to remember some docs or blogs recommending this to separate IO workloads, although I've never seen it in the wild\r\n\r\nSo, I wonder:\r\n1. Should we monitor both `datadir` and `tmpdir`?\r\n2. Instead of having the user figure out what path(s) they should be monitoring _(context heavy)_, could `vttablet` ask `mysqld` for the path with a `SELECT @@global.datadir` and potentially `SELECT @@global.tmpdir`? A drawback to this would be we'd need to ensure our filename doesn't affect `mysqld`'s operation _(seems possible)_\r\n\r\ncc @joekelly and @erikhalperin-hub from the original issue for input",
        "pr_file_module": null
      },
      {
        "comment_id": "1911985139",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 17470,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1911977455",
        "commented_code": "@@ -328,6 +328,9 @@ Flags:\n       --srv_topo_cache_refresh duration                                  how frequently to refresh the topology for cached entries (default 1s)\n       --srv_topo_cache_ttl duration                                      how long to use cached entries for topology (default 1s)\n       --srv_topo_timeout duration                                        topo server timeout (default 5s)\n+      --stalled-disk-write-dir string                                    if provided, tablet will attempt to write a file to this directory to check if the disk is stalled",
        "comment_created_at": "2025-01-11T12:03:16+00:00",
        "comment_author": "timvaillancourt",
        "comment_body": "To complicate things further, I've been reminded you can have many `tmpdir`s \ud83e\udd14:\r\n> The path of the directory to use for creating temporary files. It might be useful if your default /tmp directory resides on a partition that is too small to hold temporary tables. This variable can be set to a list of several paths that are used in round-robin fashion. Paths should be separated by colon characters (:) on Unix and semicolon characters (;) on Windows.\r\n\r\nPerhaps supporting just one `tmpdir` is enough. A list of `tmpdir`s with `:` sounds extremely edge case",
        "pr_file_module": null
      },
      {
        "comment_id": "1912685404",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 17470,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1911977455",
        "commented_code": "@@ -328,6 +328,9 @@ Flags:\n       --srv_topo_cache_refresh duration                                  how frequently to refresh the topology for cached entries (default 1s)\n       --srv_topo_cache_ttl duration                                      how long to use cached entries for topology (default 1s)\n       --srv_topo_timeout duration                                        topo server timeout (default 5s)\n+      --stalled-disk-write-dir string                                    if provided, tablet will attempt to write a file to this directory to check if the disk is stalled",
        "comment_created_at": "2025-01-13T05:47:47+00:00",
        "comment_author": "GuptaManan100",
        "comment_body": "I'm not sure about this \ud83e\udd14. I think its just easier to keep this a flag that users can set according to their preferences instead of trying ot read something form mysql that might not cover all the cases.",
        "pr_file_module": null
      },
      {
        "comment_id": "1913213217",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 17470,
        "pr_file": "go/flags/endtoend/vttablet.txt",
        "discussion_id": "1911977455",
        "commented_code": "@@ -328,6 +328,9 @@ Flags:\n       --srv_topo_cache_refresh duration                                  how frequently to refresh the topology for cached entries (default 1s)\n       --srv_topo_cache_ttl duration                                      how long to use cached entries for topology (default 1s)\n       --srv_topo_timeout duration                                        topo server timeout (default 5s)\n+      --stalled-disk-write-dir string                                    if provided, tablet will attempt to write a file to this directory to check if the disk is stalled",
        "comment_created_at": "2025-01-13T13:43:33+00:00",
        "comment_author": "joekelley",
        "comment_body": "+1 to keeping it simple for now and allowing users to specify a path. IIRC when I would use fsfreeze to lock up the datadir I wasn't able to even run a `select 1` query reliably, so unless we were going to poll and cache tempdirs in a separate goroutine I think that adding a query here could decrease reliability.",
        "pr_file_module": null
      }
    ]
  }
]