[
  {
    "discussion_id": "2150631841",
    "pr_number": 18365,
    "pr_file": ".github/workflows/cluster_endtoend_12.yml",
    "created_at": "2025-06-16T18:42:08+00:00",
    "commented_code": "timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
    "repo_full_name": "vitessio/vitess",
    "discussion_comments": [
      {
        "comment_id": "2150631841",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T18:42:08+00:00",
        "comment_author": "GrahamCampbell",
        "comment_body": "We probably don't want to leave this reference in, as it would pose an OSS supply chain security issue. What's the plan with this?",
        "pr_file_module": null
      },
      {
        "comment_id": "2150648705",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T18:52:19+00:00",
        "comment_author": "ranimandepudi",
        "comment_body": "Thank you for flagging this \u2014 you are absolutely right and I agree that referencing personal repos is not ideal for long-term security and maintainace.\r\n\r\nPlan moving forward:\r\nAs a proposal, I am exploring options to transition the MySQL Arm64 .deb artifacts to an Arm-maintained GitHub organization. The goal is to ensure:\r\n\t\u2022\tLong-term availability,\r\n\t\u2022\tClear provenance and versioning,\r\n\t\u2022\tAnd alignment with open-source supply chain best practices.\r\n\r\nThis PR currently uses the temporary reference only to unblock early CI validation across architectures. If you have a preferred approach or alternative hosting recommendation, I am very open to your suggestions.\r\n",
        "pr_file_module": null
      },
      {
        "comment_id": "2150665522",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T19:01:46+00:00",
        "comment_author": "GrahamCampbell",
        "comment_body": "If we want to keep this in the short term, then I think we should validate the sha256 hash of the downloaded file, and abort if it differs. We could do this improvement for all deb downloads tbh.",
        "pr_file_module": null
      },
      {
        "comment_id": "2150681625",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T19:11:57+00:00",
        "comment_author": "ranimandepudi",
        "comment_body": "Thank you for the suggestion \u2014 completely agree that adding SHA256 verification would mitigate short-term risks while the artifact is hosted in a personal repo.\r\nPlan:\r\nI will update the workflows to: \r\n\t\u2022\tAdd a sha256sum -c verification immediately after downloading the .deb,\r\n\t\u2022\tAbort the job if the checksum does not match,\r\n\t\u2022\tApply this guard consistently across all workflows using the temporary .deb,\r\nIf you are aligned with the approach, I will push the update with the verified hashes shortly. Open to any further refinements you would recommend !! \r\n\r\nThanks again for your input @GrahamCampbell ",
        "pr_file_module": null
      },
      {
        "comment_id": "2150685238",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T19:13:27+00:00",
        "comment_author": "GrahamCampbell",
        "comment_body": "Sounds good, though note that I'm not a Vitess maintainer. :)",
        "pr_file_module": null
      },
      {
        "comment_id": "2150701134",
        "repo_full_name": "vitessio/vitess",
        "pr_number": 18365,
        "pr_file": ".github/workflows/cluster_endtoend_12.yml",
        "discussion_id": "2150631841",
        "commented_code": "@@ -98,25 +107,29 @@ jobs:\n       timeout-minutes: 10\n       run: |\n         \n-        # Get key to latest MySQL repo\n         sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys A8D3785C\n-        # Setup MySQL 8.0\n-        wget -c https://dev.mysql.com/get/mysql-apt-config_0.8.33-1_all.deb\n-        echo mysql-apt-config mysql-apt-config/select-server select mysql-8.0 | sudo debconf-set-selections\n-        sudo DEBIAN_FRONTEND=\"noninteractive\" dpkg -i mysql-apt-config*\n-        sudo apt-get -qq update\n-\n-        # We have to install this old version of libaio1 in case we end up testing with MySQL 5.7. See also:\n-        # https://bugs.launchpad.net/ubuntu/+source/libaio/+bug/2067501\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/main/liba/libaio/libaio1_0.3.112-13build1_amd64.deb\n-        sudo dpkg -i libaio1_0.3.112-13build1_amd64.deb\n-        # libtinfo5 is also needed for older MySQL 5.7 builds.\n-        curl -L -O http://mirrors.kernel.org/ubuntu/pool/universe/n/ncurses/libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-        sudo dpkg -i libtinfo5_6.3-2ubuntu0.1_amd64.deb\n-\n-        # Install everything else we need, and configure\n-        sudo apt-get -qq install -y mysql-server mysql-shell mysql-client make unzip g++ etcd-client etcd-server curl git wget eatmydata xz-utils libncurses6\n+        if [ \"$ARCH\" = \"arm64\" ]; then\n+          wget https://github.com/ranimandepudi/vitess/releases/download/mysql-arm64-deb/mysql-server_8.0.35_arm64.deb",
        "comment_created_at": "2025-06-16T19:23:35+00:00",
        "comment_author": "ranimandepudi",
        "comment_body": "Thanks for the clarification.",
        "pr_file_module": null
      }
    ]
  }
]