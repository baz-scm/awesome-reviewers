[
  {
    "discussion_id": "2183356312",
    "pr_number": 20447,
    "pr_file": "csrc/quantization/cutlass_w8a8/scaled_mm_entry.cu",
    "created_at": "2025-07-03T17:34:35+00:00",
    "commented_code": "torch::Tensor const& b_strides, torch::Tensor const& c_strides,\n     bool per_act_token, bool per_out_ch) {\n   int32_t version_num = get_sm_version_num();\n+#if defined ENABLE_CUTLASS_MOE_SM100 && ENABLE_CUTLASS_MOE_SM100\n+  cutlass_moe_mm_sm100(out_tensors, a_tensors, b_tensors, a_scales, b_scales,\n+                       expert_offsets, problem_sizes, a_strides, b_strides,\n+                       c_strides, per_act_token, per_out_ch);\n+  return;\n+#endif",
    "repo_full_name": "vllm-project/vllm",
    "discussion_comments": [
      {
        "comment_id": "2190723841",
        "repo_full_name": "vllm-project/vllm",
        "pr_number": 20447,
        "pr_file": "csrc/quantization/cutlass_w8a8/scaled_mm_entry.cu",
        "discussion_id": "2183356312",
        "commented_code": "@@ -234,6 +247,12 @@ void cutlass_moe_mm(\n     torch::Tensor const& b_strides, torch::Tensor const& c_strides,\n     bool per_act_token, bool per_out_ch) {\n   int32_t version_num = get_sm_version_num();\n+#if defined ENABLE_CUTLASS_MOE_SM100 && ENABLE_CUTLASS_MOE_SM100\n+  cutlass_moe_mm_sm100(out_tensors, a_tensors, b_tensors, a_scales, b_scales,\n+                       expert_offsets, problem_sizes, a_strides, b_strides,\n+                       c_strides, per_act_token, per_out_ch);\n+  return;\n+#endif",
        "comment_created_at": "2025-07-07T17:51:00+00:00",
        "comment_author": "LucasWilkinson",
        "comment_body": "@djmmoss I think Gemini is actually correct here; we should also add runtime switches ",
        "pr_file_module": null
      }
    ]
  }
]