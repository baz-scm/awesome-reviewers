[
  {
    "discussion_id": "1700456311",
    "pr_number": 6399,
    "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
    "created_at": "2024-08-01T16:12:11+00:00",
    "commented_code": "+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}",
    "repo_full_name": "cloudflare/workers-sdk",
    "discussion_comments": [
      {
        "comment_id": "1700456311",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700456311",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}",
        "comment_created_at": "2024-08-01T16:12:11+00:00",
        "comment_author": "RamIdeas",
        "comment_body": "Is it safe to pass this token to a third-party action?",
        "pr_file_module": null
      },
      {
        "comment_id": "1700673783",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700456311",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}",
        "comment_created_at": "2024-08-01T18:55:45+00:00",
        "comment_author": "andyjessop",
        "comment_body": "This is a good point. The source code is \"obfuscated\" in some sense because `dist` is built and committed to the repo, so there is a security issue there.\r\n\r\nWe might look instead at copy/pasting the source into our own source code and calling it directly.",
        "pr_file_module": null
      },
      {
        "comment_id": "1700904541",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700456311",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}",
        "comment_created_at": "2024-08-01T21:45:42+00:00",
        "comment_author": "RamIdeas",
        "comment_body": "We could also create a read:org only token https://github.com/tspascoal/get-user-teams-membership/blob/master/README.md?plain=1#L23",
        "pr_file_module": null
      },
      {
        "comment_id": "1700905479",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700456311",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}",
        "comment_created_at": "2024-08-01T21:47:04+00:00",
        "comment_author": "RamIdeas",
        "comment_body": "But forking that repo into our org might be the safest option",
        "pr_file_module": null
      }
    ]
  }
]