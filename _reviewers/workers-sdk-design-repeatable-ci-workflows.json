[
  {
    "discussion_id": "1700664736",
    "pr_number": 6399,
    "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
    "created_at": "2024-08-01T18:50:10+00:00",
    "commented_code": "+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}\n+          username: ${{ github.actor }}\n+          team: wrangler\n+      - name: Stop workflow if user is no member\n+        if: ${{ steps.teamAffiliation.outputs.isTeamMember == false }}\n+        run: |\n+          echo \"You have must be on the \"wrangler\" team to trigger this job.\"\n+          exit 1\n+\n+      - name: \"Checkout PR\"\n+        run: gh pr checkout ${{ inputs.pr-number }}\n+\n+      - name: \"Create Draft PR\"\n+        run: git checkout -b run-ci-on-hehalf-of-${{ inputs.pr-number }}",
    "repo_full_name": "cloudflare/workers-sdk",
    "discussion_comments": [
      {
        "comment_id": "1700664736",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700664736",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}\n+          username: ${{ github.actor }}\n+          team: wrangler\n+      - name: Stop workflow if user is no member\n+        if: ${{ steps.teamAffiliation.outputs.isTeamMember == false }}\n+        run: |\n+          echo \"You have must be on the \"wrangler\" team to trigger this job.\"\n+          exit 1\n+\n+      - name: \"Checkout PR\"\n+        run: gh pr checkout ${{ inputs.pr-number }}\n+\n+      - name: \"Create Draft PR\"\n+        run: git checkout -b run-ci-on-hehalf-of-${{ inputs.pr-number }}",
        "comment_created_at": "2024-08-01T18:50:10+00:00",
        "comment_author": "andyjessop",
        "comment_body": "Should we run a `branch -D` on this branch first? Unlikely conflict, but possible.",
        "pr_file_module": null
      },
      {
        "comment_id": "1700903066",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700664736",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}\n+          username: ${{ github.actor }}\n+          team: wrangler\n+      - name: Stop workflow if user is no member\n+        if: ${{ steps.teamAffiliation.outputs.isTeamMember == false }}\n+        run: |\n+          echo \"You have must be on the \"wrangler\" team to trigger this job.\"\n+          exit 1\n+\n+      - name: \"Checkout PR\"\n+        run: gh pr checkout ${{ inputs.pr-number }}\n+\n+      - name: \"Create Draft PR\"\n+        run: git checkout -b run-ci-on-hehalf-of-${{ inputs.pr-number }}",
        "comment_created_at": "2024-08-01T21:43:52+00:00",
        "comment_author": "RamIdeas",
        "comment_body": "Yeah I was considering this needs to be repeatable. I was thinking a force push or something once I confirmed this all worked but `branch -D` would also work \u2013 do we need to delete the remote branch too? and close the existing PR?",
        "pr_file_module": null
      },
      {
        "comment_id": "1701522356",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 6399,
        "pr_file": ".github/workflows/run-ci-for-external-forks.yml",
        "discussion_id": "1700664736",
        "commented_code": "@@ -0,0 +1,39 @@\n+# This workflow cleans up any leftover projects created by e2e runs.\n+\n+name: Run CI on behalf of External Forks\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      pr-number:\n+        description: \"The PR number to run CI on behalf of\"\n+        required: true\n+      reviewed:\n+        description: \"Confirm that the PR has been reviewed for use/leakage of secrets\"\n+        type: boolean\n+        required: true\n+jobs:\n+  create-draft-pr:\n+    if: ${{ inputs.reviewed == true }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Check user for team affiliation\n+        uses: tspascoal/get-user-teams-membership@v2\n+        id: teamAffiliation\n+        with:\n+          GITHUB_TOKEN: ${{ secrets.GH_ACCESS_TOKEN }}\n+          username: ${{ github.actor }}\n+          team: wrangler\n+      - name: Stop workflow if user is no member\n+        if: ${{ steps.teamAffiliation.outputs.isTeamMember == false }}\n+        run: |\n+          echo \"You have must be on the \"wrangler\" team to trigger this job.\"\n+          exit 1\n+\n+      - name: \"Checkout PR\"\n+        run: gh pr checkout ${{ inputs.pr-number }}\n+\n+      - name: \"Create Draft PR\"\n+        run: git checkout -b run-ci-on-hehalf-of-${{ inputs.pr-number }}",
        "comment_created_at": "2024-08-02T08:49:31+00:00",
        "comment_author": "andyjessop",
        "comment_body": "If that's possible then it seems like a good idea, to avoid needing any potential manual cleanup.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "2035537475",
    "pr_number": 8845,
    "pr_file": ".github/workflows/c3-e2e.yml",
    "created_at": "2025-04-09T14:44:17+00:00",
    "commented_code": "fail-fast: false\n       matrix:\n         os: [ubuntu-latest]\n-        pm:\n-          [\n-            { name: npm, version: \"0.0.0\" },\n-            { name: pnpm, version: \"9.12.0\" },\n-            { name: yarn, version: \"1.0.0\" },\n-          ]\n+        pm: [{ name: npm, version: \"0.0.0\" }, { name: yarn, version: \"1.0.0\" }]",
    "repo_full_name": "cloudflare/workers-sdk",
    "discussion_comments": [
      {
        "comment_id": "2035537475",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 8845,
        "pr_file": ".github/workflows/c3-e2e.yml",
        "discussion_id": "2035537475",
        "commented_code": "@@ -34,12 +33,7 @@ jobs:\n       fail-fast: false\n       matrix:\n         os: [ubuntu-latest]\n-        pm:\n-          [\n-            { name: npm, version: \"0.0.0\" },\n-            { name: pnpm, version: \"9.12.0\" },\n-            { name: yarn, version: \"1.0.0\" },\n-          ]\n+        pm: [{ name: npm, version: \"0.0.0\" }, { name: yarn, version: \"1.0.0\" }]",
        "comment_created_at": "2025-04-09T14:44:17+00:00",
        "comment_author": "penalosa",
        "comment_body": "Run all existing C3 tests on Version Packages, exactly as today",
        "pr_file_module": null
      },
      {
        "comment_id": "2035656166",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 8845,
        "pr_file": ".github/workflows/c3-e2e.yml",
        "discussion_id": "2035537475",
        "commented_code": "@@ -34,12 +33,7 @@ jobs:\n       fail-fast: false\n       matrix:\n         os: [ubuntu-latest]\n-        pm:\n-          [\n-            { name: npm, version: \"0.0.0\" },\n-            { name: pnpm, version: \"9.12.0\" },\n-            { name: yarn, version: \"1.0.0\" },\n-          ]\n+        pm: [{ name: npm, version: \"0.0.0\" }, { name: yarn, version: \"1.0.0\" }]",
        "comment_created_at": "2025-04-09T15:45:32+00:00",
        "comment_author": "petebacondarwin",
        "comment_body": "i.e. we don't need to run pnpm because that is covered by the other job?",
        "pr_file_module": null
      },
      {
        "comment_id": "2035686410",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 8845,
        "pr_file": ".github/workflows/c3-e2e.yml",
        "discussion_id": "2035537475",
        "commented_code": "@@ -34,12 +33,7 @@ jobs:\n       fail-fast: false\n       matrix:\n         os: [ubuntu-latest]\n-        pm:\n-          [\n-            { name: npm, version: \"0.0.0\" },\n-            { name: pnpm, version: \"9.12.0\" },\n-            { name: yarn, version: \"1.0.0\" },\n-          ]\n+        pm: [{ name: npm, version: \"0.0.0\" }, { name: yarn, version: \"1.0.0\" }]",
        "comment_created_at": "2025-04-09T16:03:03+00:00",
        "comment_author": "penalosa",
        "comment_body": "Yeah (same with the Wrangler E2E tests). The other job runs unconditionally",
        "pr_file_module": null
      }
    ]
  }
]