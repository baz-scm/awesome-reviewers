[
  {
    "discussion_id": "1973685170",
    "pr_number": 8166,
    "pr_file": "packages/wrangler/src/type-generation/index.ts",
    "created_at": "2025-02-27T14:25:23+00:00",
    "commented_code": "}\n \t}\n \n-\twriteDTSFile({\n-\t\tenvTypeStructure,\n-\t\tmodulesTypeStructure,\n-\t\tformatType: entrypointFormat,\n-\t\tenvInterface,\n-\t\tpath: fullOutputPath,\n-\t});\n+\tconst wranglerCommandUsed = [\"wrangler\", ...process.argv.slice(2)].join(\" \");\n+\n+\tconst typesHaveBeenFound =\n+\t\tenvTypeStructure.length || modulesTypeStructure.length;\n+\tif (entrypointFormat === \"modules\" || typesHaveBeenFound) {\n+\t\tconst { fileContent, consoleOutput } = generateTypeStrings(\n+\t\t\tentrypointFormat,\n+\t\t\tenvInterface,\n+\t\t\tenvTypeStructure.map(([key, value]) => `${key}: ${value};`),\n+\t\t\tmodulesTypeStructure\n+\t\t);\n+\t\t// todo replace envInterface with generic\n+\t\tconst hash = blake3hash(consoleOutput).toString(\"hex\").slice(0, 32);",
    "repo_full_name": "cloudflare/workers-sdk",
    "discussion_comments": [
      {
        "comment_id": "1973685170",
        "repo_full_name": "cloudflare/workers-sdk",
        "pr_number": 8166,
        "pr_file": "packages/wrangler/src/type-generation/index.ts",
        "discussion_id": "1973685170",
        "commented_code": "@@ -458,72 +521,60 @@ async function generateTypes(\n \t\t}\n \t}\n \n-\twriteDTSFile({\n-\t\tenvTypeStructure,\n-\t\tmodulesTypeStructure,\n-\t\tformatType: entrypointFormat,\n-\t\tenvInterface,\n-\t\tpath: fullOutputPath,\n-\t});\n+\tconst wranglerCommandUsed = [\"wrangler\", ...process.argv.slice(2)].join(\" \");\n+\n+\tconst typesHaveBeenFound =\n+\t\tenvTypeStructure.length || modulesTypeStructure.length;\n+\tif (entrypointFormat === \"modules\" || typesHaveBeenFound) {\n+\t\tconst { fileContent, consoleOutput } = generateTypeStrings(\n+\t\t\tentrypointFormat,\n+\t\t\tenvInterface,\n+\t\t\tenvTypeStructure.map(([key, value]) => `${key}: ${value};`),\n+\t\t\tmodulesTypeStructure\n+\t\t);\n+\t\t// todo replace envInterface with generic\n+\t\tconst hash = blake3hash(consoleOutput).toString(\"hex\").slice(0, 32);",
        "comment_created_at": "2025-02-27T14:25:23+00:00",
        "comment_author": "penalosa",
        "comment_body": "What about just using `crypto.createHash(\"sha256\")` here? https://nodejs.org/docs/latest-v18.x/api/crypto.html#cryptocreatehashalgorithm-options",
        "pr_file_module": null
      }
    ]
  }
]