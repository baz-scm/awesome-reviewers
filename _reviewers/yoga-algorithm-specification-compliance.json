[
  {
    "discussion_id": "94831073",
    "pr_number": 317,
    "pr_file": "yoga/Yoga.c",
    "created_at": "2017-01-05T19:11:39+00:00",
    "commented_code": "}\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {",
    "repo_full_name": "facebook/yoga",
    "discussion_comments": [
      {
        "comment_id": "94831073",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831073",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {",
        "comment_created_at": "2017-01-05T19:11:39+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "Why `child->lineIndex > 0`? I understand that it skips multiline children but i'm not sure why.",
        "pr_file_module": null
      },
      {
        "comment_id": "94833858",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831073",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {",
        "comment_created_at": "2017-01-05T19:26:59+00:00",
        "comment_author": "woehrl01",
        "comment_body": "we use only the first line of the children for base layout alignment. At least this is how chrome handles it.",
        "pr_file_module": null
      },
      {
        "comment_id": "94836755",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831073",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {",
        "comment_created_at": "2017-01-05T19:41:06+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "yes, but this looks like we are skipping over children with multiple lines instead of just looking at their first line?",
        "pr_file_module": null
      },
      {
        "comment_id": "94837794",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831073",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {",
        "comment_created_at": "2017-01-05T19:46:36+00:00",
        "comment_author": "woehrl01",
        "comment_body": "oh, yep. We should break instead of continue here!",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "94831505",
    "pr_number": 317,
    "pr_file": "yoga/Yoga.c",
    "created_at": "2017-01-05T19:14:02+00:00",
    "commented_code": "}\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {\n+      continue;\n+    }\n+\n+    if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
    "repo_full_name": "facebook/yoga",
    "discussion_comments": [
      {
        "comment_id": "94831505",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831505",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {\n+      continue;\n+    }\n+\n+    if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:14:02+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "The baseline of a container is defined by its first baseline aligned child, but when there is no baseline aligned child then the container's baseline is defined by it's last child. This seems odd. Are you sure we have test cases covering edge cases here to make sure this is how it works on the web?",
        "pr_file_module": null
      },
      {
        "comment_id": "94834030",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831505",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {\n+      continue;\n+    }\n+\n+    if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:27:56+00:00",
        "comment_author": "woehrl01",
        "comment_body": "no it's defined by its first child on the first line or the first baseline aligned child if there is one (one the first line). I'll add a test for this.",
        "pr_file_module": null
      },
      {
        "comment_id": "94837195",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831505",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {\n+      continue;\n+    }\n+\n+    if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:43:16+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "So the current code is wrong i think. Right? As it will pick the last child in the case no child is baseline aligned?",
        "pr_file_module": null
      },
      {
        "comment_id": "94837972",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94831505",
        "commented_code": "@@ -941,6 +955,41 @@ static inline YGDirection YGNodeResolveDirection(const YGNodeRef node,\n   }\n }\n \n+static float YGBaseline(const YGNodeRef node,\n+                        const YGFlexDirection crossAxis) {\n+  if (node->baseline != NULL) {\n+    const float baseline = node->baseline(node);\n+    if (YGFloatIsUndefined(baseline)) {\n+      return node->layout.measuredDimensions[dim[crossAxis]];\n+    }\n+    return baseline;\n+  }\n+\n+  YGNodeRef baselineChild = NULL;\n+  for (uint32_t i = 0; i < YGNodeGetChildCount(node); i++) {\n+    const YGNodeRef child = YGNodeGetChild(node, i);\n+    if (child->style.positionType == YGPositionTypeAbsolute || child->lineIndex > 0) {\n+      continue;\n+    }\n+\n+    if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:47:30+00:00",
        "comment_author": "woehrl01",
        "comment_body": "no as we only use the child if ```baselineChild``` is still ```NULL```. Which is false as seen as we find the first one. We still need to iterate to take any baseline aligned child into account.",
        "pr_file_module": null
      }
    ]
  },
  {
    "discussion_id": "94832391",
    "pr_number": 317,
    "pr_file": "yoga/Yoga.c",
    "created_at": "2017-01-05T19:19:23+00:00",
    "commented_code": "// compute the line's height and find the endIndex\n       float lineHeight = 0;\n+      float maxAscentForCurrentLine = 0;\n+      float maxDescentForCurrentLine = 0;\n       for (ii = startIndex; ii < childCount; ii++) {\n         const YGNodeRef child = YGNodeListGet(node->children, ii);\n \n         if (child->style.positionType == YGPositionTypeRelative) {\n           if (child->lineIndex != i) {\n             break;\n           }\n-\n           if (YGNodeIsLayoutDimDefined(child, crossAxis)) {\n             lineHeight = fmaxf(lineHeight,\n                                child->layout.measuredDimensions[dim[crossAxis]] +\n                                    YGNodeMarginForAxis(child, crossAxis, availableInnerWidth));\n           }\n+          if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
    "repo_full_name": "facebook/yoga",
    "discussion_comments": [
      {
        "comment_id": "94832391",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94832391",
        "commented_code": "@@ -2452,19 +2516,30 @@ static void YGNodelayoutImpl(const YGNodeRef node,\n \n       // compute the line's height and find the endIndex\n       float lineHeight = 0;\n+      float maxAscentForCurrentLine = 0;\n+      float maxDescentForCurrentLine = 0;\n       for (ii = startIndex; ii < childCount; ii++) {\n         const YGNodeRef child = YGNodeListGet(node->children, ii);\n \n         if (child->style.positionType == YGPositionTypeRelative) {\n           if (child->lineIndex != i) {\n             break;\n           }\n-\n           if (YGNodeIsLayoutDimDefined(child, crossAxis)) {\n             lineHeight = fmaxf(lineHeight,\n                                child->layout.measuredDimensions[dim[crossAxis]] +\n                                    YGNodeMarginForAxis(child, crossAxis, availableInnerWidth));\n           }\n+          if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:19:23+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "same as above. Don't reference `crossAxis` as it confuses the fact that baseline is only defined for row layouts",
        "pr_file_module": null
      },
      {
        "comment_id": "94839715",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94832391",
        "commented_code": "@@ -2452,19 +2516,30 @@ static void YGNodelayoutImpl(const YGNodeRef node,\n \n       // compute the line's height and find the endIndex\n       float lineHeight = 0;\n+      float maxAscentForCurrentLine = 0;\n+      float maxDescentForCurrentLine = 0;\n       for (ii = startIndex; ii < childCount; ii++) {\n         const YGNodeRef child = YGNodeListGet(node->children, ii);\n \n         if (child->style.positionType == YGPositionTypeRelative) {\n           if (child->lineIndex != i) {\n             break;\n           }\n-\n           if (YGNodeIsLayoutDimDefined(child, crossAxis)) {\n             lineHeight = fmaxf(lineHeight,\n                                child->layout.measuredDimensions[dim[crossAxis]] +\n                                    YGNodeMarginForAxis(child, crossAxis, availableInnerWidth));\n           }\n+          if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:57:02+00:00",
        "comment_author": "woehrl01",
        "comment_body": "should I use ```YGFlexDirectionColumn``` here on the ```YGNodeLeadingMargin``` and ```YGNodeMarginForAxis``` calls?",
        "pr_file_module": null
      },
      {
        "comment_id": "94840196",
        "repo_full_name": "facebook/yoga",
        "pr_number": 317,
        "pr_file": "yoga/Yoga.c",
        "discussion_id": "94832391",
        "commented_code": "@@ -2452,19 +2516,30 @@ static void YGNodelayoutImpl(const YGNodeRef node,\n \n       // compute the line's height and find the endIndex\n       float lineHeight = 0;\n+      float maxAscentForCurrentLine = 0;\n+      float maxDescentForCurrentLine = 0;\n       for (ii = startIndex; ii < childCount; ii++) {\n         const YGNodeRef child = YGNodeListGet(node->children, ii);\n \n         if (child->style.positionType == YGPositionTypeRelative) {\n           if (child->lineIndex != i) {\n             break;\n           }\n-\n           if (YGNodeIsLayoutDimDefined(child, crossAxis)) {\n             lineHeight = fmaxf(lineHeight,\n                                child->layout.measuredDimensions[dim[crossAxis]] +\n                                    YGNodeMarginForAxis(child, crossAxis, availableInnerWidth));\n           }\n+          if (YGNodeAlignItem(node, child) == YGAlignBaseline) {",
        "comment_created_at": "2017-01-05T19:59:28+00:00",
        "comment_author": "emilsjolander",
        "comment_body": "yes :) and replace `dim[crossAxis]`",
        "pr_file_module": null
      }
    ]
  }
]